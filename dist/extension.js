(()=>{"use strict";var e={780:e=>{e.exports=require("iframe-resizer")},252:e=>{e.exports=require("iframe-resizer/js/iframeResizer.contentWindow")}},t={};function n(r){var i=t[r];if(void 0!==i)return i.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var r={};(()=>{n.r(r),n.d(r,{ExtensionCommandType:()=>f,ExtensionEventType:()=>l,initializeExtensionService:()=>g});const e=require("tslib"),t=function(t,n,r){return n&&r?i(0,n,r):function(t){var n=function(t){function n(){return null!==t&&t.apply(this,arguments)||this}return(0,e.__extends)(n,t),n}(t);return Object.getOwnPropertyNames(t.prototype).forEach((function(e){var r=Object.getOwnPropertyDescriptor(t.prototype,e);r&&"constructor"!==e&&Object.defineProperty(n.prototype,e,i(t.prototype,e,r))})),n}(t)};function i(t,n,r){if("function"!=typeof r.value)return r;var i=r.value;return{get:function(){var t=i.bind(this);return Object.defineProperty(this,n,(0,e.__assign)((0,e.__assign)({},r),{value:t})),t},set:function(e){i=e}}}const o=function(t){function n(e){var n=t.call(this,e||"Invalid arguments have been provided.")||this;return n.name="InvalidArgumentError",n.type="invalid_argument",n}return(0,e.__extends)(n,t),n}(function(t){function n(e){var n,r,i=this.constructor,o=t.call(this,e||"An unexpected error has occurred.")||this;return o.name="StandardError",o.type="standard",n=o,r=i.prototype,Object.setPrototypeOf?Object.setPrototypeOf(n,r):n.__proto__=r,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(o,i):o.stack=new Error(o.message).stack,o}return(0,e.__extends)(n,t),n}(Error));function s(e){if(!/^(https?:)?\/\//.test(e))throw new o("The provided URL must be absolute.");var t=document.createElement("a");t.href=e;var n=t.port&&-1!==e.indexOf(t.hostname+":"+t.port)?t.port:"";return{hash:t.hash,hostname:t.hostname,href:t.href,origin:t.protocol+"//"+t.hostname+(n?":"+n:""),pathname:t.pathname,port:n,protocol:t.protocol,search:t.search}}function a(e,t){return e.type===t}const u=function(){function n(e){var t;this._sourceOrigins=[s(e).origin,(t=s(e),s(0===t.hostname.indexOf("www")?t.href:t.href.replace(t.hostname,"www."+t.hostname))).origin],this._isListening=!1,this._listeners={}}return n.prototype.listen=function(){this._isListening||(this._isListening=!0,window.addEventListener("message",this._handleMessage))},n.prototype.stopListen=function(){this._isListening&&(this._isListening=!1,window.removeEventListener("message",this._handleMessage))},n.prototype.addListener=function(e,t){var n=this._listeners[e];n||(this._listeners[e]=n=[]),-1===n.indexOf(t)&&n.push(t)},n.prototype.removeListener=function(e,t){var n=this._listeners[e];if(n){var r=n.indexOf(t);r>=0&&n.splice(r,1)}},n.prototype.trigger=function(e,t){var n=this._listeners[e.type];n&&n.forEach((function(n){return t?n(e,t):n(e)}))},n.prototype._handleMessage=function(t){if(-1!==this._sourceOrigins.indexOf(t.origin)&&a(t.data,t.data.type)){var n=t.data,r=n.context,i=(0,e.__rest)(n,["context"]);this.trigger(i,r)}},(0,e.__decorate)([t],n.prototype,"_handleMessage",null),n}(),c=require("rxjs"),d=require("rxjs/operators"),p=function(){function t(e,t,n){this._targetWindow=t,this._context=n,this._targetOrigin="*"===e?"*":s(e).origin}return t.prototype.post=function(t,n){var r=this,i=this._targetWindow;if(window!==i){if(!i)throw new Error("Unable to post message because target window is not set.");var o=n&&(0,c.fromEvent)(window,"message").pipe((0,d.filter)((function(e){return e.origin===r._targetOrigin&&a(e.data,e.data.type)&&-1!==[n.successType,n.errorType].indexOf(e.data.type)})),(0,d.map)((function(e){if(n.errorType===e.data.type)throw e.data;return e.data})),(0,d.take)(1)).toPromise();return i.postMessage((0,e.__assign)((0,e.__assign)({},t),{context:this._context}),this._targetOrigin),o}},t.prototype.setTarget=function(e){this._targetWindow=e},t.prototype.setContext=function(e){this._context=e},t}(),h=require("lodash");var f,l,_,E;!function(e){e.ReloadCheckout="EXTENSION:RELOAD_CHECKOUT",e.ShowLoadingIndicator="EXTENSION:SHOW_LOADING_INDICATOR",e.SetIframeStyle="EXTENSION:SET_IFRAME_STYLE"}(f||(f={})),function(e){e.ConsignmentsChanged="EXTENSION:CONSIGNMENTS_CHANGED"}(l||(l={})),function(e){e.Subscribe="EXTENSION_INTERNAL:SUBSCRIBE",e.Unsubscribe="EXTENSION_INTERNAL:UNSUBSCRIBE",e.ResizeIframe="EXTENSION_INTERNAL:RESIZE_IFRAME"}(_||(_={})),function(e){e.ExtensionReady="EXTENSION:READY",e.ExtensionFailed="EXTENSION:FAILED"}(E||(E={}));const m=function(){function t(e,t,n){this._eventListener=e,this._commandPoster=t,this._internalCommandPoster=n,this._commandPoster.setTarget(window.parent),this._internalCommandPoster.setTarget(window.parent)}return t.prototype.initialize=function(t){return(0,e.__awaiter)(this,void 0,void 0,(function(){var n;return(0,e.__generator)(this,(function(e){switch(e.label){case 0:if(!t)throw new Error("Extension Id not found.");this._extensionId=t,this._eventListener.listen(),this._commandPoster.setContext({extensionId:t}),e.label=1;case 1:return e.trys.push([1,3,,4]),[4,this._internalCommandPoster.post({type:_.ResizeIframe,payload:{extensionId:t}},{successType:E.ExtensionReady,errorType:E.ExtensionFailed})];case 2:return e.sent(),[3,4];case 3:if(n=e.sent(),this._isExtensionFailedEvent(n))throw new Error("Extension failed to load within 60 seconds; please reload and try again.");return[3,4];case 4:return[2]}}))}))},t.prototype.post=function(e){if(!Object.values(f).includes(e.type))throw new Error(e.type+" is not supported.");this._commandPoster.post(e)},t.prototype.addListener=function(e,t){var n=this;if(void 0===t&&(t=h.noop),!this._extensionId)throw new Error("Extension is not initialized.");var r=this._extensionId;if(!Object.values(l).includes(e))throw new Error(e+" is not supported.");return this._internalCommandPoster.post({type:_.Subscribe,payload:{extensionId:r,eventType:e}}),this._eventListener.addListener(e,t),function(){n._internalCommandPoster.post({type:_.Unsubscribe,payload:{extensionId:r,eventType:e}}),n._eventListener.removeListener(e,t)}},t.prototype._isExtensionFailedEvent=function(e){return e.type===E.ExtensionFailed},t}();function g(t){return(0,e.__awaiter)(this,void 0,void 0,(function(){var r,i,o,s,a;return(0,e.__generator)(this,(function(e){switch(e.label){case 0:return r=t.extensionId,i=t.parentOrigin,o=t.taggedElementId,s=t.fixedHeight,n(252),[4,(a=new m(new u(i),new p(i),new p(i))).initialize(r)];case 1:return e.sent(),function(e,t){if(!function(e){return"parentIFrame"in e}(window))throw new Error("iFramerResizer window not found.");if(t)window.parentIFrame.size(t);else if(window.parentIFrame.autoResize(!0),e){var n=document.getElementById(e);if(!n)throw new Error("Element not found.");n.setAttribute("data-iframe-height",""),window.parentIFrame.setHeightCalculationMethod("taggedElement")}else window.parentIFrame.setHeightCalculationMethod("bodyOffset")}(o,s),[2,a]}}))}))}})(),module.exports=r})();
//# sourceMappingURL=extension.js.map