/*! For license information please see squarev2.js.LICENSE.txt */
(()=>{var t={35:(t,e,r)=>{t=r.nmd(t);var n="__lodash_hash_undefined__",o=9007199254740991,i="[object Arguments]",s="[object Function]",u="[object Object]",c=/^\[object .+?Constructor\]$/,a=/^(?:0|[1-9]\d*)$/,l={};l["[object Float32Array]"]=l["[object Float64Array]"]=l["[object Int8Array]"]=l["[object Int16Array]"]=l["[object Int32Array]"]=l["[object Uint8Array]"]=l["[object Uint8ClampedArray]"]=l["[object Uint16Array]"]=l["[object Uint32Array]"]=!0,l[i]=l["[object Array]"]=l["[object ArrayBuffer]"]=l["[object Boolean]"]=l["[object DataView]"]=l["[object Date]"]=l["[object Error]"]=l[s]=l["[object Map]"]=l["[object Number]"]=l[u]=l["[object RegExp]"]=l["[object Set]"]=l["[object String]"]=l["[object WeakMap]"]=!1;var p,f,d,h="object"==typeof r.g&&r.g&&r.g.Object===Object&&r.g,y="object"==typeof self&&self&&self.Object===Object&&self,v=h||y||Function("return this")(),b=e&&!e.nodeType&&e,_=b&&t&&!t.nodeType&&t,m=_&&_.exports===b,g=m&&h.process,w=function(){try{return _&&_.require&&_.require("util").types||g&&g.binding&&g.binding("util")}catch(t){}}(),S=w&&w.isTypedArray,j=Array.prototype,O=Function.prototype,E=Object.prototype,P=v["__core-js_shared__"],I=O.toString,C=E.hasOwnProperty,x=(p=/[^.]+$/.exec(P&&P.keys&&P.keys.IE_PROTO||""))?"Symbol(src)_1."+p:"",T=E.toString,A=I.call(Object),R=RegExp("^"+I.call(C).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),k=m?v.Buffer:void 0,q=v.Symbol,z=v.Uint8Array,N=(k&&k.allocUnsafe,f=Object.getPrototypeOf,d=Object,function(t){return f(d(t))}),V=Object.create,U=E.propertyIsEnumerable,B=j.splice,D=q?q.toStringTag:void 0,H=function(){try{var t=ut(Object,"defineProperty");return t({},"",{}),t}catch(t){}}(),F=k?k.isBuffer:void 0,M=Math.max,L=Date.now,$=ut(v,"Map"),G=ut(Object,"create"),J=function(){function t(){}return function(e){if(!mt(e))return{};if(V)return V(e);t.prototype=e;var r=new t;return t.prototype=void 0,r}}();function K(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Y(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function X(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}function Q(t){var e=this.__data__=new Y(t);this.size=e.size}function W(t,e,r){(void 0!==r&&!ft(t[e],r)||void 0===r&&!(e in t))&&et(t,e,r)}function Z(t,e,r){var n=t[e];C.call(t,e)&&ft(n,r)&&(void 0!==r||e in t)||et(t,e,r)}function tt(t,e){for(var r=t.length;r--;)if(ft(t[r][0],e))return r;return-1}function et(t,e,r){"__proto__"==e&&H?H(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}K.prototype.clear=function(){this.__data__=G?G(null):{},this.size=0},K.prototype.delete=function(t){var e=this.has(t)&&delete this.__data__[t];return this.size-=e?1:0,e},K.prototype.get=function(t){var e=this.__data__;if(G){var r=e[t];return r===n?void 0:r}return C.call(e,t)?e[t]:void 0},K.prototype.has=function(t){var e=this.__data__;return G?void 0!==e[t]:C.call(e,t)},K.prototype.set=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=G&&void 0===e?n:e,this},Y.prototype.clear=function(){this.__data__=[],this.size=0},Y.prototype.delete=function(t){var e=this.__data__,r=tt(e,t);return!(r<0||(r==e.length-1?e.pop():B.call(e,r,1),--this.size,0))},Y.prototype.get=function(t){var e=this.__data__,r=tt(e,t);return r<0?void 0:e[r][1]},Y.prototype.has=function(t){return tt(this.__data__,t)>-1},Y.prototype.set=function(t,e){var r=this.__data__,n=tt(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this},X.prototype.clear=function(){this.size=0,this.__data__={hash:new K,map:new($||Y),string:new K}},X.prototype.delete=function(t){var e=st(this,t).delete(t);return this.size-=e?1:0,e},X.prototype.get=function(t){return st(this,t).get(t)},X.prototype.has=function(t){return st(this,t).has(t)},X.prototype.set=function(t,e){var r=st(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this},Q.prototype.clear=function(){this.__data__=new Y,this.size=0},Q.prototype.delete=function(t){var e=this.__data__,r=e.delete(t);return this.size=e.size,r},Q.prototype.get=function(t){return this.__data__.get(t)},Q.prototype.has=function(t){return this.__data__.has(t)},Q.prototype.set=function(t,e){var r=this.__data__;if(r instanceof Y){var n=r.__data__;if(!$||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new X(n)}return r.set(t,e),this.size=r.size,this};function rt(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":D&&D in Object(t)?function(t){var e=C.call(t,D),r=t[D];try{t[D]=void 0;var n=!0}catch(t){}var o=T.call(t);return n&&(e?t[D]=r:delete t[D]),o}(t):function(t){return T.call(t)}(t)}function nt(t){return gt(t)&&rt(t)==i}function ot(t,e,r,n,o){t!==e&&function(t,e,r){for(var n=-1,o=Object(t),i=r(t),s=i.length;s--;){var u=i[++n];if(!1===e(o[u],u,o))break}}(e,function(i,s){if(o||(o=new Q),mt(i))!function(t,e,r,n,o,i,s){var c=lt(t,r),a=lt(e,r),l=s.get(a);if(l)W(t,r,l);else{var p,f,d,h,y,v=i?i(c,a,r+"",t,e,s):void 0,b=void 0===v;if(b){var _=ht(a),m=!_&&vt(a),g=!_&&!m&&wt(a);v=a,_||m||g?ht(c)?v=c:gt(y=c)&&yt(y)?v=function(t,e){var r=-1,n=t.length;for(e||(e=Array(n));++r<n;)e[r]=t[r];return e}(c):m?(b=!1,v=function(t){return t.slice()}(a)):g?(b=!1,h=new(d=(p=a).buffer).constructor(d.byteLength),new z(h).set(new z(d)),f=h,v=new p.constructor(f,p.byteOffset,p.length)):v=[]:function(t){if(!gt(t)||rt(t)!=u)return!1;var e=N(t);if(null===e)return!0;var r=C.call(e,"constructor")&&e.constructor;return"function"==typeof r&&r instanceof r&&I.call(r)==A}(a)||dt(a)?(v=c,dt(c)?v=function(t){return function(t,e,r){var n=!r;r||(r={});for(var o=-1,i=e.length;++o<i;){var s=e[o],u=void 0;void 0===u&&(u=t[s]),n?et(r,s,u):Z(r,s,u)}return r}(t,St(t))}(c):mt(c)&&!bt(c)||(v=function(t){return"function"!=typeof t.constructor||at(t)?{}:J(N(t))}(a))):b=!1}b&&(s.set(a,v),o(v,a,n,i,s),s.delete(a)),W(t,r,v)}}(t,e,s,r,ot,n,o);else{var c=n?n(lt(t,s),i,s+"",t,e,o):void 0;void 0===c&&(c=i),W(t,s,c)}},St)}var it=H?function(t,e){return H(t,"toString",{configurable:!0,enumerable:!1,value:(r=e,function(){return r}),writable:!0});var r}:Et;function st(t,e){var r,n,o=t.__data__;return("string"==(n=typeof(r=e))||"number"==n||"symbol"==n||"boolean"==n?"__proto__"!==r:null===r)?o["string"==typeof e?"string":"hash"]:o.map}function ut(t,e){var r=function(t,e){return null==t?void 0:t[e]}(t,e);return function(t){return!(!mt(t)||function(t){return!!x&&x in t}(t))&&(bt(t)?R:c).test(function(t){if(null!=t){try{return I.call(t)}catch(t){}try{return t+""}catch(t){}}return""}(t))}(r)?r:void 0}function ct(t,e){var r=typeof t;return!!(e=null==e?o:e)&&("number"==r||"symbol"!=r&&a.test(t))&&t>-1&&t%1==0&&t<e}function at(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||E)}function lt(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}var pt=function(t){var e=0,r=0;return function(){var n=L(),o=16-(n-r);if(r=n,o>0){if(++e>=800)return arguments[0]}else e=0;return t.apply(void 0,arguments)}}(it);function ft(t,e){return t===e||t!=t&&e!=e}var dt=nt(function(){return arguments}())?nt:function(t){return gt(t)&&C.call(t,"callee")&&!U.call(t,"callee")},ht=Array.isArray;function yt(t){return null!=t&&_t(t.length)&&!bt(t)}var vt=F||function(){return!1};function bt(t){if(!mt(t))return!1;var e=rt(t);return e==s||"[object GeneratorFunction]"==e||"[object AsyncFunction]"==e||"[object Proxy]"==e}function _t(t){return"number"==typeof t&&t>-1&&t%1==0&&t<=o}function mt(t){var e=typeof t;return null!=t&&("object"==e||"function"==e)}function gt(t){return null!=t&&"object"==typeof t}var wt=S?function(t){return function(e){return t(e)}}(S):function(t){return gt(t)&&_t(t.length)&&!!l[rt(t)]};function St(t){return yt(t)?function(t,e){var r=ht(t),n=!r&&dt(t),o=!r&&!n&&vt(t),i=!r&&!n&&!o&&wt(t),s=r||n||o||i,u=s?function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}(t.length,String):[],c=u.length;for(var a in t)!e&&!C.call(t,a)||s&&("length"==a||o&&("offset"==a||"parent"==a)||i&&("buffer"==a||"byteLength"==a||"byteOffset"==a)||ct(a,c))||u.push(a);return u}(t,!0):function(t){if(!mt(t))return function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}(t);var e=at(t),r=[];for(var n in t)("constructor"!=n||!e&&C.call(t,n))&&r.push(n);return r}(t)}var jt,Ot=(jt=function(t,e,r){ot(t,e,r)},function(t,e){return pt(function(t,e,r){return e=M(void 0===e?t.length-1:e,0),function(){for(var n=arguments,o=-1,i=M(n.length-e,0),s=Array(i);++o<i;)s[o]=n[e+o];o=-1;for(var u=Array(e+1);++o<e;)u[o]=n[o];return u[e]=r(s),function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}(t,this,u)}}(t,e,Et),t+"")}(function(t,e){var r=-1,n=e.length,o=n>1?e[n-1]:void 0,i=n>2?e[2]:void 0;for(o=jt.length>3&&"function"==typeof o?(n--,o):void 0,i&&function(t,e,r){if(!mt(r))return!1;var n=typeof e;return!!("number"==n?yt(r)&&ct(e,r.length):"string"==n&&e in r)&&ft(r[e],t)}(e[0],e[1],i)&&(o=n<3?void 0:o,n=1),t=Object(t);++r<n;){var s=e[r];s&&jt(t,s,r)}return t}));function Et(t){return t}t.exports=Ot},168:t=>{var e;e=function(){function t(){for(var t=0,e={};t<arguments.length;t++){var r=arguments[t];for(var n in r)e[n]=r[n]}return e}function e(t){return t.replace(/(%[0-9A-Z]{2})+/g,decodeURIComponent)}return function r(n){function o(){}function i(e,r,i){if("undefined"!=typeof document){"number"==typeof(i=t({path:"/"},o.defaults,i)).expires&&(i.expires=new Date(1*new Date+864e5*i.expires)),i.expires=i.expires?i.expires.toUTCString():"";try{var s=JSON.stringify(r);/^[\{\[]/.test(s)&&(r=s)}catch(t){}r=n.write?n.write(r,e):encodeURIComponent(String(r)).replace(/%(23|24|26|2B|3A|3C|3E|3D|2F|3F|40|5B|5D|5E|60|7B|7D|7C)/g,decodeURIComponent),e=encodeURIComponent(String(e)).replace(/%(23|24|26|2B|5E|60|7C)/g,decodeURIComponent).replace(/[\(\)]/g,escape);var u="";for(var c in i)i[c]&&(u+="; "+c,!0!==i[c]&&(u+="="+i[c].split(";")[0]));return document.cookie=e+"="+r+u}}function s(t,r){if("undefined"!=typeof document){for(var o={},i=document.cookie?document.cookie.split("; "):[],s=0;s<i.length;s++){var u=i[s].split("="),c=u.slice(1).join("=");r||'"'!==c.charAt(0)||(c=c.slice(1,-1));try{var a=e(u[0]);if(c=(n.read||n)(c,a)||e(c),r)try{c=JSON.parse(c)}catch(t){}if(o[a]=c,t===a)break}catch(t){}}return t?o[t]:o}}return o.set=i,o.get=function(t){return s(t,!1)},o.getJSON=function(t){return s(t,!0)},o.remove=function(e,r){i(e,"",t(r,{expires:-1}))},o.defaults={},o.withConverter=r,o}(function(){})},"function"==typeof define&&define.amd&&define(e),t.exports=e()},282:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(9722);e.default=function(){return n||(n=o.default()),n}},315:(t,e,r)=>{"use strict";r(4886).default,r(471).default;var n=r(5895);e.vQ=n.default,r(7995).default,r(9722).default,r(282).default},321:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var n=r(168),o=r(1675),i=r(5861),s=r(4670);function u(t){return new s.A(new i.A,new o.A,n,t)}},471:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4043),o=r(5477),i=r(4886);e.default=function(){return new i.default(new o.default,n.createRequestSender())}},710:(t,e,r)=>{"use strict";function n(t){return"object"!=typeof t||null===t?t:Object.keys(t).filter(function(e){return void 0!==t[e]}).map(function(e){var r=t[e];return"string"==typeof r?e+"="+encodeURIComponent(r):e+"="+encodeURIComponent(JSON.stringify(r)||"")}).join("&")}r.d(e,{A:()=>n})},803:t=>{"use strict";t.exports=function(t){return encodeURIComponent(t).replace(/[!'()*]/g,function(t){return"%"+t.charCodeAt(0).toString(16).toUpperCase()})}},1675:(t,e,r)=>{"use strict";r.d(e,{A:()=>u});var n=r(4321),o=r(710),i=/application\/(\w+\+)?json/,s=/application\/x-www-form-urlencoded/;const u=function(){function t(){}return t.prototype.toRequestBody=function(t){var e=t.headers?this._getHeader(t.headers,"Content-Type"):"";if(t.body){if(i.test(e))return JSON.stringify(t.body);if(s.test(e))return(0,o.A)(t.body)}return t.body},t.prototype.toResponse=function(t){var e=this._parseResponseHeaders(t.getAllResponseHeaders());return{body:this._parseResponseBody("response"in t?t.response:t.responseText,e),headers:e,status:t.status,statusText:t.statusText}},t.prototype._parseResponseBody=function(t,e){var r=this._getHeader(e,"Content-Type");return t&&i.test(r)?JSON.parse(t):t},t.prototype._parseResponseHeaders=function(t){return(t?t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/):[]).reduce(function(t,e){var r,o=e.split(":"),i=(o.shift()||"").trim();return i?(0,n.Cl)((0,n.Cl)({},t),((r={})[i.toLowerCase()]=o.join(":").trim(),r)):t},{})},t.prototype._getHeader=function(t,e){return t&&e&&(t[e]||t[e.toLowerCase()])||""},t}()},1915:t=>{"use strict";var e="%[a-f0-9]{2}",r=new RegExp("("+e+")|([^%]+?)","gi"),n=new RegExp("("+e+")+","gi");function o(t,e){try{return[decodeURIComponent(t.join(""))]}catch(t){}if(1===t.length)return t;e=e||1;var r=t.slice(0,e),n=t.slice(e);return Array.prototype.concat.call([],o(r),o(n))}function i(t){try{return decodeURIComponent(t)}catch(i){for(var e=t.match(r)||[],n=1;n<e.length;n++)e=(t=o(e,n).join("")).match(r)||[];return t}}t.exports=function(t){if("string"!=typeof t)throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof t+"`");try{return t=t.replace(/\+/g," "),decodeURIComponent(t)}catch(e){return function(t){for(var e={"%FE%FF":"��","%FF%FE":"��"},r=n.exec(t);r;){try{e[r[0]]=decodeURIComponent(r[0])}catch(t){var o=i(r[0]);o!==r[0]&&(e[r[0]]=o)}r=n.exec(t)}e["%C2"]="�";for(var s=Object.keys(e),u=0;u<s.length;u++){var c=s[u];t=t.replace(new RegExp(c,"g"),e[c])}return t}(t)}}},2024:(t,e,r)=>{"use strict";r.d(e,{A:()=>n});const n=function(){function t(t){var e=this;this._delay=t,this._resolve=function(){},this._promise=new Promise(function(t){e._resolve=t})}return t.prototype.onComplete=function(t){this._promise.then(t)},t.prototype.complete=function(){this._resolve(),this._timeoutToken&&window.clearTimeout(this._timeoutToken)},t.prototype.start=function(){var t=this;this._delay&&(this._timeoutToken=window.setTimeout(function(){return t.complete()},this._delay))},t}()},4043:(t,e,r)=>{"use strict";r.r(e),r.d(e,{RequestSender:()=>i.A,Timeout:()=>s.A,createRequestSender:()=>n.A,createTimeout:()=>o.A});var n=r(321),o=r(6889),i=r(4670),s=r(2024)},4321:(t,e,r)=>{"use strict";r.d(e,{Cl:()=>n});var n=function(){return n=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var o in e=arguments[r])Object.prototype.hasOwnProperty.call(e,o)&&(t[o]=e[o]);return t},n.apply(this,arguments)}},4325:(t,e,r)=>{"use strict";r.d(e,{g:()=>o});var n=r(5889),o=function(){function t(){this._cache={}}return t.prototype.read=function(t,e){var r=this.getKey(t,e.params);return this._cache[r]||null},t.prototype.write=function(t,e,r){var n=this.getKey(t,e.params);this._cache[n]=r},t.prototype.getKey=function(t,e){return void 0===e&&(e={}),0===Object.keys(e).length?t:t+"?"+n.As(e)},t}()},4475:t=>{"use strict";var e=Object.getOwnPropertySymbols,r=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},r=0;r<10;r++)e["_"+String.fromCharCode(r)]=r;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var n={};return"abcdefghijklmnopqrst".split("").forEach(function(t){n[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},n)).join("")}catch(t){return!1}}()?Object.assign:function(t,o){for(var i,s,u=function(t){if(null==t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}(t),c=1;c<arguments.length;c++){for(var a in i=Object(arguments[c]))r.call(i,a)&&(u[a]=i[a]);if(e){s=e(i);for(var l=0;l<s.length;l++)n.call(i,s[l])&&(u[s[l]]=i[s[l]])}}return u}},4670:(t,e,r)=>{"use strict";r.d(e,{A:()=>a});var n=r(4321),o=r(35),i=r.n(o),s=r(4325),u=r(4843),c=r(2024);const a=function(){function t(t,e,r,n){void 0===n&&(n={}),this._requestFactory=t,this._payloadTransformer=e,this._cookie=r,this._options=n,this._cache=this._options.cache||new s.g}return t.prototype.sendRequest=function(t,e){var r=this,n=this._mergeDefaultOptions(t,e),o=this._getCachedRequest(t,n);if(o)return Promise.resolve(o);var i=this._requestFactory.createRequest(this._prependHost(t),n);return new Promise(function(e,o){var s=function(){var s=r._payloadTransformer.toResponse(i);s.status>=200&&s.status<300?(r._cacheRequest(t,n,s),e(s)):o(s)};i.onload=s,i.onerror=s,i.onabort=s,i.ontimeout=s,n.timeout instanceof c.A&&(n.timeout.onComplete(function(){return i.abort()}),n.timeout.start()),(0,u.A)(n.timeout)&&n.timeout.then(function(){return i.abort()}),i.send(r._payloadTransformer.toRequestBody(n))})},t.prototype.get=function(t,e){return this.sendRequest(t,(0,n.Cl)((0,n.Cl)({},e),{method:"GET"}))},t.prototype.post=function(t,e){return this.sendRequest(t,(0,n.Cl)((0,n.Cl)({},e),{method:"POST"}))},t.prototype.put=function(t,e){return this.sendRequest(t,(0,n.Cl)((0,n.Cl)({},e),{method:"PUT"}))},t.prototype.patch=function(t,e){return this.sendRequest(t,(0,n.Cl)((0,n.Cl)({},e),{method:"PATCH"}))},t.prototype.delete=function(t,e){return this.sendRequest(t,(0,n.Cl)((0,n.Cl)({},e),{method:"DELETE"}))},t.prototype._mergeDefaultOptions=function(t,e){var r={credentials:!0,encodeParams:!0,headers:{Accept:"application/json, text/plain, */*"},method:"GET"},n=this._cookie.get("XSRF-TOKEN");return n&&r.headers&&!this._isAssetRequest(t,e)&&this._isLocalRequest(t)&&(r.headers["X-XSRF-TOKEN"]=n),e&&e.body&&r.headers&&(r.headers["Content-Type"]="application/json"),i()({},r,e)},t.prototype._prependHost=function(t){return!this._options.host||/^https?:\/\//.test(t)?t:this._options.host.replace(/\/$/,"")+"/"+t.replace(/^\//,"")},t.prototype._shouldCacheRequest=function(t){return"GET"===(t.method||"GET").toUpperCase()&&Boolean(t.cache)},t.prototype._getCachedRequest=function(t,e){return this._shouldCacheRequest(e)?this._cache.read(t,e):null},t.prototype._cacheRequest=function(t,e,r){this._shouldCacheRequest(e)&&this._cache.write(t,e,r)},t.prototype._isAssetRequest=function(t,e){return(!e||!e.method||"GET"===e.method.toUpperCase())&&/\.(png|gif|jpe?g|css|js|json|svg|html?)$/.test(t.split("?")[0])},t.prototype._isLocalRequest=function(t){return!!t.match(new RegExp("^(https?:)?//"+window.location.hostname))||!t.match(new RegExp("^(https?:)?//"))},t}()},4843:(t,e,r)=>{"use strict";function n(t){return!!t&&("object"==typeof t||"function"==typeof t)&&"function"==typeof t.then}r.d(e,{A:()=>n})},4886:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this._browserSupport=t,this._requestSender=e,this._scripts={},this._preloadedScripts={}}return t.prototype.loadScript=function(t,e){var r=this;return this._scripts[t]||(this._scripts[t]=new Promise(function(n,o){var i=document.createElement("script"),s=e||{},u=s.async,c=void 0!==u&&u,a=s.attributes,l=void 0===a?{}:a;Object.keys(l).forEach(function(t){i.setAttribute(t,l[t])}),i.onload=function(){return n()},i.onreadystatechange=function(){return n()},i.onerror=function(e){delete r._scripts[t],o(e)},i.async=c,i.src=t,document.body.appendChild(i)})),this._scripts[t]},t.prototype.loadScripts=function(t,e){var r=this;return Promise.all(t.map(function(t){return r.loadScript(t,e)})).then(function(){})},t.prototype.preloadScript=function(t,e){var r=this;return this._preloadedScripts[t]||(this._preloadedScripts[t]=new Promise(function(n,o){var i=(e||{}).prefetch,s=void 0!==i&&i?"prefetch":"preload";if(r._browserSupport.canSupportRel(s)){var u=document.createElement("link");u.as="script",u.rel=s,u.href=t,u.onload=function(){n()},u.onerror=function(){delete r._preloadedScripts[t],o()},document.head.appendChild(u)}else r._requestSender.get(t,{credentials:!1,headers:{Accept:"application/javascript"}}).then(function(){return n()}).catch(o)})),this._preloadedScripts[t]},t.prototype.preloadScripts=function(t,e){var r=this;return Promise.all(t.map(function(t){return r.preloadScript(t,e)})).then(function(){})},t}();e.default=r},5477:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.prototype.canSupportRel=function(t){var e=document.createElement("link");return!!(e.relList&&e.relList.supports&&e.relList.supports(t))},t}();e.default=r},5861:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var n=r(5889);const o=function(){function t(){}return t.prototype.createRequest=function(t,e){var r=new XMLHttpRequest;return this._configureRequest(r,t,e),r},t.prototype._configureRequest=function(t,e,r){void 0===r&&(r={}),t.open(r.method||"GET",this._formatUrl(e,r.params,r.encodeParams),!0),r.headers&&this._configureRequestHeaders(t,r.headers),"boolean"==typeof r.credentials&&(t.withCredentials=r.credentials),"number"==typeof r.timeout&&(t.timeout=r.timeout)},t.prototype._configureRequestHeaders=function(t,e){Object.keys(e).filter(function(t){return null!==e[t]}).forEach(function(r){t.setRequestHeader(r,e[r])})},t.prototype._formatUrl=function(t,e,r){return void 0===r&&(r=!0),e&&0!==Object.keys(e).length?t+"?"+n.As(e,{encode:r}):t},t}()},5889:(t,e,r)=>{"use strict";var n=r(803),o=r(4475);r(1915);function i(t,e){return e.encode?e.strict?n(t):encodeURIComponent(t):t}e.As=function(t,e){!1===(e=o({encode:!0,strict:!0,arrayFormat:"none"},e)).sort&&(e.sort=function(){});var r=function(t){switch(t.arrayFormat){case"index":return function(e,r,n){return null===r?[i(e,t),"[",n,"]"].join(""):[i(e,t),"[",i(n,t),"]=",i(r,t)].join("")};case"bracket":return function(e,r){return null===r?i(e,t):[i(e,t),"[]=",i(r,t)].join("")};default:return function(e,r){return null===r?i(e,t):[i(e,t),"=",i(r,t)].join("")}}}(e);return t?Object.keys(t).sort(e.sort).map(function(n){var o=t[n];if(void 0===o)return"";if(null===o)return i(n,e);if(Array.isArray(o)){var s=[];return o.slice().forEach(function(t){void 0!==t&&s.push(r(n,t,s.length))}),s.join("&")}return i(n,e)+"="+i(o,e)}).filter(function(t){return t.length>0}).join("&"):""}},5895:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n,o=r(471);e.default=function(){return n||(n=o.default()),n}},6889:(t,e,r)=>{"use strict";r.d(e,{A:()=>o});var n=r(2024);function o(t){return new n.A(t)}},7995:(t,e)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this._browserSupport=t,this._requestSender=e,this._stylesheets={},this._preloadedStylesheets={}}return t.prototype.loadStylesheet=function(t,e){var r=this;return this._stylesheets[t]||(this._stylesheets[t]=new Promise(function(n,o){var i=document.createElement("link"),s=e||{},u=s.prepend,c=void 0!==u&&u,a=s.attributes,l=void 0===a?{}:a;Object.keys(l).forEach(function(t){i.setAttribute(t,l[t])}),i.onload=function(){return n()},i.onerror=function(e){delete r._stylesheets[t],o(e)},i.rel="stylesheet",i.href=t,c&&document.head.children[0]?document.head.insertBefore(i,document.head.children[0]):document.head.appendChild(i)})),this._stylesheets[t]},t.prototype.loadStylesheets=function(t,e){var r=this;return Promise.all(t.map(function(t){return r.loadStylesheet(t,e)})).then(function(){})},t.prototype.preloadStylesheet=function(t,e){var r=this;return this._preloadedStylesheets[t]||(this._preloadedStylesheets[t]=new Promise(function(n,o){var i=(e||{}).prefetch,s=void 0!==i&&i,u=s?"prefetch":"preload";if(r._browserSupport.canSupportRel(u)){var c=document.createElement("link");c.as="style",c.rel=s?"prefetch":"preload",c.href=t,c.onload=function(){n()},c.onerror=function(e){delete r._preloadedStylesheets[t],o(e)},document.head.appendChild(c)}else r._requestSender.get(t,{credentials:!1,headers:{Accept:"text/css"}}).then(function(){return n()}).catch(o)})),this._preloadedStylesheets[t]},t.prototype.preloadStylesheets=function(t,e){var r=this;return Promise.all(t.map(function(t){return r.preloadStylesheet(t,e)})).then(function(){})},t}();e.default=r},9722:(t,e,r)=>{"use strict";Object.defineProperty(e,"__esModule",{value:!0});var n=r(4043),o=r(5477),i=r(7995);e.default=function(){return new i.default(new o.default,n.createRequestSender())}}},e={};function r(n){var o=e[n];if(void 0!==o)return o.exports;var i=e[n]={id:n,loaded:!1,exports:{}};return t[n](i,i.exports,r),i.loaded=!0,i.exports}r.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return r.d(e,{a:e}),e},r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.nmd=t=>(t.paths=[],t.children||(t.children=[]),t);var n={};(()=>{"use strict";r.r(n),r.d(n,{createSquareV2PaymentStrategy:()=>st});var t=r(315),e=function(t,r){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])},e(t,r)};function o(t,r){function n(){this.constructor=t}e(t,r),t.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}function i(t){return"function"==typeof t}var s=!1,u={Promise:void 0,set useDeprecatedSynchronousErrorHandling(t){t&&(new Error).stack,s=t},get useDeprecatedSynchronousErrorHandling(){return s}};function c(t){setTimeout(function(){throw t},0)}var a={closed:!0,next:function(t){},error:function(t){if(u.useDeprecatedSynchronousErrorHandling)throw t;c(t)},complete:function(){}},l=function(){return Array.isArray||function(t){return t&&"number"==typeof t.length}}();function p(t){return null!==t&&"object"==typeof t}var f=function(){function t(t){return Error.call(this),this.message=t?t.length+" errors occurred during unsubscription:\n"+t.map(function(t,e){return e+1+") "+t.toString()}).join("\n  "):"",this.name="UnsubscriptionError",this.errors=t,this}return t.prototype=Object.create(Error.prototype),t}(),d=function(){function t(t){this.closed=!1,this._parentOrParents=null,this._subscriptions=null,t&&(this._ctorUnsubscribe=!0,this._unsubscribe=t)}return t.prototype.unsubscribe=function(){var e;if(!this.closed){var r=this,n=r._parentOrParents,o=r._ctorUnsubscribe,s=r._unsubscribe,u=r._subscriptions;if(this.closed=!0,this._parentOrParents=null,this._subscriptions=null,n instanceof t)n.remove(this);else if(null!==n)for(var c=0;c<n.length;++c)n[c].remove(this);if(i(s)){o&&(this._unsubscribe=void 0);try{s.call(this)}catch(t){e=t instanceof f?h(t.errors):[t]}}if(l(u)){c=-1;for(var a=u.length;++c<a;){var d=u[c];if(p(d))try{d.unsubscribe()}catch(t){e=e||[],t instanceof f?e=e.concat(h(t.errors)):e.push(t)}}}if(e)throw new f(e)}},t.prototype.add=function(e){var r=e;if(!e)return t.EMPTY;switch(typeof e){case"function":r=new t(e);case"object":if(r===this||r.closed||"function"!=typeof r.unsubscribe)return r;if(this.closed)return r.unsubscribe(),r;if(!(r instanceof t)){var n=r;(r=new t)._subscriptions=[n]}break;default:throw new Error("unrecognized teardown "+e+" added to Subscription.")}var o=r._parentOrParents;if(null===o)r._parentOrParents=this;else if(o instanceof t){if(o===this)return r;r._parentOrParents=[o,this]}else{if(-1!==o.indexOf(this))return r;o.push(this)}var i=this._subscriptions;return null===i?this._subscriptions=[r]:i.push(r),r},t.prototype.remove=function(t){var e=this._subscriptions;if(e){var r=e.indexOf(t);-1!==r&&e.splice(r,1)}},t.EMPTY=function(t){return t.closed=!0,t}(new t),t}();function h(t){return t.reduce(function(t,e){return t.concat(e instanceof f?e.errors:e)},[])}var y=function(){return"function"==typeof Symbol?Symbol("rxSubscriber"):"@@rxSubscriber_"+Math.random()}(),v=function(t){function e(r,n,o){var i=t.call(this)||this;switch(i.syncErrorValue=null,i.syncErrorThrown=!1,i.syncErrorThrowable=!1,i.isStopped=!1,arguments.length){case 0:i.destination=a;break;case 1:if(!r){i.destination=a;break}if("object"==typeof r){r instanceof e?(i.syncErrorThrowable=r.syncErrorThrowable,i.destination=r,r.add(i)):(i.syncErrorThrowable=!0,i.destination=new b(i,r));break}default:i.syncErrorThrowable=!0,i.destination=new b(i,r,n,o)}return i}return o(e,t),e.prototype[y]=function(){return this},e.create=function(t,r,n){var o=new e(t,r,n);return o.syncErrorThrowable=!1,o},e.prototype.next=function(t){this.isStopped||this._next(t)},e.prototype.error=function(t){this.isStopped||(this.isStopped=!0,this._error(t))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this))},e.prototype._next=function(t){this.destination.next(t)},e.prototype._error=function(t){this.destination.error(t),this.unsubscribe()},e.prototype._complete=function(){this.destination.complete(),this.unsubscribe()},e.prototype._unsubscribeAndRecycle=function(){var t=this._parentOrParents;return this._parentOrParents=null,this.unsubscribe(),this.closed=!1,this.isStopped=!1,this._parentOrParents=t,this},e}(d),b=function(t){function e(e,r,n,o){var s,u=t.call(this)||this;u._parentSubscriber=e;var c=u;return i(r)?s=r:r&&(s=r.next,n=r.error,o=r.complete,r!==a&&(i((c=Object.create(r)).unsubscribe)&&u.add(c.unsubscribe.bind(c)),c.unsubscribe=u.unsubscribe.bind(u))),u._context=c,u._next=s,u._error=n,u._complete=o,u}return o(e,t),e.prototype.next=function(t){if(!this.isStopped&&this._next){var e=this._parentSubscriber;u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?this.__tryOrSetError(e,this._next,t)&&this.unsubscribe():this.__tryOrUnsub(this._next,t)}},e.prototype.error=function(t){if(!this.isStopped){var e=this._parentSubscriber,r=u.useDeprecatedSynchronousErrorHandling;if(this._error)r&&e.syncErrorThrowable?(this.__tryOrSetError(e,this._error,t),this.unsubscribe()):(this.__tryOrUnsub(this._error,t),this.unsubscribe());else if(e.syncErrorThrowable)r?(e.syncErrorValue=t,e.syncErrorThrown=!0):c(t),this.unsubscribe();else{if(this.unsubscribe(),r)throw t;c(t)}}},e.prototype.complete=function(){var t=this;if(!this.isStopped){var e=this._parentSubscriber;if(this._complete){var r=function(){return t._complete.call(t._context)};u.useDeprecatedSynchronousErrorHandling&&e.syncErrorThrowable?(this.__tryOrSetError(e,r),this.unsubscribe()):(this.__tryOrUnsub(r),this.unsubscribe())}else this.unsubscribe()}},e.prototype.__tryOrUnsub=function(t,e){try{t.call(this._context,e)}catch(t){if(this.unsubscribe(),u.useDeprecatedSynchronousErrorHandling)throw t;c(t)}},e.prototype.__tryOrSetError=function(t,e,r){if(!u.useDeprecatedSynchronousErrorHandling)throw new Error("bad call");try{e.call(this._context,r)}catch(e){return u.useDeprecatedSynchronousErrorHandling?(t.syncErrorValue=e,t.syncErrorThrown=!0,!0):(c(e),!0)}return!1},e.prototype._unsubscribe=function(){var t=this._parentSubscriber;this._context=null,this._parentSubscriber=null,t.unsubscribe()},e}(v),_=function(){return"function"==typeof Symbol&&Symbol.observable||"@@observable"}();function m(t){return t}var g=function(){function t(t){this._isScalar=!1,t&&(this._subscribe=t)}return t.prototype.lift=function(e){var r=new t;return r.source=this,r.operator=e,r},t.prototype.subscribe=function(t,e,r){var n=this.operator,o=function(t,e,r){if(t){if(t instanceof v)return t;if(t[y])return t[y]()}return t||e||r?new v(t,e,r):new v(a)}(t,e,r);if(n?o.add(n.call(o,this.source)):o.add(this.source||u.useDeprecatedSynchronousErrorHandling&&!o.syncErrorThrowable?this._subscribe(o):this._trySubscribe(o)),u.useDeprecatedSynchronousErrorHandling&&o.syncErrorThrowable&&(o.syncErrorThrowable=!1,o.syncErrorThrown))throw o.syncErrorValue;return o},t.prototype._trySubscribe=function(t){try{return this._subscribe(t)}catch(e){u.useDeprecatedSynchronousErrorHandling&&(t.syncErrorThrown=!0,t.syncErrorValue=e),function(t){for(;t;){var e=t,r=e.closed,n=e.destination,o=e.isStopped;if(r||o)return!1;t=n&&n instanceof v?n:null}return!0}(t)?t.error(e):console.warn(e)}},t.prototype.forEach=function(t,e){var r=this;return new(e=w(e))(function(e,n){var o;o=r.subscribe(function(e){try{t(e)}catch(t){n(t),o&&o.unsubscribe()}},n,e)})},t.prototype._subscribe=function(t){var e=this.source;return e&&e.subscribe(t)},t.prototype[_]=function(){return this},t.prototype.pipe=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return 0===t.length?this:(0===(r=t).length?m:1===r.length?r[0]:function(t){return r.reduce(function(t,e){return e(t)},t)})(this);var r},t.prototype.toPromise=function(t){var e=this;return new(t=w(t))(function(t,r){var n;e.subscribe(function(t){return n=t},function(t){return r(t)},function(){return t(n)})})},t.create=function(e){return new t(e)},t}();function w(t){if(t||(t=u.Promise||Promise),!t)throw new Error("no Promise impl found");return t}function S(t,e){return function(r){if("function"!=typeof t)throw new TypeError("argument is not a function. Are you looking for `mapTo()`?");return r.lift(new j(t,e))}}var j=function(){function t(t,e){this.project=t,this.thisArg=e}return t.prototype.call=function(t,e){return e.subscribe(new O(t,this.project,this.thisArg))},t}(),O=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.project=r,o.count=0,o.thisArg=n||o,o}return o(e,t),e.prototype._next=function(t){var e;try{e=this.project.call(this.thisArg,t,this.count++)}catch(t){return void this.destination.error(t)}this.destination.next(e)},e}(v);function E(t,e,r,n){return i(r)&&(n=r,r=void 0),n?E(t,e,r).pipe(S(function(t){return l(t)?n.apply(void 0,t):n(t)})):new g(function(n){P(t,e,function(t){arguments.length>1?n.next(Array.prototype.slice.call(arguments)):n.next(t)},n,r)})}function P(t,e,r,n,o){var i;if(function(t){return t&&"function"==typeof t.addEventListener&&"function"==typeof t.removeEventListener}(t)){var s=t;t.addEventListener(e,r,o),i=function(){return s.removeEventListener(e,r,o)}}else if(function(t){return t&&"function"==typeof t.on&&"function"==typeof t.off}(t)){var u=t;t.on(e,r),i=function(){return u.off(e,r)}}else if(function(t){return t&&"function"==typeof t.addListener&&"function"==typeof t.removeListener}(t)){var c=t;t.addListener(e,r),i=function(){return c.removeListener(e,r)}}else{if(!t||!t.length)throw new TypeError("Invalid event target");for(var a=0,l=t.length;a<l;a++)P(t[a],e,r,n,o)}n.add(i)}var I=function(t){return function(e){for(var r=0,n=t.length;r<n&&!e.closed;r++)e.next(t[r]);e.complete()}};function C(){return"function"==typeof Symbol&&Symbol.iterator?Symbol.iterator:"@@iterator"}var x=C(),T=function(t){return t&&"number"==typeof t.length&&"function"!=typeof t};function A(t){return!!t&&"function"!=typeof t.subscribe&&"function"==typeof t.then}var R=function(t){if(t&&"function"==typeof t[_])return n=t,function(t){var e=n[_]();if("function"!=typeof e.subscribe)throw new TypeError("Provided object does not correctly implement Symbol.observable");return e.subscribe(t)};if(T(t))return I(t);if(A(t))return r=t,function(t){return r.then(function(e){t.closed||(t.next(e),t.complete())},function(e){return t.error(e)}).then(null,c),t};if(t&&"function"==typeof t[x])return e=t,function(t){for(var r=e[x]();;){var n=void 0;try{n=r.next()}catch(e){return t.error(e),t}if(n.done){t.complete();break}if(t.next(n.value),t.closed)break}return"function"==typeof r.return&&t.add(function(){r.return&&r.return()}),t};var e,r,n,o=p(t)?"an invalid object":"'"+t+"'";throw new TypeError("You provided "+o+" where a stream was expected. You can provide an Observable, Promise, Array, or Iterable.")};function k(t,e){return new g(function(r){var n=new d,o=0;return n.add(e.schedule(function(){o!==t.length?(r.next(t[o++]),r.closed||n.add(this.schedule())):r.complete()})),n})}var q=function(t){function e(e){var r=t.call(this)||this;return r.parent=e,r}return o(e,t),e.prototype._next=function(t){this.parent.notifyNext(t)},e.prototype._error=function(t){this.parent.notifyError(t),this.unsubscribe()},e.prototype._complete=function(){this.parent.notifyComplete(),this.unsubscribe()},e}(v),z=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return o(e,t),e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyError=function(t){this.destination.error(t)},e.prototype.notifyComplete=function(){this.destination.complete()},e}(v);function N(t,e,r){return void 0===r&&(r=Number.POSITIVE_INFINITY),"function"==typeof e?function(n){return n.pipe(N(function(r,n){return(o=t(r,n),o instanceof g?o:new g(R(o))).pipe(S(function(t,o){return e(r,t,n,o)}));var o},r))}:("number"==typeof e&&(r=e),function(e){return e.lift(new V(t,r))})}var V=function(){function t(t,e){void 0===e&&(e=Number.POSITIVE_INFINITY),this.project=t,this.concurrent=e}return t.prototype.call=function(t,e){return e.subscribe(new U(t,this.project,this.concurrent))},t}(),U=function(t){function e(e,r,n){void 0===n&&(n=Number.POSITIVE_INFINITY);var o=t.call(this,e)||this;return o.project=r,o.concurrent=n,o.hasCompleted=!1,o.buffer=[],o.active=0,o.index=0,o}return o(e,t),e.prototype._next=function(t){this.active<this.concurrent?this._tryNext(t):this.buffer.push(t)},e.prototype._tryNext=function(t){var e,r=this.index++;try{e=this.project(t,r)}catch(t){return void this.destination.error(t)}this.active++,this._innerSub(e)},e.prototype._innerSub=function(t){var e=new q(this),r=this.destination;r.add(e);var n=function(t,e){if(!e.closed){if(t instanceof g)return t.subscribe(e);var r;try{r=R(t)(e)}catch(t){e.error(t)}return r}}(t,e);n!==e&&r.add(n)},e.prototype._complete=function(){this.hasCompleted=!0,0===this.active&&0===this.buffer.length&&this.destination.complete(),this.unsubscribe()},e.prototype.notifyNext=function(t){this.destination.next(t)},e.prototype.notifyComplete=function(){var t=this.buffer;this.active--,t.length>0?this._next(t.shift()):0===this.active&&this.hasCompleted&&this.destination.complete()},e}(z);var B,D,H=function(){function t(t,e){this.compare=t,this.keySelector=e}return t.prototype.call=function(t,e){return e.subscribe(new F(t,this.compare,this.keySelector))},t}(),F=function(t){function e(e,r,n){var o=t.call(this,e)||this;return o.keySelector=n,o.hasKey=!1,"function"==typeof r&&(o.compare=r),o}return o(e,t),e.prototype.compare=function(t,e){return t===e},e.prototype._next=function(t){var e;try{var r=this.keySelector;e=r?r(t):t}catch(t){return this.destination.error(t)}var n=!1;if(this.hasKey)try{n=(0,this.compare)(this.key,e)}catch(t){return this.destination.error(t)}else this.hasKey=!0;n||(this.key=e,this.destination.next(t))},e}(v);class M extends Error{constructor(t){var e;super(t||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",e=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,e):this.__proto__=e,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class L extends M{constructor(t,e,r){super(r||"Payment cannot be processed for this order, please select another payment method"),this.type="custom_provider_execute_error",this.name=e,this.subtype=t}}function $(t,e){if(null==t)throw e?e():new Error("An unexpected error has occurred.");return t}!function(t){t[t.CheckoutButtonNotInitialized=0]="CheckoutButtonNotInitialized",t[t.CustomerNotInitialized=1]="CustomerNotInitialized",t[t.PaymentNotInitialized=2]="PaymentNotInitialized",t[t.ShippingNotInitialized=3]="ShippingNotInitialized",t[t.SpamProtectionNotInitialized=4]="SpamProtectionNotInitialized"}(B||(B={}));class G extends M{constructor(t){super(function(t){switch(t){case B.CustomerNotInitialized:return"Unable to proceed because the customer step of checkout has not been initialized.";case B.PaymentNotInitialized:return"Unable to proceed because the payment step of checkout has not been initialized.";case B.ShippingNotInitialized:return"Unable to proceed because the shipping step of checkout has not been initialized.";case B.SpamProtectionNotInitialized:return"Unable to proceed because the checkout spam protection has not been initialized.";default:return"Unable to proceed because the required component has not been initialized."}}(t)),this.subtype=t,this.name="NotInitializedError",this.type="not_initialized"}}!function(t){t.CHARGE="CHARGE",t.STORE="STORE"}(D||(D={}));var J=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(s,u)}c((n=n.apply(t,e||[])).next())})};class K{constructor(t,e){this._scriptLoader=t,this._paymentIntegrationService=e}initialize({testMode:t,applicationId:e,locationId:r}){return J(this,void 0,void 0,function*(){const n=yield this._scriptLoader.load(t);this._payments=n.payments(e,r)})}deinitialize(){return J(this,void 0,void 0,function*(){this._formValidationSubscription&&this._formValidationSubscription.unsubscribe(),this._card&&(yield this._card.destroy()),this._formValidationSubscription=void 0,this._card=void 0,this._payments=void 0})}initializeCard({containerId:t,style:e,onValidationChange:r}){return J(this,void 0,void 0,function*(){const{postalCode:n}=this._paymentIntegrationService.getState().getBillingAddress()||{};this._card=yield this._getPayments().card(),yield this._card.attach(`#${t}`);try{yield this._card.configure({postalCode:n,style:e})}catch(t){}r&&(this._formValidationSubscription=this._subscribeToFormValidation(this._card,r))})}tokenize(){return J(this,void 0,void 0,function*(){const t=yield this._getCard().tokenize();if("OK"!==t.status||!t.token){let e=`Tokenization failed with status: ${t.status}`;throw t.errors&&(e+=` and errors: ${JSON.stringify(t.errors)}`),new L("payment.errors.card_error","SquareV2TokenizationError",e)}return t.token})}verifyBuyer(t,e){return J(this,void 0,void 0,function*(){return e===D.CHARGE?this._chargeVerifyBuyer(t):this._storeVerifyBuyer(t)})}_getPayments(){return $(this._payments,()=>new G(B.PaymentNotInitialized))}_subscribeToFormValidation(t,e){const r=["cardNumber","cvv"],n=new Set(r);return function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r,n=Number.POSITIVE_INFINITY,o=null,i=t[t.length-1];return(r=i)&&"function"==typeof r.schedule?(o=t.pop(),t.length>1&&"number"==typeof t[t.length-1]&&(n=t.pop())):"number"==typeof i&&(n=t.pop()),null===o&&1===t.length&&t[0]instanceof g?t[0]:function(t){return void 0===t&&(t=Number.POSITIVE_INFINITY),N(m,t)}(n)(function(t,e){return e?k(t,e):new g(I(t))}(t,o))}(...["focusClassAdded","focusClassRemoved","errorClassAdded","errorClassRemoved","cardBrandChanged","postalCodeChanged"].map(e=>E(t,e))).pipe(S(t=>{const{detail:{field:e,currentState:{isCompletelyValid:o}}}=t;return r.includes(e)&&n[o?"delete":"add"](e),0===n.size}),function(t){return t.lift(new H(undefined,undefined))}).subscribe(e)}_getCard(){return $(this._card,()=>new G(B.PaymentNotInitialized))}_mapToSquareBillingContact({firstName:t,lastName:e,address1:r,address2:n,city:o,stateOrProvinceCode:i,postalCode:s,countryCode:u,email:c,phone:a}){return{givenName:t,familyName:e,addressLines:[r,n],city:o,state:i,postalCode:s,countryCode:u,email:c,phone:a}}_chargeVerifyBuyer(t){return J(this,void 0,void 0,function*(){const{getCheckoutOrThrow:e,getBillingAddressOrThrow:r}=this._paymentIntegrationService.getState(),{outstandingBalance:n,cart:o}=e(),i={amount:n.toString(),billingContact:this._mapToSquareBillingContact(r()),currencyCode:o.currency.code,intent:D.CHARGE},s=yield this._getPayments().verifyBuyer(t,i);return s?s.token:""})}_storeVerifyBuyer(t){return J(this,void 0,void 0,function*(){const{getBillingAddressOrThrow:e}=this._paymentIntegrationService.getState(),r={billingContact:this._mapToSquareBillingContact(e()),intent:D.STORE},n=yield this._getPayments().verifyBuyer(t,r);return n?n.token:""})}}class Y extends M{constructor(t){super(t||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}const X={body:{},headers:{},status:0};class Q extends M{constructor(t,{message:e,errors:r}={}){const{body:n,headers:o,status:i}=t||X;super(e||"An unexpected error has occurred."),this.name="RequestError",this.type="request",this.body=n,this.headers=o,this.status=i,this.errors=r||[]}}class W extends Q{constructor(t){super(t,{message:"There is a problem processing your payment. Please try again later."}),this.name="PaymentMethodInvalidError",this.type="payment_method_invalid"}}class Z extends Y{constructor(t){let e="Unable to submit payment for the order because the payload is invalid.";t&&(e=`${e} Make sure the following fields are provided correctly: ${t.join(", ")}.`),super(e),this.name="PaymentArgumentInvalidError"}}class tt extends M{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}var et=function(t,e,r,n){return new(r||(r=Promise))(function(o,i){function s(t){try{c(n.next(t))}catch(t){i(t)}}function u(t){try{c(n.throw(t))}catch(t){i(t)}}function c(t){var e;t.done?o(t.value):(e=t.value,e instanceof r?e:new r(function(t){t(e)})).then(s,u)}c((n=n.apply(t,e||[])).next())})};class rt{constructor(t,e){this._paymentIntegrationService=t,this._squareV2PaymentProcessor=e}initialize(t){var e;return et(this,void 0,void 0,function*(){if(!(null===(e=null==t?void 0:t.squarev2)||void 0===e?void 0:e.containerId))throw new Y('Unable to proceed because "containerId" argument is not provided.');const{methodId:r,squarev2:n}=t,{config:{testMode:o},initializationData:i}=this._paymentIntegrationService.getState().getPaymentMethodOrThrow(r),{applicationId:s,locationId:u}=i||{};if(!s)throw new W;yield this._squareV2PaymentProcessor.initialize({applicationId:s,locationId:u,testMode:o}),yield this._squareV2PaymentProcessor.initializeCard(n)})}execute({payment:t}){return et(this,void 0,void 0,function*(){if(!t)throw new Z(["payment"]);const{methodId:e,paymentData:r}=t,{shouldSaveInstrument:n,shouldSetAsDefaultInstrument:o}="object"!=typeof(i=r)||null===i||void 0!==i.shouldSaveInstrument&&"boolean"!=typeof i.shouldSaveInstrument||void 0!==i.shouldSetAsDefaultInstrument&&"boolean"!=typeof i.shouldSetAsDefaultInstrument?{shouldSaveInstrument:!1,shouldSetAsDefaultInstrument:!1}:r;var i;yield this._paymentIntegrationService.submitOrder();const s=r&&function(t){return Boolean(t.instrumentId)}(r)?yield this._getVaultedInstrumentPayload(e,r):yield this._getCardPayload(e,n);yield this._paymentIntegrationService.submitPayment(Object.assign(Object.assign({},t),{paymentData:{formattedPayload:Object.assign(Object.assign({},s),{vault_payment_instrument:n||!1,set_as_default_stored_instrument:o||!1})}}))})}finalize(){return Promise.reject(new tt)}deinitialize(){return this._squareV2PaymentProcessor.deinitialize()}shouldVerify(){const{features:t}=this._paymentIntegrationService.getState().getStoreConfigOrThrow().checkoutSettings;return t["PROJECT-3828.add_3ds_support_on_squarev2"]}_getCardPayload(t,e){return et(this,void 0,void 0,function*(){const{getPaymentMethodOrThrow:r}=this._paymentIntegrationService.getState(),{initializationData:n}=r(t),o=yield this._squareV2PaymentProcessor.tokenize();if(n&&"isSquareV2ApiV2Enabled"in n?!n.isSquareV2ApiV2Enabled:!this.shouldVerify())return{credit_card_token:{token:o}};let i={nonce:o,token:yield this._squareV2PaymentProcessor.verifyBuyer(o,D.CHARGE)};if(e){const t=yield this._squareV2PaymentProcessor.tokenize();i=Object.assign(Object.assign({},i),{store_card_nonce:t,store_card_token:yield this._squareV2PaymentProcessor.verifyBuyer(t,D.STORE)})}return{credit_card_token:{token:JSON.stringify(i)}}})}_getVaultedInstrumentPayload(t,e){return et(this,void 0,void 0,function*(){const{getPaymentMethodOrThrow:r}=this._paymentIntegrationService.getState(),{initializationData:n}=r(t),{instrumentId:o}=e,i=(n&&"isSquareV2ApiV2Enabled"in n?n.isSquareV2ApiV2Enabled:this.shouldVerify())?yield this._squareV2PaymentProcessor.verifyBuyer(yield this._getSquareCardIdOrThrow(t,o),D.CHARGE):void 0;return{bigpay_token:Object.assign({token:o},i&&{three_d_secure:{token:i}})}})}_getSquareCardIdOrThrow(t,e){return et(this,void 0,void 0,function*(){const r=yield this._paymentIntegrationService.loadPaymentMethod(t,{params:{method:t,bigpayToken:e}}),{initializationData:n}=r.getPaymentMethodOrThrow(t),{cardId:o}=n||{};if(!o)throw new Z(["cardId"]);return o})}}class nt extends M{constructor(t){super(t||"Unable to proceed because the client library of a payment method is not loaded or ready to be used."),this.name="PaymentMethodClientUnavailableError",this.type="payment_method_client_unavailable"}}var ot;!function(t){t.LIVE="https://web.squarecdn.com/v1/square.js",t.SANDBOX="https://sandbox.web.squarecdn.com/v1/square.js"}(ot||(ot={}));class it{constructor(t){this._scriptLoader=t}load(t=!1){return e=this,r=void 0,o=function*(){return yield this._scriptLoader.loadScript(t?ot.SANDBOX:ot.LIVE),function(t){if(!function(t){return"Square"in t}(t))throw new nt}(window),window.Square},new((n=void 0)||(n=Promise))(function(t,i){function s(t){try{c(o.next(t))}catch(t){i(t)}}function u(t){try{c(o.throw(t))}catch(t){i(t)}}function c(e){var r;e.done?t(e.value):(r=e.value,r instanceof n?r:new n(function(t){t(r)})).then(s,u)}c((o=o.apply(e,r||[])).next())});var e,r,n,o}}const st=Object.assign(e=>new rt(e,new K(new it((0,t.vQ)()),e)),{resolveIds:[{id:"squarev2"}]})})(),module.exports=n})();
//# sourceMappingURL=squarev2.js.map