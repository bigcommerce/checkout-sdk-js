(()=>{"use strict";var e={5470:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9783),n=function(){function e(e,t){this._formBuilder=e,this._options=t}return e.prototype.postForm=function(e,t,r,o){var n=this._formBuilder.build(this._prependHost(e),t,o);window.addEventListener("unload",function e(){window.removeEventListener("unload",e),r&&r()}),document.body.appendChild(n),n.submit()},e.prototype._prependHost=function(e){return this._options&&this._options.host&&!(0,o.isAbsoluteUrl)(e)?(0,o.joinPaths)(this._options.host,e):e},e}();t.default=n},8686:(e,t,r)=>{t.createFormPoster=void 0;var o=r(9165);Object.defineProperty(t,"createFormPoster",{enumerable:!0,get:function(){return o.default}});r(5470)},9165:(e,t,r)=>{Object.defineProperty(t,"__esModule",{value:!0});var o=r(9828),n=r(5470);t.default=function(e){var t=new o.default;return new n.default(t,e)}},9783:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.joinPaths=t.isAbsoluteUrl=void 0,t.isAbsoluteUrl=function(e){return/^https?:\/\//.test(e)},t.joinPaths=function(e,t){return"".concat((r=e,r.replace(/\/$/,"")),"/").concat(function(e){return e.replace(/^\//,"")}(t));var r}},9828:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0});var r=function(){function e(){}return e.prototype.build=function(e,t,r){var o=this,n=document.createElement("form");return n.style.display="none",n.setAttribute("action",e),n.setAttribute("method","POST"),n.setAttribute("target",r||"_top"),Object.keys(t).forEach(function(e){var r=t[e];n.appendChild(o._createInput(r,e))}),n},e.prototype._createInput=function(e,t){var r=document.createElement("input");return r.setAttribute("name",t),r.setAttribute("type","hidden"),r.setAttribute("value",e),r},e}();t.default=r}},t={};function r(o){var n=t[o];if(void 0!==n)return n.exports;var i=t[o]={exports:{}};return e[o](i,i.exports,r),i.exports}r.d=(e,t)=>{for(var o in t)r.o(t,o)&&!r.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})},r.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var o={};r.r(o),r.d(o,{createHummPaymentStrategy:()=>l});var n=r(8686);class i extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class a extends i{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class s extends a{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}class d extends i{constructor(e,t,r){super(r||"Payment cannot be processed for this order, please select another payment method"),this.type="custom_provider_execute_error",this.name=t,this.subtype=e}}class u extends i{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}class c{constructor(e,t){this.paymentIntegrationService=e,this.formPoster=t}execute(e,t){var r,o,n,i,a;return o=this,n=void 0,a=function*(){const{payment:o}=e,n=function(e,t){var r={};for(var o in e)Object.prototype.hasOwnProperty.call(e,o)&&t.indexOf(o)<0&&(r[o]=e[o]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(o=Object.getOwnPropertySymbols(e);n<o.length;n++)t.indexOf(o[n])<0&&Object.prototype.propertyIsEnumerable.call(e,o[n])&&(r[o[n]]=e[o[n]])}return r}(e,["payment"]);if(!(null==o?void 0:o.methodId))throw new s(["payment.methodId"]);yield this.paymentIntegrationService.loadPaymentMethod(o.methodId,t);const i=this.paymentIntegrationService.getState().getPaymentMethodOrThrow(o.methodId);if(!(null===(r=i.initializationData)||void 0===r?void 0:r.processable))throw new d("payment.humm_not_processable_error","hummNotProcessableError");yield this.paymentIntegrationService.submitOrder(n,t);try{yield this.paymentIntegrationService.submitPayment({methodId:o.methodId})}catch(e){return this.isOffsiteRedirectResponse(e)?this.handleOffsiteRedirectResponse(e):Promise.reject(e)}},new((i=void 0)||(i=Promise))(function(e,t){function r(e){try{d(a.next(e))}catch(e){t(e)}}function s(e){try{d(a.throw(e))}catch(e){t(e)}}function d(t){var o;t.done?e(t.value):(o=t.value,o instanceof i?o:new i(function(e){e(o)})).then(r,s)}d((a=a.apply(o,n||[])).next())})}finalize(){return Promise.reject(new u)}initialize(){return Promise.resolve()}deinitialize(){return Promise.resolve()}handleOffsiteRedirectResponse(e){const t=e.body.additional_action_required.data.redirect_url,r=e.body.provider_data;return new Promise(e=>{this.formPoster.postForm(t,JSON.parse(r),e)})}isOffsiteRedirectResponse(e){if("object"!=typeof e||null===e)return!1;const t=e;if(!t.body)return!1;const r=t.body;return"additional_action_required"===r.status&&!!r.additional_action_required&&"offsite_redirect"===r.additional_action_required.type&&"string"==typeof r.provider_data}}const l=Object.assign(e=>new c(e,(0,n.createFormPoster)()),{resolveIds:[{id:"humm"}]});module.exports=o})();
//# sourceMappingURL=humm.js.map