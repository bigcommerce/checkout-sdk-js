(()=>{"use strict";var e,t={d:(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},r={};function n(e){return!("object"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&"boolean"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&"boolean"!=typeof e.shouldSetAsDefaultInstrument)}t.r(r),t.d(r,{createOffsitePaymentStrategy:()=>c});class o extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class a extends o{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class i extends a{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}!function(e){e.ACKNOWLEDGE="ACKNOWLEDGE",e.FINALIZE="FINALIZE",e.INITIALIZE="INITIALIZE"}(e||(e={}));const s=e;class u extends o{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}var d=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}u((n=n.apply(e,t||[])).next())})};class l{constructor(e){this._paymentIntegrationService=e}execute(e,t){return d(this,void 0,void 0,function*(){const{payment:r}=e,o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["payment"]),a=this._shouldSubmitFullPayload(r)?e:o,s=r&&r.paymentData,u=s&&Boolean(s.instrumentId)&&s.instrumentId||void 0,d=s&&n(s)&&s.shouldSaveInstrument||void 0,l=s&&n(s)&&s.shouldSetAsDefaultInstrument||void 0;if(!r)throw new i(["payment"]);const{methodId:c,gatewayId:y}=r;yield this._paymentIntegrationService.submitOrder(a,t),yield this._paymentIntegrationService.initializeOffsitePayment({methodId:c,gatewayId:y,instrumentId:u,shouldSaveInstrument:d,shouldSetAsDefaultInstrument:l})})}finalize(e){return d(this,void 0,void 0,function*(){const t=this._paymentIntegrationService.getState(),r=t.getOrder(),n=t.getPaymentStatus();if(!r||n!==s.ACKNOWLEDGE&&n!==s.FINALIZE)return Promise.reject(new u);yield this._paymentIntegrationService.finalizeOrder(e)})}initialize(){return Promise.resolve()}deinitialize(){return Promise.resolve()}_shouldSubmitFullPayload(e){return!!e&&("adyen"===e.gatewayId||"barclaycard"===e.gatewayId)}}const c=Object.assign(e=>new l(e),{resolveIds:[{type:"PAYMENT_TYPE_HOSTED"}]});module.exports=r})();
//# sourceMappingURL=offsite.js.map