{"version":3,"file":"embedded-checkout.js","mappings":"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","sources":["webpack://@bigcommerce/checkout-sdk/external commonjs \"iframe-resizer\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"iframe-resizer/js/iframeResizer.contentWindow\"","webpack://@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://@bigcommerce/checkout-sdk/webpack/runtime/compat get default export","webpack://@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://@bigcommerce/checkout-sdk/webpack/runtime/make namespace object","webpack://@bigcommerce/checkout-sdk/external commonjs \"@bigcommerce/request-sender\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"tslib\"","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/standard-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/utility/set-prototype-of.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/invalid-argument-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/parse-url.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/utility/bind-decorator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/is-iframe-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-listener.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/append-www.ts","webpack://@bigcommerce/checkout-sdk/external commonjs \"rxjs\"","webpack://@bigcommerce/checkout-sdk/external commonjs \"rxjs/operators\"","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-poster.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/loading-indicator/loading-indicator.ts","webpack://@bigcommerce/checkout-sdk/external commonjs \"local-storage-fallback\"","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/storage/browser-storage.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/invalid-login-token-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/not-embeddable-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/embedded-content-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/resizable-iframe-creator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-resizer.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embed-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/handle-frame-loaded-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/custom-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/iframe-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/noop-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/create-embedded-checkout-messenger.ts"],"sourcesContent":["module.exports = require(\"iframe-resizer\");","module.exports = require(\"iframe-resizer/js/iframeResizer.contentWindow\");","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = (module) => {\n\tvar getter = module && module.__esModule ?\n\t\t() => (module['default']) :\n\t\t() => (module);\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","// define __esModule on exports\n__webpack_require__.r = (exports) => {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"@bigcommerce/request-sender\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"tslib\");","import { setPrototypeOf } from '../../utility';\n\nimport CustomError from './custom-error';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import { InvalidArgumentError } from '../error/errors';\n\nimport Url from './url';\n\nexport default function parseUrl(url: string): Url {\n    if (!/^(https?:)?\\/\\//.test(url)) {\n        throw new InvalidArgumentError('The provided URL must be absolute.');\n    }\n\n    // new URL() is not supported in IE11, use anchor tag instead\n    const anchor = document.createElement('a');\n\n    anchor.href = url;\n\n    // IE11 returns 80 or 443 for the port number depending on the URL scheme,\n    // even if the port number is not specified in the URL.\n    const port =\n        anchor.port && url.indexOf(`${anchor.hostname}:${anchor.port}`) !== -1 ? anchor.port : '';\n\n    return {\n        hash: anchor.hash,\n        hostname: anchor.hostname,\n        href: anchor.href,\n        origin: `${anchor.protocol}//${anchor.hostname}${port ? `:${port}` : ''}`,\n        pathname: anchor.pathname,\n        port,\n        protocol: anchor.protocol,\n        search: anchor.search,\n    };\n}\n","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nfunction bindDecorator<T extends Method>(\n    target: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T>;\nfunction bindDecorator<T extends Constructor<object>>(target: T): T;\n\nfunction bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\nexport default bindDecorator;\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype).forEach((key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n        if (!descriptor || key === 'constructor') {\n            return;\n        }\n\n        Object.defineProperty(\n            decoratedTarget.prototype,\n            key,\n            bindMethodDecorator(target.prototype, key, descriptor),\n        );\n    });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(\n    _: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            const boundMethod = method.bind(this) as T;\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n","import IframeEvent from './iframe-event';\n\nexport default function isIframeEvent<TEvent extends IframeEvent<TType>, TType extends string>(\n    object: any,\n    type: TType,\n): object is TEvent {\n    return object.type === type;\n}\n","import { appendWww, parseUrl } from '../url';\nimport { bindDecorator as bind } from '../utility';\n\nimport { IframeEventMap } from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport default class IframeEventListener<TEventMap extends IframeEventMap<keyof TEventMap>> {\n    private _isListening: boolean;\n    private _listeners: EventListeners<TEventMap>;\n    private _sourceOrigins: string[];\n\n    constructor(sourceOrigin: string) {\n        this._sourceOrigins = [\n            parseUrl(sourceOrigin).origin,\n            appendWww(parseUrl(sourceOrigin)).origin,\n        ];\n        this._isListening = false;\n        this._listeners = {};\n    }\n\n    listen(): void {\n        if (this._isListening) {\n            return;\n        }\n\n        this._isListening = true;\n\n        window.addEventListener('message', this._handleMessage);\n    }\n\n    stopListen(): void {\n        if (!this._isListening) {\n            return;\n        }\n\n        this._isListening = false;\n\n        window.removeEventListener('message', this._handleMessage);\n    }\n\n    addListener<TType extends keyof TEventMap>(\n        type: TType,\n        listener: (event: TEventMap[TType]) => void,\n    ): void {\n        let listeners = this._listeners[type];\n\n        if (!listeners) {\n            this._listeners[type] = listeners = [];\n        }\n\n        if (listeners.indexOf(listener) === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    removeListener<TType extends keyof TEventMap>(\n        type: TType,\n        listener: (event: TEventMap[TType]) => void,\n    ): void {\n        const listeners = this._listeners[type];\n\n        if (!listeners) {\n            return;\n        }\n\n        const index = listeners.indexOf(listener);\n\n        if (index >= 0) {\n            listeners.splice(index, 1);\n        }\n    }\n\n    trigger<TType extends keyof TEventMap>(event: TEventMap[TType]): void {\n        const listeners = this._listeners[event.type];\n\n        if (!listeners) {\n            return;\n        }\n\n        listeners.forEach((listener) => listener(event));\n    }\n\n    @bind\n    private _handleMessage(event: MessageEvent): void {\n        if (\n            this._sourceOrigins.indexOf(event.origin) === -1 ||\n            !isIframeEvent(event.data as TEventMap[keyof TEventMap], event.data.type)\n        ) {\n            return;\n        }\n\n        this.trigger(event.data);\n    }\n}\n\ntype EventListeners<TEventMap> = {\n    [key in keyof TEventMap]?: Array<(event: TEventMap[key]) => void>;\n};\n","import parseUrl from './parse-url';\nimport Url from './url';\n\nexport default function appendWww(url: Url): Url {\n    return parseUrl(\n        url.hostname.indexOf('www') === 0\n            ? url.href\n            : url.href.replace(url.hostname, `www.${url.hostname}`),\n    );\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"rxjs\");","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"rxjs/operators\");","import { fromEvent } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\n\nimport { parseUrl } from '../url';\n\nimport IframeEvent from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport interface IframeEventPostOptions<\n    TSuccessEvent extends IframeEvent,\n    TErrorEvent extends IframeEvent,\n> {\n    errorType?: TErrorEvent['type'];\n    successType?: TSuccessEvent['type'];\n}\n\nexport default class IframeEventPoster<TEvent> {\n    private _targetOrigin: string;\n\n    constructor(targetOrigin: string, private _targetWindow?: Window) {\n        this._targetOrigin = targetOrigin === '*' ? '*' : parseUrl(targetOrigin).origin;\n    }\n\n    post(event: TEvent): void;\n    post<\n        TSuccessEvent extends IframeEvent = IframeEvent,\n        TErrorEvent extends IframeEvent = IframeEvent,\n    >(\n        event: TEvent,\n        options: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\n    ): Promise<TSuccessEvent>;\n    post<\n        TSuccessEvent extends IframeEvent = IframeEvent,\n        TErrorEvent extends IframeEvent = IframeEvent,\n    >(\n        event: TEvent,\n        options?: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\n    ): Promise<TSuccessEvent> | void {\n        const targetWindow = this._targetWindow;\n\n        if (window === targetWindow) {\n            return;\n        }\n\n        if (!targetWindow) {\n            throw new Error('Unable to post message because target window is not set.');\n        }\n\n        const result =\n            options &&\n            fromEvent<MessageEvent>(window, 'message')\n                .pipe(\n                    filter(\n                        (event) =>\n                            event.origin === this._targetOrigin &&\n                            isIframeEvent(event.data, event.data.type) &&\n                            [options.successType, options.errorType].indexOf(event.data.type) !==\n                                -1,\n                    ),\n                    map((event) => {\n                        if (options.errorType === event.data.type) {\n                            throw event.data;\n                        }\n\n                        return event.data;\n                    }),\n                    take(1),\n                )\n                .toPromise();\n\n        targetWindow.postMessage(event, this._targetOrigin);\n\n        return result;\n    }\n\n    setTarget(window: Window) {\n        this._targetWindow = window;\n    }\n}\n","import { LoadingIndicatorStyles } from './loading-indicator-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\nexport default class LoadingIndicator {\n    private _container: HTMLElement;\n    private _indicator: HTMLElement;\n    private _styles: LoadingIndicatorStyles;\n\n    constructor(options?: { styles?: LoadingIndicatorStyles }) {\n        this._styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\n\n        this._defineAnimation();\n\n        this._container = this._buildContainer();\n        this._indicator = this._buildIndicator();\n\n        this._container.appendChild(this._indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error(\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\n                );\n            }\n\n            parent.appendChild(this._container);\n        }\n\n        this._container.style.visibility = 'visible';\n        this._container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this._container.style.visibility = 'hidden';\n\n            this._container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this._container.addEventListener('transitionend', handleTransitionEnd);\n\n        this._container.style.opacity = '0';\n    }\n\n    private _buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        return container;\n    }\n\n    private _buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this._styles.size}px`;\n        indicator.style.height = `${this._styles.size}px`;\n        indicator.style.borderRadius = `${this._styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this._styles.backgroundColor} ${this._styles.backgroundColor} ${this._styles.color} ${this._styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private _defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        document.head.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(\n                `\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,\n                0,\n            );\n        }\n    }\n}\n","const __WEBPACK_NAMESPACE_OBJECT__ = require(\"local-storage-fallback\");","import { default as storage } from 'local-storage-fallback';\n\nexport default class BrowserStorage {\n    constructor(private _namespace: string) {}\n\n    getItem<TValue = any>(key: string): TValue | null {\n        const rawValue = storage.getItem(this.withNamespace(key));\n\n        if (rawValue === null) {\n            return null;\n        }\n\n        try {\n            return JSON.parse(rawValue);\n        } catch (error) {\n            // Clean up invalid values\n            this.removeItem(this.withNamespace(key));\n\n            return null;\n        }\n    }\n\n    getItemOnce<TValue = any>(key: string): TValue | null {\n        const value = this.getItem(key);\n\n        this.removeItem(key);\n\n        return value;\n    }\n\n    setItem<TValue = any>(key: string, value: TValue): void {\n        return storage.setItem(this.withNamespace(key), JSON.stringify(value));\n    }\n\n    removeItem(key: string): void {\n        return storage.removeItem(this.withNamespace(key));\n    }\n\n    private withNamespace(key: string): string {\n        return `${this._namespace}.${key}`;\n    }\n}\n","import EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedContentOptions } from './iframe-content';\n\nexport enum EmbeddedCheckoutEventType {\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\n    CheckoutError = 'CHECKOUT_ERROR',\n    CheckoutLoaded = 'CHECKOUT_LOADED',\n    FrameError = 'FRAME_ERROR',\n    FrameLoaded = 'FRAME_LOADED',\n    SignedOut = 'SIGNED_OUT',\n}\n\nexport interface EmbeddedCheckoutEventMap {\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\n    [EmbeddedCheckoutEventType.SignedOut]: EmbeddedCheckoutSignedOutEvent;\n}\n\nexport type EmbeddedCheckoutEvent =\n    | EmbeddedCheckoutCompleteEvent\n    | EmbeddedCheckoutErrorEvent\n    | EmbeddedCheckoutFrameErrorEvent\n    | EmbeddedCheckoutFrameLoadedEvent\n    | EmbeddedCheckoutLoadedEvent\n    | EmbeddedCheckoutSignedOutEvent;\n\nexport interface EmbeddedCheckoutCompleteEvent {\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\n}\n\nexport interface EmbeddedCheckoutErrorEvent {\n    type: EmbeddedCheckoutEventType.CheckoutError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutLoadedEvent {\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\n}\n\nexport interface EmbeddedCheckoutFrameErrorEvent {\n    type: EmbeddedCheckoutEventType.FrameError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutFrameLoadedEvent {\n    type: EmbeddedCheckoutEventType.FrameLoaded;\n    payload?: EmbeddedContentOptions;\n}\n\nexport interface EmbeddedCheckoutSignedOutEvent {\n    type: EmbeddedCheckoutEventType.SignedOut;\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport { InternalErrorResponseBody } from '../../common/error';\nimport { RequestError } from '../../common/error/errors';\n\n/**\n * Throw this error we are not able to sign in a shopper because the provided\n * login token is invalid.\n */\nexport default class InvalidLoginTokenError extends RequestError {\n    constructor(response: Response<InternalErrorResponseBody>) {\n        super(response, { message: response.body.title });\n\n        this.name = 'InvalidLoginTokenError';\n        this.type = 'invalid_login_token';\n    }\n}\n","import { StandardError } from '../../common/error/errors';\n\nexport enum NotEmbeddableErrorType {\n    MissingContainer = 'missing_container',\n    MissingContent = 'missing_content',\n    UnknownError = 'unknown_error',\n}\n\n/**\n * Throw this error if we are not able to embed the checkout form as an iframe.\n * This can be due to the fact that the provided container ID is invalid, or the\n * checkout form fails to load inside the iframe. It can also be due to an\n * unknown reason.\n */\nexport default class NotEmbeddableError extends StandardError {\n    constructor(\n        message?: string,\n        public subtype: NotEmbeddableErrorType = NotEmbeddableErrorType.UnknownError,\n    ) {\n        super(message || 'Unable to embed the checkout form.');\n\n        this.name = 'NotEmbeddableError';\n        this.type = 'not_embeddable';\n    }\n}\n","import EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nexport enum EmbeddedContentEventType {\n    StyleConfigured = 'STYLE_CONFIGURED',\n}\n\nexport interface EmbeddedContentEventMap {\n    [EmbeddedContentEventType.StyleConfigured]: EmbeddedContentStyleConfiguredEvent;\n}\n\nexport type EmbeddedContentEvent = EmbeddedContentStyleConfiguredEvent;\n\nexport interface EmbeddedContentStyleConfiguredEvent {\n    type: EmbeddedContentEventType.StyleConfigured;\n    payload: EmbeddedCheckoutStyles;\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport { IFrameComponent, IframeEventListener, IframeEventPoster } from '../common/iframe';\nimport { LoadingIndicator } from '../common/loading-indicator';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\nimport { bindDecorator as bind } from '../common/utility';\n\nimport EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { InvalidLoginTokenError, NotEmbeddableError, NotEmbeddableErrorType } from './errors';\nimport { EmbeddedContentEvent, EmbeddedContentEventType } from './iframe-content';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nexport const ALLOW_COOKIE_ATTEMPT_INTERVAL = 10 * 60 * 1000;\nexport const IS_COOKIE_ALLOWED_KEY = 'isCookieAllowed';\nexport const LAST_ALLOW_COOKIE_ATTEMPT_KEY = 'lastAllowCookieAttempt';\n\n@bind\nexport default class EmbeddedCheckout {\n    private _iframe?: IFrameComponent;\n    private _isAttached: boolean;\n\n    /**\n     * @internal\n     */\n    constructor(\n        private _iframeCreator: ResizableIframeCreator,\n        private _messageListener: IframeEventListener<EmbeddedCheckoutEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedContentEvent>,\n        private _loadingIndicator: LoadingIndicator,\n        private _requestSender: RequestSender,\n        private _storage: BrowserStorage,\n        private _location: Location,\n        private _options: EmbeddedCheckoutOptions,\n    ) {\n        this._isAttached = false;\n\n        if (this._options.onComplete) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutComplete,\n                this._options.onComplete,\n            );\n        }\n\n        if (this._options.onError) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutError,\n                this._options.onError,\n            );\n        }\n\n        if (this._options.onLoad) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutLoaded,\n                this._options.onLoad,\n            );\n        }\n\n        if (this._options.onFrameLoad) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.FrameLoaded,\n                this._options.onFrameLoad,\n            );\n        }\n\n        if (this._options.onSignOut) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.SignedOut,\n                this._options.onSignOut,\n            );\n        }\n\n        this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, () =>\n            this._configureStyles(),\n        );\n    }\n\n    attach(): Promise<this> {\n        if (this._isAttached) {\n            return Promise.resolve(this);\n        }\n\n        this._isAttached = true;\n        this._messageListener.listen();\n        this._loadingIndicator.show(this._options.containerId);\n\n        return this._allowCookie()\n            .then(() => this._attemptLogin())\n            .then((url) => this._iframeCreator.createFrame(url, this._options.containerId))\n            .then((iframe) => {\n                this._iframe = iframe;\n\n                this._configureStyles();\n                this._loadingIndicator.hide();\n            })\n            .catch((error) => {\n                this._isAttached = false;\n\n                return this._retryAllowCookie(error).catch(() => {\n                    this._messageListener.trigger({\n                        type: EmbeddedCheckoutEventType.FrameError,\n                        payload: error,\n                    });\n\n                    this._loadingIndicator.hide();\n\n                    throw error;\n                });\n            })\n            .then(() => this);\n    }\n\n    detach(): void {\n        if (!this._isAttached) {\n            return;\n        }\n\n        this._isAttached = false;\n        this._messageListener.stopListen();\n\n        if (this._iframe && this._iframe.parentNode) {\n            this._iframe.parentNode.removeChild(this._iframe);\n            this._iframe.iFrameResizer.close();\n        }\n    }\n\n    private _configureStyles(): void {\n        if (!this._iframe || !this._iframe.contentWindow || !this._options.styles) {\n            return;\n        }\n\n        this._messagePoster.setTarget(this._iframe.contentWindow);\n\n        this._messagePoster.post({\n            type: EmbeddedContentEventType.StyleConfigured,\n            payload: this._options.styles,\n        });\n    }\n\n    private _attemptLogin(): Promise<string> {\n        if (!/^\\/login\\/token/.test(parseUrl(this._options.url).pathname)) {\n            return Promise.resolve(this._options.url);\n        }\n\n        return this._requestSender\n            .post<{ redirectUrl: string }>(this._options.url)\n            .then(({ body: { redirectUrl } }) => redirectUrl)\n            .catch((response) => Promise.reject(new InvalidLoginTokenError(response)));\n    }\n\n    /**\n     * This workaround is required for certain browsers (namely Safari) that\n     * prevent session cookies to be set for a third party website unless the\n     * user has recently visited such website. Therefore, before we attempt to\n     * login or set an active cart in the session, we need to first redirect the\n     * user to the domain of Embedded Checkout.\n     */\n    private _allowCookie(): Promise<void> {\n        if (this._storage.getItem(IS_COOKIE_ALLOWED_KEY)) {\n            return Promise.resolve();\n        }\n\n        this._storage.setItem(IS_COOKIE_ALLOWED_KEY, true);\n\n        // It could be possible that the flag is set to true but the browser has\n        // already removed the permission to store third-party cookies. In that\n        // case, we should try to redirect the user again. But we only want to\n        // do it once within a fixed interval. This is to avoid getting into a\n        // redirect loop if the shopper actually doesn't have a valid card\n        // session.\n        this._storage.setItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY, Date.now());\n\n        const { origin } = parseUrl(this._options.url);\n        const redirectUrl = `${origin}/embedded-checkout/allow-cookie?returnUrl=${encodeURIComponent(\n            this._location.href,\n        )}`;\n\n        document.body.style.visibility = 'hidden';\n        this._location.replace(redirectUrl);\n\n        return new Promise<never>(() => {});\n    }\n\n    private _retryAllowCookie(error: EmbeddedCheckoutError): Promise<void> {\n        const lastAttempt = Number(this._storage.getItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY));\n        const canRetry =\n            (!lastAttempt || Date.now() - lastAttempt > ALLOW_COOKIE_ATTEMPT_INTERVAL) &&\n            error instanceof NotEmbeddableError &&\n            error.subtype === NotEmbeddableErrorType.MissingContent;\n\n        if (!canRetry) {\n            return Promise.reject();\n        }\n\n        this._storage.removeItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY);\n        this._storage.removeItem(IS_COOKIE_ALLOWED_KEY);\n\n        return this._allowCookie();\n    }\n}\n","import { IFrameComponent, iframeResizer, isIframeEvent } from '../common/iframe';\nimport { parseUrl } from '../common/url';\n\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport { NotEmbeddableError, NotEmbeddableErrorType } from './errors';\n\nexport default class ResizableIframeCreator {\n    constructor(private _options?: { timeout: number }) {}\n\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\n        const container = document.getElementById(containerId);\n        const { timeout = 60000 } = this._options || {};\n\n        if (!container) {\n            throw new NotEmbeddableError(\n                'Unable to embed the iframe because the container element could not be found.',\n                NotEmbeddableErrorType.MissingContainer,\n            );\n        }\n\n        const iframe = document.createElement('iframe');\n\n        iframe.src = src;\n        iframe.style.border = 'none';\n        iframe.style.display = 'none';\n        iframe.style.width = '100%';\n        iframe.allowPaymentRequest = true;\n\n        container.appendChild(iframe);\n\n        return this._toResizableFrame(iframe, timeout).catch((error) => {\n            container.removeChild(iframe);\n\n            throw error;\n        });\n    }\n\n    private _toResizableFrame(\n        iframe: HTMLIFrameElement,\n        timeoutInterval: number,\n    ): Promise<IFrameComponent> {\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\n        return new Promise((resolve, reject) => {\n            const timeout = window.setTimeout(() => {\n                reject(\n                    new NotEmbeddableError(\n                        'Unable to embed the iframe because the content could not be loaded.',\n                    ),\n                );\n            }, timeoutInterval);\n\n            const handleMessage = (event: MessageEvent) => {\n                if (event.origin !== parseUrl(iframe.src).origin) {\n                    return;\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameError)) {\n                    teardown();\n                    reject(\n                        new NotEmbeddableError(\n                            event.data.payload.message,\n                            NotEmbeddableErrorType.MissingContent,\n                        ),\n                    );\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\n                    iframe.style.display = '';\n\n                    const contentId = event.data.payload && event.data.payload.contentId;\n                    const iframes = iframeResizer(\n                        {\n                            scrolling: false,\n                            sizeWidth: false,\n                            heightCalculationMethod: contentId ? 'taggedElement' : 'lowestElement',\n                        },\n                        iframe,\n                    );\n\n                    teardown();\n                    resolve(iframes[iframes.length - 1]);\n                }\n            };\n\n            const teardown = () => {\n                window.removeEventListener('message', handleMessage);\n                window.clearTimeout(timeout);\n            };\n\n            window.addEventListener('message', handleMessage);\n        });\n    }\n}\n","import { IFrameComponent, IFrameOptions } from 'iframe-resizer';\n\nexport {\n    HeightCalculationMethod,\n    IFrameComponent,\n    IFrameMessageData,\n    IFrameObject,\n    IFrameOptions,\n    IFramePage,\n    IFramePageOptions,\n    IFrameResizedData,\n    IFrameScrollData,\n    PageInfo,\n    WidthCalculationMethod,\n} from 'iframe-resizer';\n\n// The reason why we are wrapping the original `iframeResizer` function imported\n// from the package is because the package sets up event listeners (window\n// resize etc...) as soon as the package is imported. Therefore, to defer the\n// side effect from happening until the function is actually being used, we are\n// importing the package inside this function. To minimise the chance of\n// importing the original package inadvertently, we are also re-exporting all of\n// its public interfaces. The re-exports do not cause any side effect because\n// they are plain TypeScript interfaces; meaning they are only used for type\n// checks rather than for code output.\nexport function iframeResizer(\n    options: IFrameOptions,\n    target: string | HTMLElement,\n): IFrameComponent[] {\n    /* eslint-disable @typescript-eslint/no-var-requires */\n    const { iframeResizer: originalIframeResizer } = require('iframe-resizer');\n\n    return originalIframeResizer(options, target);\n}\n\n// We also need to wrap the original `iframeResizer.contentWindow` because\n// similarly the package sets up event listeners as soon as the package gets\n// imported. Another reason is that if it is imported at the top level using a\n// regular import statement, it will be stripped out by Webpack as it is\n// considered as \"unused\", unless we explicitly mark it as a package that\n// produces side effects.\nexport function setupContentWindowForIframeResizer(): void {\n    require('iframe-resizer/js/iframeResizer.contentWindow');\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport { IframeEventListener, IframeEventPoster } from '../common/iframe';\nimport { LoadingIndicator } from '../common/loading-indicator';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\n\nimport EmbeddedCheckout from './embedded-checkout';\nimport { EmbeddedCheckoutEventMap } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { EmbeddedContentEvent } from './iframe-content';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nconst STORAGE_PREFIX = 'BigCommerce.EmbeddedCheckout';\n\n/**\n * Embed the checkout form in an iframe.\n *\n * @remarks\n * Once the iframe is embedded, it will automatically resize according to the\n * size of the checkout form. It will also notify the parent window when certain\n * events have occurred. i.e.: when the form is loaded and ready to be used.\n *\n * ```js\n * embedCheckout({\n *     url: 'https://checkout/url',\n *     containerId: 'container-id',\n * });\n * ```\n *\n * @param options - Options for embedding the checkout form.\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\n */\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\n    const origin = parseUrl(options.url).origin;\n    const embeddedCheckout = new EmbeddedCheckout(\n        new ResizableIframeCreator(),\n        new IframeEventListener<EmbeddedCheckoutEventMap>(origin),\n        new IframeEventPoster<EmbeddedContentEvent>(origin),\n        new LoadingIndicator({ styles: options.styles && options.styles.loadingIndicator }),\n        createRequestSender(),\n        new BrowserStorage(STORAGE_PREFIX),\n        window.location,\n        options,\n    );\n\n    return embeddedCheckout.attach();\n}\n","import { EmbeddedCheckoutFrameLoadedEvent } from '../embedded-checkout-events';\n\nexport default function handleFrameLoadedEvent(message: EmbeddedCheckoutFrameLoadedEvent): void {\n    if (!message.payload || !message.payload.contentId) {\n        return;\n    }\n\n    const body = document.getElementById(message.payload.contentId);\n\n    if (!body || body.hasAttribute('data-iframe-height')) {\n        return;\n    }\n\n    body.setAttribute('data-iframe-height', '');\n}\n","export default interface CustomError extends Error {\n    message: string;\n    type: string;\n    subtype?: string;\n}\n\nexport function isCustomError(error: unknown): error is CustomError {\n    return typeof error === 'object' && error !== null && 'message' in error && 'type' in error;\n}\n","import { CustomError, isCustomError } from '../../common/error/errors';\nimport { IframeEventListener, IframeEventPoster } from '../../common/iframe';\nimport { bindDecorator as bind } from '../../common/utility';\nimport EmbeddedCheckoutError from '../embedded-checkout-error';\nimport {\n    EmbeddedCheckoutCompleteEvent,\n    EmbeddedCheckoutErrorEvent,\n    EmbeddedCheckoutEvent,\n    EmbeddedCheckoutEventMap,\n    EmbeddedCheckoutEventType,\n    EmbeddedCheckoutFrameErrorEvent,\n    EmbeddedCheckoutFrameLoadedEvent,\n    EmbeddedCheckoutLoadedEvent,\n    EmbeddedCheckoutSignedOutEvent,\n} from '../embedded-checkout-events';\nimport EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport { EmbeddedContentEventMap, EmbeddedContentEventType } from './embedded-content-events';\nimport EmbeddedContentOptions from './embedded-content-options';\n\n@bind\nexport default class IframeEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    /**\n     * @internal\n     */\n    constructor(\n        private _messageListener: IframeEventListener<EmbeddedContentEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _untargetedMessagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _messageHandlers: EventCallbacks<EmbeddedCheckoutEventMap> = {},\n    ) {\n        this._messageListener.listen();\n    }\n\n    postComplete(): void {\n        const message: EmbeddedCheckoutCompleteEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutComplete,\n        };\n\n        this._postMessage(message);\n    }\n\n    postError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutErrorEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutError,\n            payload: this._transformError(payload),\n        };\n\n        this._postMessage(message);\n    }\n\n    postFrameError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutFrameErrorEvent = {\n            type: EmbeddedCheckoutEventType.FrameError,\n            payload: this._transformError(payload),\n        };\n\n        // Ideally, all messages should be targeted at a specific origin.\n        // However, for `FrameError` message, we have to post it in an\n        // untargeted fashion. This is because the error could be caused by a\n        // missing cart. That makes it not possible to determine of site origin\n        // of the parent window. Nevertheless, we still want to notify the\n        // parent window about the error.\n        this._postMessage(message, { untargeted: true });\n    }\n\n    postFrameLoaded(payload?: EmbeddedContentOptions): void {\n        const message: EmbeddedCheckoutFrameLoadedEvent = {\n            type: EmbeddedCheckoutEventType.FrameLoaded,\n            payload,\n        };\n\n        this._postMessage(message);\n    }\n\n    postLoaded(): void {\n        const message: EmbeddedCheckoutLoadedEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutLoaded,\n        };\n\n        this._postMessage(message);\n    }\n\n    postSignedOut(): void {\n        const message: EmbeddedCheckoutSignedOutEvent = {\n            type: EmbeddedCheckoutEventType.SignedOut,\n        };\n\n        this._postMessage(message);\n    }\n\n    receiveStyles(handler: (styles: EmbeddedCheckoutStyles) => void): void {\n        this._messageListener.addListener(\n            EmbeddedContentEventType.StyleConfigured,\n            ({ payload }) => {\n                handler(payload);\n            },\n        );\n    }\n\n    private _postMessage(message: EmbeddedCheckoutEvent, options?: { untargeted?: boolean }): void {\n        this._notifyMessageHandlers(message);\n\n        if (options && options.untargeted) {\n            return this._untargetedMessagePoster.post(message);\n        }\n\n        this._messagePoster.post(message);\n    }\n\n    private _notifyMessageHandlers(message: EmbeddedCheckoutEvent): void {\n        Object.keys(this._messageHandlers).forEach((key) => {\n            if (message.type !== key) {\n                return;\n            }\n\n            const handler = this._messageHandlers[key];\n\n            if (handler) {\n                (handler as (event: EmbeddedCheckoutEvent) => void).call(null, message);\n            }\n        });\n    }\n\n    private _transformError(error: Error | CustomError): EmbeddedCheckoutError {\n        return {\n            message: error.message,\n            type: isCustomError(error) ? error.type : undefined,\n            subtype: isCustomError(error) ? error.subtype : undefined,\n        };\n    }\n}\n\nexport type EventCallbacks<TEventMap> = {\n    [key in keyof TEventMap]?: (event: TEventMap[key]) => void;\n};\n","import { bindDecorator as bind } from '../../common/utility';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\n\n@bind\nexport default class NoopEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    postComplete(): void {}\n\n    postError(): void {}\n\n    postFrameError(): void {}\n\n    postFrameLoaded(): void {}\n\n    postLoaded(): void {}\n\n    postSignedOut(): void {}\n\n    receiveStyles(): void {}\n}\n","import {\n    IframeEventListener,\n    IframeEventPoster,\n    setupContentWindowForIframeResizer,\n} from '../../common/iframe';\nimport { EmbeddedCheckoutEvent, EmbeddedCheckoutEventType } from '../embedded-checkout-events';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport EmbeddedCheckoutMessengerOptions from './embedded-checkout-messenger-options';\nimport { EmbeddedContentEventMap } from './embedded-content-events';\nimport handleFrameLoadedEvent from './handle-frame-loaded-event';\nimport IframeEmbeddedCheckoutMessenger from './iframe-embedded-checkout-messenger';\nimport NoopEmbeddedCheckoutMessenger from './noop-embedded-checkout-messenger';\n\n/**\n * Create an instance of `EmbeddedCheckoutMessenger`.\n *\n * @remarks\n * The object is responsible for posting messages to the parent window from the\n * iframe when certain events have occurred. For example, when the checkout\n * form is first loaded, you should notify the parent window about it.\n *\n * The iframe can only be embedded in domains that are allowed by the store.\n *\n * ```ts\n * const messenger = createEmbeddedCheckoutMessenger({\n *     parentOrigin: 'https://some/website',\n * });\n *\n * messenger.postFrameLoaded();\n * ```\n *\n * @alpha\n * Please note that this feature is currently in an early stage of development.\n * Therefore the API is unstable and not ready for public consumption.\n *\n * @param options - Options for creating `EmbeddedCheckoutMessenger`\n * @returns - An instance of `EmbeddedCheckoutMessenger`\n */\nexport default function createEmbeddedCheckoutMessenger(\n    options: EmbeddedCheckoutMessengerOptions,\n): EmbeddedCheckoutMessenger {\n    setupContentWindowForIframeResizer();\n\n    const parentWindow = options.parentWindow || window.parent;\n\n    // Return a No-op messenger if it is not called inside an iframe\n    if (window === parentWindow) {\n        return new NoopEmbeddedCheckoutMessenger();\n    }\n\n    return new IframeEmbeddedCheckoutMessenger(\n        new IframeEventListener<EmbeddedContentEventMap>(options.parentOrigin),\n        new IframeEventPoster<EmbeddedCheckoutEvent>(options.parentOrigin, parentWindow),\n        new IframeEventPoster<EmbeddedCheckoutEvent>('*', parentWindow),\n        { [EmbeddedCheckoutEventType.FrameLoaded]: handleFrameLoadedEvent },\n    );\n}\n"],"names":["module","exports","require","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","n","getter","__esModule","d","a","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","r","Symbol","toStringTag","value","message","object","name","type","setPrototypeOf","__proto__","Error","captureStackTrace","stack","parseUrl","url","test","anchor","document","createElement","href","port","indexOf","hostname","hash","origin","protocol","pathname","search","target","descriptor","bindMethodDecorator","decoratedTarget","getOwnPropertyNames","forEach","getOwnPropertyDescriptor","bindClassDecorator","_","method","boundMethod","bind","this","set","isIframeEvent","sourceOrigin","_sourceOrigins","replace","_isListening","_listeners","listen","window","addEventListener","_handleMessage","stopListen","removeEventListener","addListener","listener","listeners","push","removeListener","index","splice","trigger","event","data","targetOrigin","_targetWindow","_targetOrigin","post","options","targetWindow","result","fromEvent","pipe","filter","successType","errorType","map","take","toPromise","postMessage","setTarget","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","_styles","styles","_defineAnimation","_container","_buildContainer","_indicator","_buildIndicator","appendChild","show","parentId","getElementById","style","visibility","opacity","hide","handleTransitionEnd","container","display","bottom","left","height","width","position","right","top","transition","indicator","borderRadius","border","borderColor","margin","transform","transformStyle","animation","id","head","sheet","CSSStyleSheet","insertRule","_namespace","getItem","rawValue","withNamespace","JSON","parse","error","removeItem","getItemOnce","setItem","stringify","EmbeddedCheckoutEventType","DEFAULT_RESPONSE","body","headers","status","response","title","errors","NotEmbeddableErrorType","subtype","UnknownError","EmbeddedContentEventType","IS_COOKIE_ALLOWED_KEY","LAST_ALLOW_COOKIE_ATTEMPT_KEY","_iframeCreator","_messageListener","_messagePoster","_loadingIndicator","_requestSender","_storage","_location","_options","_isAttached","onComplete","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","onSignOut","SignedOut","_configureStyles","attach","Promise","resolve","containerId","_allowCookie","then","_attemptLogin","createFrame","iframe","_iframe","catch","_retryAllowCookie","FrameError","payload","detach","parentNode","removeChild","iFrameResizer","close","contentWindow","StyleConfigured","reject","Date","now","redirectUrl","encodeURIComponent","lastAttempt","Number","MissingContent","EmbeddedCheckout","src","timeout","MissingContainer","allowPaymentRequest","_toResizableFrame","timeoutInterval","setTimeout","handleMessage","teardown","iframes","scrolling","sizeWidth","heightCalculationMethod","contentId","originalIframeResizer","length","clearTimeout","embedCheckout","loadingIndicator","createRequestSender","location","handleFrameLoadedEvent","hasAttribute","setAttribute","isCustomError","_untargetedMessagePoster","_messageHandlers","postComplete","_postMessage","postError","_transformError","postFrameError","untargeted","postFrameLoaded","postLoaded","postSignedOut","receiveStyles","handler","_notifyMessageHandlers","keys","IframeEmbeddedCheckoutMessenger","NoopEmbeddedCheckoutMessenger","createEmbeddedCheckoutMessenger","parentWindow","parent","parentOrigin"],"sourceRoot":""}