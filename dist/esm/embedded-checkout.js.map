{"version":3,"file":"embedded-checkout.js","mappings":"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","sources":["webpack://@bigcommerce/checkout-sdk/external module \"iframe-resizer\"","webpack://@bigcommerce/checkout-sdk/external module \"iframe-resizer/js/iframeResizer.contentWindow\"","webpack://@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://@bigcommerce/checkout-sdk/./packages/ui/src/loading-indicator/loading-indicator.ts","webpack://@bigcommerce/checkout-sdk/./packages/utility/src/bind-decorator/bind-decorator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/standard-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/utility/set-prototype-of.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/invalid-argument-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/parse-url.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/url/append-www.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/is-iframe-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-listener.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-event-poster.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/storage/browser-storage.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/invalid-login-token-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/errors/not-embeddable-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/embedded-content-events.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embedded-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/resizable-iframe-creator.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/iframe/iframe-resizer.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/embed-checkout.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/handle-frame-loaded-event.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/common/error/errors/custom-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/iframe-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/noop-embedded-checkout-messenger.ts","webpack://@bigcommerce/checkout-sdk/./packages/core/src/embedded-checkout/iframe-content/create-embedded-checkout-messenger.ts"],"sourcesContent":["module.exports = __WEBPACK_EXTERNAL_MODULE_iframe_resizer_1512d797__;","module.exports = __WEBPACK_EXTERNAL_MODULE_iframe_resizer_js_iframeResizer_contentWindow_a6cfc03f__;","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId](module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import {\n    LoadingIndicatorContainerStyles,\n    LoadingIndicatorStyles,\n} from './loading-indicator-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nexport const DEFAULT_CONTAINER_STYLES = {\n    position: 'fixed',\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\ninterface LoadingIndicatorOptions {\n    styles?: LoadingIndicatorStyles;\n    containerStyles?: LoadingIndicatorContainerStyles;\n}\n\nexport default class LoadingIndicator {\n    private container: HTMLElement;\n    private indicator: HTMLElement;\n    private styles: LoadingIndicatorStyles;\n    private containerStyles: LoadingIndicatorContainerStyles;\n\n    constructor(options?: LoadingIndicatorOptions) {\n        this.styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\n        this.containerStyles = { ...(options && options.containerStyles) };\n\n        this.defineAnimation();\n\n        this.container = this.buildContainer();\n        this.indicator = this.buildIndicator();\n\n        this.container.appendChild(this.indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error(\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\n                );\n            }\n\n            parent.appendChild(this.container);\n        }\n\n        this.container.style.visibility = 'visible';\n        this.container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this.container.style.visibility = 'hidden';\n\n            this.container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this.container.addEventListener('transitionend', handleTransitionEnd);\n\n        this.container.style.opacity = '0';\n    }\n\n    private buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        this.setStyleAttribute(container, this.containerStyles);\n\n        return container;\n    }\n\n    private buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this.styles.size}px`;\n        indicator.style.height = `${this.styles.size}px`;\n        indicator.style.borderRadius = `${this.styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private setStyleAttribute(element: HTMLElement, attrs: { [key: string]: string }): void {\n        Object.keys(attrs).forEach((k) => {\n            element.style.setProperty(k, attrs[k]);\n        });\n    }\n\n    private defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        document.head?.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(\n                `\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,\n                0,\n            );\n        }\n    }\n}\n","/**\n * Decorates a class or a method by binding all its prototype methods or itself\n * to the calling instance respectively.\n */\nfunction bindDecorator<T extends Method>(\n    target: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T>;\nfunction bindDecorator<T extends Constructor<object>>(target: T): T;\n\nfunction bindDecorator(target: any, key?: any, descriptor?: any): any {\n    if (!key || !descriptor) {\n        return bindClassDecorator(target);\n    }\n\n    return bindMethodDecorator(target, key, descriptor);\n}\n\nexport default bindDecorator;\n\n/**\n * Decorates a class by binding all its prototype methods to the calling\n * instance.\n */\nexport function bindClassDecorator<T extends Constructor<object>>(target: T): T {\n    const decoratedTarget = class extends target {};\n\n    Object.getOwnPropertyNames(target.prototype).forEach((key) => {\n        const descriptor = Object.getOwnPropertyDescriptor(target.prototype, key);\n\n        if (!descriptor || key === 'constructor') {\n            return;\n        }\n\n        Object.defineProperty(\n            decoratedTarget.prototype,\n            key,\n            bindMethodDecorator(target.prototype, key, descriptor),\n        );\n    });\n\n    return decoratedTarget;\n}\n\n/**\n * Decorates a method by binding it to the calling instance.\n */\nexport function bindMethodDecorator<T extends Method>(\n    _: object,\n    key: string,\n    descriptor: TypedPropertyDescriptor<T>,\n): TypedPropertyDescriptor<T> {\n    if (typeof descriptor.value !== 'function') {\n        return descriptor;\n    }\n\n    let method: T = descriptor.value;\n\n    return {\n        get() {\n            // eslint-disable-next-line @typescript-eslint/consistent-type-assertions\n            const boundMethod = method.bind(this) as T;\n\n            Object.defineProperty(this, key, {\n                ...descriptor,\n                value: boundMethod,\n            });\n\n            return boundMethod;\n        },\n        set(value) {\n            method = value;\n        },\n    };\n}\n\nexport type Constructor<T> = new (...args: any[]) => T;\nexport type Method = (...args: any[]) => any;\n","import { setPrototypeOf } from '../../utility';\n\nimport CustomError from './custom-error';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import { InvalidArgumentError } from '../error/errors';\n\nimport Url from './url';\n\nexport default function parseUrl(url: string): Url {\n    if (!/^(https?:)?\\/\\//.test(url)) {\n        throw new InvalidArgumentError('The provided URL must be absolute.');\n    }\n\n    // new URL() is not supported in IE11, use anchor tag instead\n    const anchor = document.createElement('a');\n\n    anchor.href = url;\n\n    // IE11 returns 80 or 443 for the port number depending on the URL scheme,\n    // even if the port number is not specified in the URL.\n    const port =\n        anchor.port && url.indexOf(`${anchor.hostname}:${anchor.port}`) !== -1 ? anchor.port : '';\n\n    return {\n        hash: anchor.hash,\n        hostname: anchor.hostname,\n        href: anchor.href,\n        origin: `${anchor.protocol}//${anchor.hostname}${port ? `:${port}` : ''}`,\n        pathname: anchor.pathname,\n        port,\n        protocol: anchor.protocol,\n        search: anchor.search,\n    };\n}\n","import parseUrl from './parse-url';\nimport Url from './url';\n\nexport default function appendWww(url: Url): Url {\n    return parseUrl(\n        url.hostname.indexOf('www') === 0\n            ? url.href\n            : url.href.replace(url.hostname, `www.${url.hostname}`),\n    );\n}\n","import IframeEvent from './iframe-event';\n\nexport default function isIframeEvent<TEvent extends IframeEvent<TType>, TType extends string>(\n    object: any,\n    type: TType,\n): object is TEvent {\n    return object.type === type;\n}\n","import EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedContentOptions } from './iframe-content';\n\nexport enum EmbeddedCheckoutEventType {\n    CheckoutComplete = 'CHECKOUT_COMPLETE',\n    CheckoutError = 'CHECKOUT_ERROR',\n    CheckoutLoaded = 'CHECKOUT_LOADED',\n    FrameError = 'FRAME_ERROR',\n    FrameLoaded = 'FRAME_LOADED',\n    SignedOut = 'SIGNED_OUT',\n}\n\nexport interface EmbeddedCheckoutEventMap {\n    [EmbeddedCheckoutEventType.CheckoutComplete]: EmbeddedCheckoutCompleteEvent;\n    [EmbeddedCheckoutEventType.CheckoutError]: EmbeddedCheckoutErrorEvent;\n    [EmbeddedCheckoutEventType.CheckoutLoaded]: EmbeddedCheckoutLoadedEvent;\n    [EmbeddedCheckoutEventType.FrameError]: EmbeddedCheckoutFrameErrorEvent;\n    [EmbeddedCheckoutEventType.FrameLoaded]: EmbeddedCheckoutFrameLoadedEvent;\n    [EmbeddedCheckoutEventType.SignedOut]: EmbeddedCheckoutSignedOutEvent;\n}\n\nexport type EmbeddedCheckoutEvent =\n    | EmbeddedCheckoutCompleteEvent\n    | EmbeddedCheckoutErrorEvent\n    | EmbeddedCheckoutFrameErrorEvent\n    | EmbeddedCheckoutFrameLoadedEvent\n    | EmbeddedCheckoutLoadedEvent\n    | EmbeddedCheckoutSignedOutEvent;\n\nexport interface EmbeddedCheckoutCompleteEvent {\n    type: EmbeddedCheckoutEventType.CheckoutComplete;\n}\n\nexport interface EmbeddedCheckoutErrorEvent {\n    type: EmbeddedCheckoutEventType.CheckoutError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutLoadedEvent {\n    type: EmbeddedCheckoutEventType.CheckoutLoaded;\n}\n\nexport interface EmbeddedCheckoutFrameErrorEvent {\n    type: EmbeddedCheckoutEventType.FrameError;\n    payload: EmbeddedCheckoutError;\n}\n\nexport interface EmbeddedCheckoutFrameLoadedEvent {\n    type: EmbeddedCheckoutEventType.FrameLoaded;\n    payload?: EmbeddedContentOptions;\n}\n\nexport interface EmbeddedCheckoutSignedOutEvent {\n    type: EmbeddedCheckoutEventType.SignedOut;\n}\n","import { bindDecorator as bind } from '@bigcommerce/checkout-sdk/utility';\n\nimport { appendWww, parseUrl } from '../url';\n\nimport { IframeEventMap } from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport default class IframeEventListener<\n    TEventMap extends IframeEventMap<keyof TEventMap>,\n    TContext = undefined,\n> {\n    private _isListening: boolean;\n    private _listeners: EventListeners<TEventMap, TContext>;\n    private _sourceOrigins: string[];\n\n    constructor(sourceOrigin: string) {\n        this._sourceOrigins = [\n            parseUrl(sourceOrigin).origin,\n            appendWww(parseUrl(sourceOrigin)).origin,\n        ];\n        this._isListening = false;\n        this._listeners = {};\n    }\n\n    listen(): void {\n        if (this._isListening) {\n            return;\n        }\n\n        this._isListening = true;\n\n        window.addEventListener('message', this._handleMessage);\n    }\n\n    stopListen(): void {\n        if (!this._isListening) {\n            return;\n        }\n\n        this._isListening = false;\n\n        window.removeEventListener('message', this._handleMessage);\n    }\n\n    addListener<TType extends keyof TEventMap>(\n        type: TType,\n        listener: (event: TEventMap[TType], context?: TContext) => void,\n    ): void {\n        let listeners = this._listeners[type];\n\n        if (!listeners) {\n            this._listeners[type] = listeners = [];\n        }\n\n        if (listeners.indexOf(listener) === -1) {\n            listeners.push(listener);\n        }\n    }\n\n    removeListener<TType extends keyof TEventMap>(\n        type: TType,\n        listener: (event: TEventMap[TType], context?: TContext) => void,\n    ): void {\n        const listeners = this._listeners[type];\n\n        if (!listeners) {\n            return;\n        }\n\n        const index = listeners.indexOf(listener);\n\n        if (index >= 0) {\n            listeners.splice(index, 1);\n        }\n    }\n\n    trigger<TType extends keyof TEventMap>(event: TEventMap[TType], context?: TContext): void {\n        const listeners = this._listeners[event.type];\n\n        if (!listeners) {\n            return;\n        }\n\n        listeners.forEach((listener) => (context ? listener(event, context) : listener(event)));\n    }\n\n    @bind\n    private _handleMessage(messageEvent: MessageEvent): void {\n        if (\n            this._sourceOrigins.indexOf(messageEvent.origin) === -1 ||\n            !isIframeEvent(messageEvent.data as TEventMap[keyof TEventMap], messageEvent.data.type)\n        ) {\n            return;\n        }\n\n        const { context, ...event } = messageEvent.data;\n\n        this.trigger(event, context);\n    }\n}\n\nexport type EventListeners<TEventMap, TContext = undefined> = {\n    [key in keyof TEventMap]?: Array<(event: TEventMap[key], context?: TContext) => void>;\n};\n","import { fromEvent } from 'rxjs';\nimport { filter, map, take } from 'rxjs/operators';\n\nimport { parseUrl } from '../url';\n\nimport IframeEvent from './iframe-event';\nimport isIframeEvent from './is-iframe-event';\n\nexport interface IframeEventPostOptions<\n    TSuccessEvent extends IframeEvent,\n    TErrorEvent extends IframeEvent,\n> {\n    errorType?: TErrorEvent['type'];\n    successType?: TSuccessEvent['type'];\n}\n\nexport default class IframeEventPoster<TEvent, TContext = undefined> {\n    private _targetOrigin: string;\n\n    constructor(targetOrigin: string, private _targetWindow?: Window, private _context?: TContext) {\n        this._targetOrigin = targetOrigin === '*' ? '*' : parseUrl(targetOrigin).origin;\n    }\n\n    post(event: TEvent): void;\n    post<\n        TSuccessEvent extends IframeEvent = IframeEvent,\n        TErrorEvent extends IframeEvent = IframeEvent,\n    >(\n        event: TEvent,\n        options: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\n    ): Promise<TSuccessEvent>;\n    post<\n        TSuccessEvent extends IframeEvent = IframeEvent,\n        TErrorEvent extends IframeEvent = IframeEvent,\n    >(\n        event: TEvent,\n        options?: IframeEventPostOptions<TSuccessEvent, TErrorEvent>,\n    ): Promise<TSuccessEvent> | void {\n        const targetWindow = this._targetWindow;\n\n        if (window === targetWindow) {\n            return;\n        }\n\n        if (!targetWindow) {\n            throw new Error('Unable to post message because target window is not set.');\n        }\n\n        const result =\n            options &&\n            fromEvent<MessageEvent>(window, 'message')\n                .pipe(\n                    filter(\n                        (event) =>\n                            event.origin === this._targetOrigin &&\n                            isIframeEvent(event.data, event.data.type) &&\n                            [options.successType, options.errorType].indexOf(event.data.type) !==\n                                -1,\n                    ),\n                    map((event) => {\n                        if (options.errorType === event.data.type) {\n                            throw event.data;\n                        }\n\n                        return event.data;\n                    }),\n                    take(1),\n                )\n                .toPromise();\n\n        targetWindow.postMessage({ ...event, context: this._context }, this._targetOrigin);\n\n        return result;\n    }\n\n    setTarget(window: Window) {\n        this._targetWindow = window;\n    }\n\n    setContext(context: TContext) {\n        this._context = context;\n    }\n}\n","import { default as storage } from 'local-storage-fallback';\n\nexport default class BrowserStorage {\n    constructor(private _namespace: string) {}\n\n    getItem<TValue = any>(key: string): TValue | null {\n        const rawValue = storage.getItem(this.withNamespace(key));\n\n        if (rawValue === null) {\n            return null;\n        }\n\n        try {\n            return JSON.parse(rawValue);\n        } catch (error) {\n            // Clean up invalid values\n            this.removeItem(this.withNamespace(key));\n\n            return null;\n        }\n    }\n\n    getItemOnce<TValue = any>(key: string): TValue | null {\n        const value = this.getItem(key);\n\n        this.removeItem(key);\n\n        return value;\n    }\n\n    setItem<TValue = any>(key: string, value: TValue): void {\n        return storage.setItem(this.withNamespace(key), JSON.stringify(value));\n    }\n\n    removeItem(key: string): void {\n        return storage.removeItem(this.withNamespace(key));\n    }\n\n    private withNamespace(key: string): string {\n        return `${this._namespace}.${key}`;\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport { InternalErrorResponseBody } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { RequestError } from '../../common/error/errors';\n\n/**\n * Throw this error we are not able to sign in a shopper because the provided\n * login token is invalid.\n */\nexport default class InvalidLoginTokenError extends RequestError {\n    constructor(response: Response<InternalErrorResponseBody>) {\n        super(response, { message: response.body.title });\n\n        this.name = 'InvalidLoginTokenError';\n        this.type = 'invalid_login_token';\n    }\n}\n","import { StandardError } from '../../common/error/errors';\n\nexport enum NotEmbeddableErrorType {\n    MissingContainer = 'missing_container',\n    MissingContent = 'missing_content',\n    UnknownError = 'unknown_error',\n}\n\n/**\n * Throw this error if we are not able to embed the checkout form as an iframe.\n * This can be due to the fact that the provided container ID is invalid, or the\n * checkout form fails to load inside the iframe. It can also be due to an\n * unknown reason.\n */\nexport default class NotEmbeddableError extends StandardError {\n    constructor(\n        message?: string,\n        public subtype: NotEmbeddableErrorType = NotEmbeddableErrorType.UnknownError,\n    ) {\n        super(message || 'Unable to embed the checkout form.');\n\n        this.name = 'NotEmbeddableError';\n        this.type = 'not_embeddable';\n    }\n}\n","import EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nexport enum EmbeddedContentEventType {\n    StyleConfigured = 'STYLE_CONFIGURED',\n}\n\nexport interface EmbeddedContentEventMap {\n    [EmbeddedContentEventType.StyleConfigured]: EmbeddedContentStyleConfiguredEvent;\n}\n\nexport type EmbeddedContentEvent = EmbeddedContentStyleConfiguredEvent;\n\nexport interface EmbeddedContentStyleConfiguredEvent {\n    type: EmbeddedContentEventType.StyleConfigured;\n    payload: EmbeddedCheckoutStyles;\n}\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\nimport { bindDecorator as bind } from '@bigcommerce/checkout-sdk/utility';\n\nimport { IFrameComponent, IframeEventListener, IframeEventPoster } from '../common/iframe';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\n\nimport EmbeddedCheckoutError from './embedded-checkout-error';\nimport { EmbeddedCheckoutEventMap, EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { InvalidLoginTokenError, NotEmbeddableError, NotEmbeddableErrorType } from './errors';\nimport { EmbeddedContentEvent, EmbeddedContentEventType } from './iframe-content';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nexport const ALLOW_COOKIE_ATTEMPT_INTERVAL = 10 * 60 * 1000;\nexport const IS_COOKIE_ALLOWED_KEY = 'isCookieAllowed';\nexport const LAST_ALLOW_COOKIE_ATTEMPT_KEY = 'lastAllowCookieAttempt';\n\n@bind\nexport default class EmbeddedCheckout {\n    private _iframe?: IFrameComponent;\n    private _isAttached: boolean;\n\n    /**\n     * @internal\n     */\n    constructor(\n        private _iframeCreator: ResizableIframeCreator,\n        private _messageListener: IframeEventListener<EmbeddedCheckoutEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedContentEvent>,\n        private _loadingIndicator: LoadingIndicator,\n        private _requestSender: RequestSender,\n        private _storage: BrowserStorage,\n        private _location: Location,\n        private _options: EmbeddedCheckoutOptions,\n    ) {\n        this._isAttached = false;\n\n        if (this._options.onComplete) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutComplete,\n                this._options.onComplete,\n            );\n        }\n\n        if (this._options.onError) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutError,\n                this._options.onError,\n            );\n        }\n\n        if (this._options.onLoad) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.CheckoutLoaded,\n                this._options.onLoad,\n            );\n        }\n\n        if (this._options.onFrameLoad) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.FrameLoaded,\n                this._options.onFrameLoad,\n            );\n        }\n\n        if (this._options.onSignOut) {\n            this._messageListener.addListener(\n                EmbeddedCheckoutEventType.SignedOut,\n                this._options.onSignOut,\n            );\n        }\n\n        this._messageListener.addListener(EmbeddedCheckoutEventType.FrameLoaded, () =>\n            this._configureStyles(),\n        );\n    }\n\n    attach(): Promise<this> {\n        if (this._isAttached) {\n            return Promise.resolve(this);\n        }\n\n        this._isAttached = true;\n        this._messageListener.listen();\n        this._loadingIndicator.show(this._options.containerId);\n\n        return this._allowCookie()\n            .then(() => this._attemptLogin())\n            .then((url) => this._iframeCreator.createFrame(url, this._options.containerId))\n            .then((iframe) => {\n                this._iframe = iframe;\n\n                this._configureStyles();\n                this._loadingIndicator.hide();\n            })\n            .catch((error) => {\n                this._isAttached = false;\n\n                return this._retryAllowCookie(error).catch(() => {\n                    this._messageListener.trigger({\n                        type: EmbeddedCheckoutEventType.FrameError,\n                        payload: error,\n                    });\n\n                    this._loadingIndicator.hide();\n\n                    throw error;\n                });\n            })\n            .then(() => this);\n    }\n\n    detach(): void {\n        if (!this._isAttached) {\n            return;\n        }\n\n        this._isAttached = false;\n        this._messageListener.stopListen();\n\n        if (this._iframe && this._iframe.parentNode) {\n            this._iframe.parentNode.removeChild(this._iframe);\n            this._iframe.iFrameResizer.close();\n        }\n    }\n\n    private _configureStyles(): void {\n        if (!this._iframe || !this._iframe.contentWindow || !this._options.styles) {\n            return;\n        }\n\n        this._messagePoster.setTarget(this._iframe.contentWindow);\n\n        this._messagePoster.post({\n            type: EmbeddedContentEventType.StyleConfigured,\n            payload: this._options.styles,\n        });\n    }\n\n    private _attemptLogin(): Promise<string> {\n        if (!/^\\/login\\/token/.test(parseUrl(this._options.url).pathname)) {\n            return Promise.resolve(this._options.url);\n        }\n\n        return this._requestSender\n            .post<{ redirectUrl: string }>(this._options.url)\n            .then(({ body: { redirectUrl } }) => redirectUrl)\n            .catch((response) => Promise.reject(new InvalidLoginTokenError(response)));\n    }\n\n    /**\n     * This workaround is required for certain browsers (namely Safari) that\n     * prevent session cookies to be set for a third party website unless the\n     * user has recently visited such website. Therefore, before we attempt to\n     * login or set an active cart in the session, we need to first redirect the\n     * user to the domain of Embedded Checkout.\n     */\n    private _allowCookie(): Promise<void> {\n        if (this._storage.getItem(IS_COOKIE_ALLOWED_KEY)) {\n            return Promise.resolve();\n        }\n\n        this._storage.setItem(IS_COOKIE_ALLOWED_KEY, true);\n\n        // It could be possible that the flag is set to true but the browser has\n        // already removed the permission to store third-party cookies. In that\n        // case, we should try to redirect the user again. But we only want to\n        // do it once within a fixed interval. This is to avoid getting into a\n        // redirect loop if the shopper actually doesn't have a valid card\n        // session.\n        this._storage.setItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY, Date.now());\n\n        const { origin } = parseUrl(this._options.url);\n        const redirectUrl = `${origin}/embedded-checkout/allow-cookie?returnUrl=${encodeURIComponent(\n            this._location.href,\n        )}`;\n\n        document.body.style.visibility = 'hidden';\n        this._location.replace(redirectUrl);\n\n        return new Promise<never>(() => {});\n    }\n\n    private _retryAllowCookie(error: EmbeddedCheckoutError): Promise<void> {\n        const lastAttempt = Number(this._storage.getItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY));\n        const canRetry =\n            (!lastAttempt || Date.now() - lastAttempt > ALLOW_COOKIE_ATTEMPT_INTERVAL) &&\n            error instanceof NotEmbeddableError &&\n            error.subtype === NotEmbeddableErrorType.MissingContent;\n\n        if (!canRetry) {\n            return Promise.reject();\n        }\n\n        this._storage.removeItem(LAST_ALLOW_COOKIE_ATTEMPT_KEY);\n        this._storage.removeItem(IS_COOKIE_ALLOWED_KEY);\n\n        return this._allowCookie();\n    }\n}\n","import { IFrameComponent, iframeResizer, isIframeEvent } from '../common/iframe';\nimport { appendWww, parseUrl } from '../common/url';\n\nimport { EmbeddedCheckoutEventType } from './embedded-checkout-events';\nimport { NotEmbeddableError, NotEmbeddableErrorType } from './errors';\n\nexport interface ExtendedHTMLIFrameElement extends HTMLIFrameElement {\n    allowPaymentRequest?: boolean;\n}\n\nexport default class ResizableIframeCreator {\n    constructor(private _options?: { timeout: number }) {}\n\n    createFrame(src: string, containerId: string): Promise<IFrameComponent> {\n        const container = document.getElementById(containerId);\n        const { timeout = 60000 } = this._options || {};\n\n        if (!container) {\n            throw new NotEmbeddableError(\n                'Unable to embed the iframe because the container element could not be found.',\n                NotEmbeddableErrorType.MissingContainer,\n            );\n        }\n\n        const iframe: ExtendedHTMLIFrameElement = document.createElement('iframe');\n\n        iframe.src = src;\n        iframe.style.border = 'none';\n        iframe.style.display = 'none';\n        iframe.style.width = '100%';\n        iframe.allowPaymentRequest = true;\n        iframe.allow = 'payment';\n\n        container.appendChild(iframe);\n\n        return this._toResizableFrame(iframe, timeout).catch((error) => {\n            container.removeChild(iframe);\n\n            throw error;\n        });\n    }\n\n    private _toResizableFrame(\n        iframe: HTMLIFrameElement,\n        timeoutInterval: number,\n    ): Promise<IFrameComponent> {\n        // Can't simply listen to `load` event because it always gets triggered even if there's an error.\n        // Instead, listen to the `load` inside the iframe and let the parent frame know when it happens.\n        return new Promise((resolve, reject) => {\n            const timeout = window.setTimeout(() => {\n                reject(\n                    new NotEmbeddableError(\n                        'Unable to embed the iframe because the content could not be loaded.',\n                    ),\n                );\n            }, timeoutInterval);\n\n            const handleMessage = (event: MessageEvent) => {\n                if (\n                    event.origin !== parseUrl(iframe.src).origin &&\n                    event.origin !== appendWww(parseUrl(iframe.src)).origin\n                ) {\n                    return;\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameError)) {\n                    teardown();\n                    reject(\n                        new NotEmbeddableError(\n                            event.data.payload.message,\n                            NotEmbeddableErrorType.MissingContent,\n                        ),\n                    );\n                }\n\n                if (isIframeEvent(event.data, EmbeddedCheckoutEventType.FrameLoaded)) {\n                    iframe.style.display = '';\n\n                    const contentId = event.data.payload && event.data.payload.contentId;\n                    const iframes = iframeResizer(\n                        {\n                            scrolling: false,\n                            sizeWidth: false,\n                            heightCalculationMethod: contentId ? 'taggedElement' : 'lowestElement',\n                        },\n                        iframe,\n                    );\n\n                    teardown();\n                    resolve(iframes[iframes.length - 1]);\n                }\n            };\n\n            const teardown = () => {\n                window.removeEventListener('message', handleMessage);\n                window.clearTimeout(timeout);\n            };\n\n            window.addEventListener('message', handleMessage);\n        });\n    }\n}\n","import { IFrameComponent, IFrameOptions } from 'iframe-resizer';\n\nexport {\n    HeightCalculationMethod,\n    IFrameComponent,\n    IFrameMessageData,\n    IFrameObject,\n    IFrameOptions,\n    IFramePage,\n    IFramePageOptions,\n    IFrameResizedData,\n    IFrameScrollData,\n    PageInfo,\n    WidthCalculationMethod,\n} from 'iframe-resizer';\n\n// The reason why we are wrapping the original `iframeResizer` function imported\n// from the package is because the package sets up event listeners (window\n// resize etc...) as soon as the package is imported. Therefore, to defer the\n// side effect from happening until the function is actually being used, we are\n// importing the package inside this function. To minimise the chance of\n// importing the original package inadvertently, we are also re-exporting all of\n// its public interfaces. The re-exports do not cause any side effect because\n// they are plain TypeScript interfaces; meaning they are only used for type\n// checks rather than for code output.\nexport function iframeResizer(\n    options: IFrameOptions,\n    target: string | HTMLElement,\n): IFrameComponent[] {\n    /* eslint-disable @typescript-eslint/no-var-requires */\n    const { iframeResizer: originalIframeResizer } = require('iframe-resizer');\n\n    return originalIframeResizer(options, target);\n}\n\n// We also need to wrap the original `iframeResizer.contentWindow` because\n// similarly the package sets up event listeners as soon as the package gets\n// imported. Another reason is that if it is imported at the top level using a\n// regular import statement, it will be stripped out by Webpack as it is\n// considered as \"unused\", unless we explicitly mark it as a package that\n// produces side effects.\nexport function setupContentWindowForIframeResizer(): void {\n    require('iframe-resizer/js/iframeResizer.contentWindow');\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport { IframeEventListener, IframeEventPoster } from '../common/iframe';\nimport { BrowserStorage } from '../common/storage';\nimport { parseUrl } from '../common/url';\n\nimport EmbeddedCheckout from './embedded-checkout';\nimport { EmbeddedCheckoutEventMap } from './embedded-checkout-events';\nimport EmbeddedCheckoutOptions from './embedded-checkout-options';\nimport { EmbeddedContentEvent } from './iframe-content';\nimport ResizableIframeCreator from './resizable-iframe-creator';\n\nconst STORAGE_PREFIX = 'BigCommerce.EmbeddedCheckout';\n\n/**\n * Embed the checkout form in an iframe.\n *\n * @remarks\n * Once the iframe is embedded, it will automatically resize according to the\n * size of the checkout form. It will also notify the parent window when certain\n * events have occurred. i.e.: when the form is loaded and ready to be used.\n *\n * ```js\n * embedCheckout({\n *     url: 'https://checkout/url',\n *     containerId: 'container-id',\n * });\n * ```\n *\n * @param options - Options for embedding the checkout form.\n * @returns A promise that resolves to an instance of `EmbeddedCheckout`.\n */\nexport default function embedCheckout(options: EmbeddedCheckoutOptions): Promise<EmbeddedCheckout> {\n    const origin = parseUrl(options.url).origin;\n    const embeddedCheckout = new EmbeddedCheckout(\n        new ResizableIframeCreator(),\n        new IframeEventListener<EmbeddedCheckoutEventMap>(origin),\n        new IframeEventPoster<EmbeddedContentEvent>(origin),\n        new LoadingIndicator({ styles: options.styles && options.styles.loadingIndicator }),\n        createRequestSender(),\n        new BrowserStorage(STORAGE_PREFIX),\n        window.location,\n        options,\n    );\n\n    return embeddedCheckout.attach();\n}\n","import { EmbeddedCheckoutFrameLoadedEvent } from '../embedded-checkout-events';\n\nexport default function handleFrameLoadedEvent(message: EmbeddedCheckoutFrameLoadedEvent): void {\n    if (!message.payload || !message.payload.contentId) {\n        return;\n    }\n\n    const body = document.getElementById(message.payload.contentId);\n\n    if (!body || body.hasAttribute('data-iframe-height')) {\n        return;\n    }\n\n    body.setAttribute('data-iframe-height', '');\n}\n","export default interface CustomError extends Error {\n    message: string;\n    type: string;\n    subtype?: string;\n}\n\nexport function isCustomError(error: unknown): error is CustomError {\n    return typeof error === 'object' && error !== null && 'message' in error && 'type' in error;\n}\n","import { bindDecorator as bind } from '@bigcommerce/checkout-sdk/utility';\n\nimport { CustomError, isCustomError } from '../../common/error/errors';\nimport { IframeEventListener, IframeEventPoster } from '../../common/iframe';\nimport EmbeddedCheckoutError from '../embedded-checkout-error';\nimport {\n    EmbeddedCheckoutCompleteEvent,\n    EmbeddedCheckoutErrorEvent,\n    EmbeddedCheckoutEvent,\n    EmbeddedCheckoutEventMap,\n    EmbeddedCheckoutEventType,\n    EmbeddedCheckoutFrameErrorEvent,\n    EmbeddedCheckoutFrameLoadedEvent,\n    EmbeddedCheckoutLoadedEvent,\n    EmbeddedCheckoutSignedOutEvent,\n} from '../embedded-checkout-events';\nimport EmbeddedCheckoutStyles from '../embedded-checkout-styles';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport { EmbeddedContentEventMap, EmbeddedContentEventType } from './embedded-content-events';\nimport EmbeddedContentOptions from './embedded-content-options';\n\n@bind\nexport default class IframeEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    /**\n     * @internal\n     */\n    constructor(\n        private _messageListener: IframeEventListener<EmbeddedContentEventMap>,\n        private _messagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _untargetedMessagePoster: IframeEventPoster<EmbeddedCheckoutEvent>,\n        private _messageHandlers: EventCallbacks<EmbeddedCheckoutEventMap> = {},\n    ) {\n        this._messageListener.listen();\n    }\n\n    postComplete(): void {\n        const message: EmbeddedCheckoutCompleteEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutComplete,\n        };\n\n        this._postMessage(message);\n    }\n\n    postError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutErrorEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutError,\n            payload: this._transformError(payload),\n        };\n\n        this._postMessage(message);\n    }\n\n    postFrameError(payload: Error | CustomError): void {\n        const message: EmbeddedCheckoutFrameErrorEvent = {\n            type: EmbeddedCheckoutEventType.FrameError,\n            payload: this._transformError(payload),\n        };\n\n        // Ideally, all messages should be targeted at a specific origin.\n        // However, for `FrameError` message, we have to post it in an\n        // untargeted fashion. This is because the error could be caused by a\n        // missing cart. That makes it not possible to determine of site origin\n        // of the parent window. Nevertheless, we still want to notify the\n        // parent window about the error.\n        this._postMessage(message, { untargeted: true });\n    }\n\n    postFrameLoaded(payload?: EmbeddedContentOptions): void {\n        const message: EmbeddedCheckoutFrameLoadedEvent = {\n            type: EmbeddedCheckoutEventType.FrameLoaded,\n            payload,\n        };\n\n        this._postMessage(message);\n    }\n\n    postLoaded(): void {\n        const message: EmbeddedCheckoutLoadedEvent = {\n            type: EmbeddedCheckoutEventType.CheckoutLoaded,\n        };\n\n        this._postMessage(message);\n    }\n\n    postSignedOut(): void {\n        const message: EmbeddedCheckoutSignedOutEvent = {\n            type: EmbeddedCheckoutEventType.SignedOut,\n        };\n\n        this._postMessage(message);\n    }\n\n    receiveStyles(handler: (styles: EmbeddedCheckoutStyles) => void): void {\n        this._messageListener.addListener(\n            EmbeddedContentEventType.StyleConfigured,\n            ({ payload }) => {\n                handler(payload);\n            },\n        );\n    }\n\n    private _postMessage(message: EmbeddedCheckoutEvent, options?: { untargeted?: boolean }): void {\n        this._notifyMessageHandlers(message);\n\n        if (options && options.untargeted) {\n            return this._untargetedMessagePoster.post(message);\n        }\n\n        this._messagePoster.post(message);\n    }\n\n    private _notifyMessageHandlers(message: EmbeddedCheckoutEvent): void {\n        Object.keys(this._messageHandlers).forEach((key) => {\n            if (message.type !== key) {\n                return;\n            }\n\n            const handler = this._messageHandlers[key];\n\n            if (handler) {\n                (handler as (event: EmbeddedCheckoutEvent) => void).call(null, message);\n            }\n        });\n    }\n\n    private _transformError(error: Error | CustomError): EmbeddedCheckoutError {\n        return {\n            message: error.message,\n            type: isCustomError(error) ? error.type : undefined,\n            subtype: isCustomError(error) ? error.subtype : undefined,\n        };\n    }\n}\n\nexport type EventCallbacks<TEventMap> = {\n    [key in keyof TEventMap]?: (event: TEventMap[key]) => void;\n};\n","import { bindDecorator as bind } from '@bigcommerce/checkout-sdk/utility';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\n\n@bind\nexport default class NoopEmbeddedCheckoutMessenger implements EmbeddedCheckoutMessenger {\n    postComplete(): void {}\n\n    postError(): void {}\n\n    postFrameError(): void {}\n\n    postFrameLoaded(): void {}\n\n    postLoaded(): void {}\n\n    postSignedOut(): void {}\n\n    receiveStyles(): void {}\n}\n","import {\n    IframeEventListener,\n    IframeEventPoster,\n    setupContentWindowForIframeResizer,\n} from '../../common/iframe';\nimport { EmbeddedCheckoutEvent, EmbeddedCheckoutEventType } from '../embedded-checkout-events';\n\nimport EmbeddedCheckoutMessenger from './embedded-checkout-messenger';\nimport EmbeddedCheckoutMessengerOptions from './embedded-checkout-messenger-options';\nimport { EmbeddedContentEventMap } from './embedded-content-events';\nimport handleFrameLoadedEvent from './handle-frame-loaded-event';\nimport IframeEmbeddedCheckoutMessenger from './iframe-embedded-checkout-messenger';\nimport NoopEmbeddedCheckoutMessenger from './noop-embedded-checkout-messenger';\n\n/**\n * Create an instance of `EmbeddedCheckoutMessenger`.\n *\n * @remarks\n * The object is responsible for posting messages to the parent window from the\n * iframe when certain events have occurred. For example, when the checkout\n * form is first loaded, you should notify the parent window about it.\n *\n * The iframe can only be embedded in domains that are allowed by the store.\n *\n * ```ts\n * const messenger = createEmbeddedCheckoutMessenger({\n *     parentOrigin: 'https://some/website',\n * });\n *\n * messenger.postFrameLoaded();\n * ```\n *\n * @alpha\n * Please note that this feature is currently in an early stage of development.\n * Therefore the API is unstable and not ready for public consumption.\n *\n * @param options - Options for creating `EmbeddedCheckoutMessenger`\n * @returns - An instance of `EmbeddedCheckoutMessenger`\n */\nexport default function createEmbeddedCheckoutMessenger(\n    options: EmbeddedCheckoutMessengerOptions,\n): EmbeddedCheckoutMessenger {\n    setupContentWindowForIframeResizer();\n\n    const parentWindow = options.parentWindow || window.parent;\n\n    // Return a No-op messenger if it is not called inside an iframe\n    if (window === parentWindow) {\n        return new NoopEmbeddedCheckoutMessenger();\n    }\n\n    return new IframeEmbeddedCheckoutMessenger(\n        new IframeEventListener<EmbeddedContentEventMap>(options.parentOrigin),\n        new IframeEventPoster<EmbeddedCheckoutEvent>(options.parentOrigin, parentWindow),\n        new IframeEventPoster<EmbeddedCheckoutEvent>('*', parentWindow),\n        { [EmbeddedCheckoutEventType.FrameLoaded]: handleFrameLoadedEvent },\n    );\n}\n"],"names":["module","exports","__WEBPACK_EXTERNAL_MODULE_iframe_resizer_1512d797__","__WEBPACK_EXTERNAL_MODULE_iframe_resizer_js_iframeResizer_contentWindow_a6cfc03f__","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","__webpack_modules__","d","definition","key","o","Object","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","DEFAULT_STYLES","size","color","backgroundColor","ROTATION_ANIMATION","LoadingIndicator","constructor","options","this","styles","containerStyles","defineAnimation","container","buildContainer","indicator","buildIndicator","appendChild","show","parentId","parent","document","getElementById","Error","style","visibility","opacity","hide","handleTransitionEnd","removeEventListener","addEventListener","createElement","display","bottom","left","height","width","position","right","top","transition","setStyleAttribute","borderRadius","border","borderColor","margin","transform","transformStyle","animation","element","attrs","keys","forEach","k","setProperty","id","head","sheet","CSSStyleSheet","insertRule","target","descriptor","bindMethodDecorator","decoratedTarget","getOwnPropertyNames","getOwnPropertyDescriptor","bindClassDecorator","_","value","method","boundMethod","bind","set","StandardError","message","super","name","type","setPrototypeOf","__proto__","captureStackTrace","stack","InvalidArgumentError","parseUrl","url","test","anchor","href","port","indexOf","hostname","hash","origin","protocol","pathname","search","appendWww","replace","isIframeEvent","object","EmbeddedCheckoutEventType","IframeEventListener","sourceOrigin","_sourceOrigins","_isListening","_listeners","listen","window","_handleMessage","stopListen","addListener","listener","listeners","push","removeListener","index","splice","trigger","event","context","messageEvent","data","IframeEventPoster","targetOrigin","_targetWindow","_context","_targetOrigin","post","targetWindow","result","fromEvent","pipe","filter","successType","errorType","map","take","toPromise","postMessage","setTarget","setContext","BrowserStorage","_namespace","getItem","rawValue","withNamespace","JSON","parse","error","removeItem","getItemOnce","setItem","stringify","DEFAULT_RESPONSE","body","headers","status","RequestError","response","errors","InvalidLoginTokenError","title","NotEmbeddableErrorType","EmbeddedContentEventType","NotEmbeddableError","subtype","UnknownError","IS_COOKIE_ALLOWED_KEY","LAST_ALLOW_COOKIE_ATTEMPT_KEY","EmbeddedCheckout","_iframeCreator","_messageListener","_messagePoster","_loadingIndicator","_requestSender","_storage","_location","_options","_isAttached","onComplete","CheckoutComplete","onError","CheckoutError","onLoad","CheckoutLoaded","onFrameLoad","FrameLoaded","onSignOut","SignedOut","_configureStyles","attach","Promise","resolve","containerId","_allowCookie","then","_attemptLogin","createFrame","iframe","_iframe","catch","_retryAllowCookie","FrameError","payload","detach","parentNode","removeChild","iFrameResizer","close","contentWindow","StyleConfigured","redirectUrl","reject","Date","now","encodeURIComponent","lastAttempt","Number","MissingContent","ResizableIframeCreator","src","timeout","MissingContainer","allowPaymentRequest","allow","_toResizableFrame","timeoutInterval","setTimeout","handleMessage","teardown","iframes","iframeResizer","originalIframeResizer","scrolling","sizeWidth","heightCalculationMethod","contentId","length","clearTimeout","embedCheckout","loadingIndicator","createRequestSender","location","handleFrameLoadedEvent","hasAttribute","setAttribute","isCustomError","IframeEmbeddedCheckoutMessenger","_untargetedMessagePoster","_messageHandlers","postComplete","_postMessage","postError","_transformError","postFrameError","untargeted","postFrameLoaded","postLoaded","postSignedOut","receiveStyles","handler","_notifyMessageHandlers","NoopEmbeddedCheckoutMessenger","createEmbeddedCheckoutMessenger","parentWindow","parentOrigin"],"sourceRoot":""}