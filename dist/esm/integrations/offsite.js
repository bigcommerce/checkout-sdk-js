var e,t={};function r(e){return!("object"!=typeof e||null===e||void 0!==e.shouldSaveInstrument&&"boolean"!=typeof e.shouldSaveInstrument||void 0!==e.shouldSetAsDefaultInstrument&&"boolean"!=typeof e.shouldSetAsDefaultInstrument)}t.d=(e,r)=>{for(var n in r)t.o(r,n)&&!t.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:r[n]})},t.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);class n extends Error{constructor(e){var t;super(e||"An unexpected error has occurred."),this.name="StandardError",this.type="standard",t=new.target.prototype,Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,"function"==typeof Error.captureStackTrace?Error.captureStackTrace(this,new.target):this.stack=new Error(this.message).stack}}class o extends n{constructor(e){super(e||"Invalid arguments have been provided."),this.name="InvalidArgumentError",this.type="invalid_argument"}}class a extends o{constructor(e){let t="Unable to submit payment for the order because the payload is invalid.";e&&(t=`${t} Make sure the following fields are provided correctly: ${e.join(", ")}.`),super(t),this.name="PaymentArgumentInvalidError"}}!function(e){e.ACKNOWLEDGE="ACKNOWLEDGE",e.FINALIZE="FINALIZE",e.INITIALIZE="INITIALIZE"}(e||(e={}));const i=e;class s extends n{constructor(){super("The current order does not need to be finalized at this stage."),this.name="OrderFinalizationNotRequiredError",this.type="order_finalization_not_required"}}var u=function(e,t,r,n){return new(r||(r=Promise))(function(o,a){function i(e){try{u(n.next(e))}catch(e){a(e)}}function s(e){try{u(n.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof r?t:new r(function(e){e(t)})).then(i,s)}u((n=n.apply(e,t||[])).next())})};class d{constructor(e){this._paymentIntegrationService=e}execute(e,t){return u(this,void 0,void 0,function*(){const{payment:n}=e,o=function(e,t){var r={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.indexOf(n)<0&&(r[n]=e[n]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var o=0;for(n=Object.getOwnPropertySymbols(e);o<n.length;o++)t.indexOf(n[o])<0&&Object.prototype.propertyIsEnumerable.call(e,n[o])&&(r[n[o]]=e[n[o]])}return r}(e,["payment"]),i=this._shouldSubmitFullPayload(n)?e:o,s=n&&n.paymentData,u=s&&Boolean(s.instrumentId)&&s.instrumentId||void 0,d=s&&r(s)&&s.shouldSaveInstrument||void 0,c=s&&r(s)&&s.shouldSetAsDefaultInstrument||void 0;if(!n)throw new a(["payment"]);const{methodId:l,gatewayId:y}=n;yield this._paymentIntegrationService.submitOrder(i,t),yield this._paymentIntegrationService.initializeOffsitePayment({methodId:l,gatewayId:y,instrumentId:u,shouldSaveInstrument:d,shouldSetAsDefaultInstrument:c})})}finalize(e){return u(this,void 0,void 0,function*(){const t=this._paymentIntegrationService.getState(),r=t.getOrder(),n=t.getPaymentStatus();if(!r||n!==i.ACKNOWLEDGE&&n!==i.FINALIZE)return Promise.reject(new s);yield this._paymentIntegrationService.finalizeOrder(e)})}initialize(){return Promise.resolve()}deinitialize(){return Promise.resolve()}_shouldSubmitFullPayload(e){return!!e&&("adyen"===e.gatewayId||"barclaycard"===e.gatewayId)}}const c=(l=e=>new d(e),y=[{type:"PAYMENT_TYPE_HOSTED"}],Object.assign(l,{resolveIds:y}));var l,y;export{c as createOffsitePaymentStrategy};
//# sourceMappingURL=offsite.js.map