{"version":3,"file":"integrations/bigcommerce-payments.js","mappings":"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","sources":["webpack://@bigcommerce/checkout-sdk/webpack/bootstrap","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/missing-data-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/to-resolvable-module.ts","webpack://@bigcommerce/checkout-sdk/webpack/runtime/define property getters","webpack://@bigcommerce/checkout-sdk/webpack/runtime/hasOwnProperty shorthand","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/standard-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/set-prototype-of.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-client-unavailable-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/buy-now-cart-creation-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/cart/cart-source.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-types.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-integration-service.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/internal-api-headers.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/content-type.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/common/http-request/sdk-version-headers.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-request-sender.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-script-loader.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/create-bigcommerce-payments-integration-service.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/invalid-argument-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/bigcommerce-payments-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/checkout-buttons/default-checkout-button-height.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/create-bigcommerce-payments-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/instrument.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/bigcommerce-payments-types.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/paypal-sdk-helper.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/create-bigcommerce-payments-sdk.ts","webpack://@bigcommerce/checkout-sdk/./packages/storage/src/cookie-storage.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/bigcommerce-payments-fastlane-utils.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/create-bigcommerce-payments-fastlane-utils.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/get-fastlane-styles.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-fastlane/bigcommerce-payments-fastlane-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-fastlane/create-bigcommerce-payments-fastlane-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/bigcommerce-payments-paylater-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/create-bigcommerce-payments-paylater-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/bigcommerce-payments-venmo-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/create-bigcommerce-payments-venmo-customer-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/ui/src/loading-indicator/loading-indicator.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-constants.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/get-paypal-messages-styles-from-bnpl-config.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-argument-invalid-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-invalid-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/order-finalization-not-required-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-hosted-intrument-like.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/payment/is-vaulted-instrument.ts","webpack://@bigcommerce/checkout-sdk/./packages/utility/src/is-base-instrument/is-base-instrument.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/bigcommerce-payments-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/is-bigcommerce-payments-provider-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/create-bigcommerce-payments-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/is-paypal-fastlane-customer.ts","webpack://@bigcommerce/checkout-sdk/./packages/utility/src/is-experiment-enabled/is-experiment-enabled.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-fastlane/bigcommerce-payments-fastlane-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/is-bigcommerce-fastlane-request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-fastlane/create-bigcommerce-payments-fastlane-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-implemented-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/bigcommerce-payments-paylater-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/create-bigcommerce-payments-paylater-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/timeout-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-ratepay/bigcommerce-payments-ratepay-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-ratepay/create-bigcommerce-payments-ratepay-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/hosted-field-type.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/is-credit-card-form-fields.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/hosted-form/is-credit-card-vaulted-form-fields.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-method-failed-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/not-initialized-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/payment-invalid-form-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-credit-cards/bigcommerce-payments-credit-cards-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/is-bigcommerce-payments-fastlane-customer.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-credit-cards/create-bigcommerce-payments-credit-cards-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-alternative-methods/bigcommerce-payments-alternative-methods-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-alternative-methods/create-bigcommerce-payments-alternative-methods-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-redirect-alternative-methods/bigcomemrce-payments-redirect-alternative-methods-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-utils/src/utils/is-redirect-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/payment-integration-api/src/errors/is-request-error.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-redirect-alternative-methods/create-bigcommerce-payments-redirect-alternative-methods-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/bigcommerce-payments-venmo-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/create-bigcommerce-payments-venmo-payment-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/bigcommerce-payments-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments/create-bigcommerce-payments-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/bigcommerce-payments-paylater-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-paylater/create-bigcommerce-payments-paylater-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-alternative-methods/bigcommerce-payments-alternative-methods-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-alternative-methods/create-bigcommerce-payments-alternative-methods-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/bigcommerce-payments-venmo-button-strategy.ts","webpack://@bigcommerce/checkout-sdk/./packages/bigcommerce-payments-integration/src/bigcommerce-payments-venmo/create-bigcommerce-payments-venmo-button-strategy.ts"],"sourcesContent":["// The require scope\nvar __webpack_require__ = {};\n\n","import StandardError from './standard-error';\n\nexport enum MissingDataErrorType {\n    MissingBillingAddress,\n    MissingCart,\n    MissingCheckout,\n    MissingConsignments,\n    MissingCustomer,\n    MissingCheckoutConfig,\n    MissingOrder,\n    MissingOrderConfig,\n    MissingOrderId,\n    MissingPayment,\n    MissingPaymentId,\n    MissingPaymentInstrument,\n    MissingPaymentMethod,\n    MissingPaymentRedirectUrl,\n    MissingPaymentStatus,\n    MissingPaymentToken,\n    MissingShippingAddress,\n}\n\n/**\n * Throw this error when data that is expected to exist is missing. Usually it\n * is due to the fact that certain data has not been retrieved from or saved to\n * the server yet. And such data is required to perform certain actions.\n */\nexport default class MissingDataError extends StandardError {\n    constructor(public subtype: MissingDataErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'MissingDataError';\n        this.type = 'missing_data';\n    }\n}\n\nfunction getErrorMessage(type: MissingDataErrorType): string {\n    switch (type) {\n        case MissingDataErrorType.MissingBillingAddress:\n            return 'Unable to proceed because billing address data is unavailable.';\n\n        case MissingDataErrorType.MissingCart:\n            return 'Unable to proceed because cart data is unavailable.';\n\n        case MissingDataErrorType.MissingConsignments:\n            return 'Unable to proceed because consignments data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckout:\n            return 'Unable to proceed because checkout data is unavailable.';\n\n        case MissingDataErrorType.MissingCustomer:\n            return 'Unable to proceed because customer data is unavailable.';\n\n        case MissingDataErrorType.MissingCheckoutConfig:\n        case MissingDataErrorType.MissingOrderConfig:\n            return 'Unable to proceed because configuration data is unavailable.';\n\n        case MissingDataErrorType.MissingOrder:\n            return 'Unable to proceed because order data is unavailable.';\n\n        case MissingDataErrorType.MissingOrderId:\n            return 'Unable to proceed because order ID is unavailable or not generated yet.';\n\n        case MissingDataErrorType.MissingPayment:\n            return 'Unable to proceed because payment data is unavailable.';\n\n        case MissingDataErrorType.MissingPaymentToken:\n            return 'Unable to proceed because the token required to submit a payment is missing.';\n\n        case MissingDataErrorType.MissingPaymentMethod:\n            return 'Unable to proceed because payment method data is unavailable or not properly configured.';\n\n        case MissingDataErrorType.MissingShippingAddress:\n            return 'Unable to proceed because shipping address data is unavailable.';\n\n        default:\n            return 'Unable to proceed because the required data is unavailable.';\n    }\n}\n","import ResolvableModule from './resolvable-module';\n\nexport default function toResolvableModule<TModule, TIdentifier>(\n    module: TModule,\n    resolveIds: TIdentifier[],\n): ResolvableModule<TModule, TIdentifier> {\n    return Object.assign(module, { resolveIds });\n}\n","// define getter functions for harmony exports\n__webpack_require__.d = (exports, definition) => {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.o = (obj, prop) => (Object.prototype.hasOwnProperty.call(obj, prop))","import CustomError from './custom-error';\nimport setPrototypeOf from './set-prototype-of';\n\n/**\n * This error type should not be constructed directly. It is a base class for\n * all custom errors thrown in this library.\n */\nexport default abstract class StandardError extends Error implements CustomError {\n    name = 'StandardError';\n    type = 'standard';\n\n    constructor(message?: string) {\n        super(message || 'An unexpected error has occurred.');\n\n        setPrototypeOf(this, new.target.prototype);\n\n        if (typeof Error.captureStackTrace === 'function') {\n            Error.captureStackTrace(this, new.target);\n        } else {\n            this.stack = new Error(this.message).stack;\n        }\n    }\n}\n","export default function setPrototypeOf(object: any, prototype: object) {\n    if (Object.setPrototypeOf) {\n        Object.setPrototypeOf(object, prototype);\n    } else {\n        object.__proto__ = prototype;\n    }\n\n    return object;\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when the client library of a payment method fails\n * to load, or for some reason, it is inaccessible.\n */\nexport default class PaymentMethodClientUnavailableError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method is not loaded or ready to be used.',\n        );\n\n        this.name = 'PaymentMethodClientUnavailableError';\n        this.type = 'payment_method_client_unavailable';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a shopper tries to sign in as a guest but\n * they are already signed in as a registered customer.\n */\nexport default class BuyNowCartCreationError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'An unexpected error has occurred during buy now cart creation process. Please try again later.',\n        );\n\n        this.name = 'BuyNowCartCreationError';\n        this.type = 'buy_now_cart_creation_error';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport StandardError from './standard-error';\n\nconst DEFAULT_RESPONSE = {\n    body: {},\n    headers: {},\n    status: 0,\n};\n\n/**\n * Throw this error if we are unable to make a request to the server. It wraps\n * any server response into a JS error object.\n */\nexport default class RequestError<TBody = any> extends StandardError {\n    body: TBody | {};\n    headers: { [key: string]: any };\n    errors: Array<{ code: string; message?: string }>;\n    status: number;\n\n    constructor(\n        response?: Response<TBody | {}>,\n        {\n            message,\n            errors,\n        }: {\n            message?: string;\n            errors?: Array<{ code: string; message?: string }>;\n        } = {},\n    ) {\n        const { body, headers, status } = response || DEFAULT_RESPONSE;\n\n        super(message || 'An unexpected error has occurred.');\n\n        this.name = 'RequestError';\n        this.type = 'request';\n        this.body = body;\n        this.headers = headers;\n        this.status = status;\n        this.errors = errors || [];\n    }\n}\n","export enum CartSource {\n    BuyNow = 'BUY_NOW',\n}\n","import { PayPalBNPLConfigurationItem } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    BuyNowCartRequestBody,\n    HostedInstrument,\n    ShippingOption,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n/**\n *\n * BigCommerce Payments Funding sources\n *\n */\nexport type FundingType = string;\n// TODO: rename BigCommercePaymentsSDKFunding to PayPalSDKFunding\nexport interface BigCommercePaymentsSDKFunding {\n    CARD: string;\n    PAYPAL: string;\n    CREDIT: string;\n    PAYLATER: string;\n    OXXO: string;\n    SEPA: string;\n    VENMO: string;\n}\n\n/**\n *\n * BigCommerce Payments SDK\n *\n */\n\nexport interface BigCommercePaymentsCardFieldsConfig {\n    inputEvents: {\n        onChange(data: BigCommercePaymentsCardFieldsState): void;\n        onFocus(data: BigCommercePaymentsCardFieldsState): void;\n        onBlur(data: BigCommercePaymentsCardFieldsState): void;\n        onInputSubmitRequest(data: BigCommercePaymentsCardFieldsState): void;\n    };\n    createVaultSetupToken?: (data: BigCommercePaymentsCardFieldsState) => void;\n    createOrder?: () => Promise<string>;\n    style: BigCommercePaymentsHostedFieldsRenderOptions['styles'];\n    onApprove(data: BigCommercePaymentsCardFieldsOnApproveData): void;\n    onError(): void;\n}\n\nexport interface BigCommercePaymentsCardFieldsOnApproveData {\n    vaultSetupToken?: string;\n    orderID: string;\n    liabilityShift?: LiabilityShiftEnum;\n}\n\nexport enum LiabilityShiftEnum {\n    Possible = 'POSSIBLE',\n    No = 'NO',\n    Unknown = 'UNKNOWN',\n    Yes = 'YES',\n}\n\ninterface BigCommercePaymentsCardFieldsFieldData {\n    isFocused: boolean;\n    isEmpty: boolean;\n    isValid: boolean;\n    isPotentiallyValid: boolean;\n}\n\ntype BigCommercePaymentsCardFieldsCard = BigCommercePaymentsHostedFieldsCard;\n\nexport interface BigCommercePaymentsCardFieldsState {\n    cards: BigCommercePaymentsCardFieldsCard[];\n    emittedBy: string;\n    isFormValid: boolean;\n    errors: string[];\n    fields: {\n        cardCvvField: BigCommercePaymentsCardFieldsFieldData;\n        cardNumberField: BigCommercePaymentsCardFieldsFieldData;\n        cardNameField?: BigCommercePaymentsCardFieldsFieldData;\n        cardExpiryField: BigCommercePaymentsCardFieldsFieldData;\n    };\n}\n\nexport interface BigCommercePaymentsFields {\n    render(container: HTMLElement | string): Promise<void>;\n    clear(): void;\n    removeClass(className: string): Promise<void>;\n    close(): Promise<void>;\n}\n\ninterface BigCommercePaymentsFieldsInitializationData {\n    placeholder?: string;\n}\n\nexport interface BigCommercePaymentsCardFields {\n    isEligible(): boolean;\n    CVVField(config?: BigCommercePaymentsFieldsInitializationData): BigCommercePaymentsFields;\n    ExpiryField(config?: BigCommercePaymentsFieldsInitializationData): BigCommercePaymentsFields;\n    NameField(config?: BigCommercePaymentsFieldsInitializationData): BigCommercePaymentsFields;\n    NumberField(config?: BigCommercePaymentsFieldsInitializationData): BigCommercePaymentsFields;\n    submit(config?: BigCommercePaymentsCardFieldsSubmitConfig): Promise<void>;\n    getState(): Promise<BigCommercePaymentsCardFieldsState>;\n}\n\nexport interface BigCommercePaymentsCardFieldsSubmitConfig {\n    billingAddress: {\n        company?: string;\n        addressLine1: string;\n        addressLine2?: string;\n        adminArea1: string; // State\n        adminArea2: string; // City\n        postalCode: string;\n        countryCode?: string;\n    };\n}\n\nexport interface PayPalSDK {\n    CardFields: (\n        data: BigCommercePaymentsCardFieldsConfig,\n    ) => Promise<BigCommercePaymentsCardFields>;\n    Googlepay: () => {\n        config: () => Promise<GooglePayConfig>;\n        confirmOrder: (arg0: {\n            orderId: string;\n            paymentMethodData: ConfirmOrderData;\n        }) => Promise<{ status: string }>;\n        initiatePayerAction: () => void;\n    };\n    FUNDING: BigCommercePaymentsSDKFunding;\n    HostedFields: {\n        isEligible(): boolean;\n        render(\n            data: BigCommercePaymentsHostedFieldsRenderOptions,\n        ): Promise<BigCommercePaymentsHostedFields>;\n    };\n    Legal: PayPalLegal & LegalFunding;\n    Buttons(options: BigCommercePaymentsButtonsOptions): BigCommercePaymentsButtons;\n    PaymentFields(\n        options: BigCommercePaymentsPaymentFieldsOptions,\n    ): BigCommercePaymentsPaymentFields;\n    Messages(options: BigCommercePaymentsMessagesOptions): BigCommercePaymentsMessages;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\nexport type PayPalLegal = (params: { fundingSource: string }) => {\n    render(container: string): void;\n};\n\nexport interface LegalFunding {\n    FUNDING: {\n        PAY_UPON_INVOICE: string;\n    };\n}\n\nexport interface BirthDate {\n    getFullYear(): number;\n    getDate(): number;\n    getMonth(): number;\n}\n\nexport interface BigCommercePaymentsScriptParams {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'disable-funding'?: FundingType[];\n        'enable-funding'?: FundingType[];\n        currency?: string;\n        commit?: boolean;\n        intent?: BigCommercePaymentsIntent;\n        components?: ComponentsScriptType;\n    };\n    attributes: {\n        'data-client-token'?: string;\n        'data-client-metadata-id'?: string;\n        'data-partner-attribution-id'?: string;\n        'data-user-id-token'?: string;\n    };\n}\n\nexport enum BigCommercePaymentsIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type ComponentsScriptType = Array<\n    | 'buttons'\n    | 'funding-eligibility'\n    | 'hosted-fields'\n    | 'messages'\n    | 'payment-fields'\n    | 'legal'\n    | 'googlepay'\n    | 'connect'\n    | 'card-fields'\n>;\n\nexport interface BigCommercePaymentsHostWindow extends Window {\n    paypal?: PayPalSDK;\n}\n\n/**\n *\n * BigCommerce Payments Initialization Data\n *\n */\nexport interface BigCommercePaymentsInitializationData {\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType[];\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientId: string;\n    clientToken?: string;\n    enabledAlternativePaymentMethods: FundingType[];\n    isDeveloperModeApplicable?: boolean;\n    intent?: BigCommercePaymentsIntent;\n    isAcceleratedCheckoutEnabled?: boolean;\n    isHostedCheckoutEnabled?: boolean;\n    isPayPalCreditAvailable?: boolean;\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    merchantId?: string;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    shouldRunAcceleratedCheckout?: boolean;\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n    isAppSwitchEnabled?: boolean;\n    paypalBNPLConfiguration?: PayPalBNPLConfigurationItem[];\n}\n\n/**\n *\n * BigCommerce Payments BuyNow\n *\n */\nexport interface PayPalBuyNowInitializeOptions {\n    getBuyNowCartRequestBody(): BuyNowCartRequestBody;\n}\n\n/**\n *\n * BigCommerce Payments Hosted Fields\n *\n */\nexport interface BigCommercePaymentsHostedFieldsRenderOptions {\n    fields?: {\n        number?: BigCommercePaymentsHostedFieldOption;\n        cvv?: BigCommercePaymentsHostedFieldOption;\n        expirationDate?: BigCommercePaymentsHostedFieldOption;\n    };\n    paymentsSDK?: boolean;\n    styles?: {\n        input?: { [key: string]: string };\n        '.invalid'?: { [key: string]: string };\n        '.valid'?: { [key: string]: string };\n        ':focus'?: { [key: string]: string };\n    };\n    createOrder(): Promise<string>;\n}\n\nexport interface BigCommercePaymentsHostedFieldOption {\n    selector: string;\n    placeholder?: string;\n}\n\nexport interface BigCommercePaymentsHostedFields {\n    submit(\n        options?: BigCommercePaymentsHostedFieldsSubmitOptions,\n    ): Promise<BigCommercePaymentsHostedFieldsApprove>;\n    getState(): BigCommercePaymentsHostedFieldsState;\n    on(eventName: string, callback: (event: BigCommercePaymentsHostedFieldsState) => void): void;\n}\n\nexport interface BigCommercePaymentsHostedFieldsSubmitOptions {\n    contingencies?: Array<'3D_SECURE'>;\n    cardholderName?: string;\n}\n\nexport interface BigCommercePaymentsHostedFieldsApprove {\n    orderId: string;\n    liabilityShift?: 'POSSIBLE' | 'NO' | 'UNKNOWN';\n}\n\nexport interface BigCommercePaymentsHostedFieldsState {\n    cards: BigCommercePaymentsHostedFieldsCard[];\n    emittedBy: string;\n    fields: {\n        number?: BigCommercePaymentsHostedFieldsFieldData;\n        expirationDate?: BigCommercePaymentsHostedFieldsFieldData;\n        expirationMonth?: BigCommercePaymentsHostedFieldsFieldData;\n        expirationYear?: BigCommercePaymentsHostedFieldsFieldData;\n        cvv?: BigCommercePaymentsHostedFieldsFieldData;\n        postalCode?: BigCommercePaymentsHostedFieldsFieldData;\n    };\n}\n\nexport interface BigCommercePaymentsHostedFieldsCard {\n    type: string;\n    niceType: string;\n    code: {\n        name: string;\n        size: number;\n    };\n}\n\nexport interface BigCommercePaymentsHostedFieldsFieldData {\n    container: HTMLElement;\n    isFocused: boolean;\n    isEmpty: boolean;\n    isPotentiallyValid: boolean;\n    isValid: boolean;\n}\n\n/**\n *\n * BigCommerce Payments Buttons\n *\n */\nexport interface BigCommercePaymentsButtons {\n    render(id: string): void;\n    close(): void;\n    isEligible(): boolean;\n    hasReturned?(): boolean;\n    resume?(): void;\n}\n\nexport interface BigCommercePaymentsButtonsOptions {\n    experience?: string;\n    style?: PayPalButtonStyleOptions;\n    fundingSource: string;\n    createOrder(): Promise<string>;\n    onApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n    ): Promise<boolean | void> | void;\n    onInit?(data: InitCallbackPayload, actions: InitCallbackActions): Promise<void>;\n    onComplete?(data: CompleteCallbackDataPayload): Promise<void>;\n    onClick?(data: ClickCallbackPayload, actions: ClickCallbackActions): Promise<void> | void;\n    onError?(error: Error): void;\n    onCancel?(): void;\n    onShippingAddressChange?(data: ShippingAddressChangeCallbackPayload): Promise<void>;\n    onShippingOptionsChange?(data: ShippingOptionChangeCallbackPayload): Promise<void>;\n}\n\nexport interface ShippingOptionChangeCallbackPayload {\n    orderId: string;\n    selectedShippingOption: PayPalSelectedShippingOption;\n}\n\nexport interface ShippingAddressChangeCallbackPayload {\n    orderId: string;\n    shippingAddress: PayPalAddress;\n}\n\nexport interface ClickCallbackPayload {\n    fundingSource: string;\n}\n\nexport interface ClickCallbackActions {\n    reject(): void;\n    resolve(): void;\n}\n\nexport interface InitCallbackPayload {\n    correlationID: string;\n}\n\nexport interface InitCallbackActions {\n    disable(): void;\n    enable(): void;\n}\n\nexport interface PayPalAddress {\n    city: string;\n    countryCode: string;\n    postalCode: string;\n    state: string;\n}\n\nexport interface PaypalAddressCallbackData {\n    city: string;\n    country_code: string;\n    postal_code: string;\n    state: string;\n}\n\nexport interface PayPalSelectedShippingOption {\n    amount: {\n        currency_code: string;\n        value: string;\n    };\n    id: string;\n    label: string;\n    selected: boolean;\n    type: string;\n}\n\nexport interface ApproveCallbackPayload {\n    orderID?: string;\n}\n\nexport interface ApproveCallbackActions {\n    order: {\n        get: () => Promise<PayPalOrderDetails>;\n    };\n}\n\nexport interface PayPalOrderDetails {\n    payer: {\n        name: {\n            given_name: string;\n            surname: string;\n        };\n        email_address: string;\n        address: PayPalOrderAddress;\n        phone?: {\n            phone_number: {\n                national_number: string;\n            };\n        };\n    };\n    purchase_units: Array<{\n        shipping: {\n            address: PayPalOrderAddress;\n            name: {\n                full_name: string;\n            };\n        };\n    }>;\n}\n\nexport interface PayPalOrderAddress {\n    address_line_1: string;\n    address_line_2: string;\n    admin_area_2: string;\n    admin_area_1?: string;\n    postal_code: string;\n    country_code: string;\n}\n\nexport interface CompleteCallbackDataPayload {\n    intent: string;\n    orderID: string;\n}\n\nexport enum StyleButtonLabel {\n    paypal = 'paypal',\n    checkout = 'checkout',\n    buynow = 'buynow',\n    pay = 'pay',\n    installment = 'installment',\n}\n\nexport enum StyleButtonColor {\n    gold = 'gold',\n    blue = 'blue',\n    silver = 'silver',\n    black = 'black',\n    white = 'white',\n}\n\nexport enum StyleButtonShape {\n    pill = 'pill',\n    rect = 'rect',\n}\n\nexport interface PayPalButtonStyleOptions {\n    color?: StyleButtonColor;\n    shape?: StyleButtonShape;\n    height?: number;\n    label?: StyleButtonLabel;\n}\n\n/**\n *\n * BigCommerce Payments Payment fields\n *\n */\nexport interface BigCommercePaymentsPaymentFields {\n    render(id: string): void;\n}\n\nexport interface BigCommercePaymentsPaymentFieldsOptions {\n    style?: BigCommercePaymentsFieldsStyleOptions;\n    fundingSource: string;\n    fields: {\n        name?: {\n            value?: string;\n        };\n        email?: {\n            value?: string;\n        };\n    };\n}\n\nexport interface BigCommercePaymentsFieldsStyleOptions {\n    variables?: {\n        fontFamily?: string;\n        fontSizeBase?: string;\n        fontSizeSm?: string;\n        fontSizeM?: string;\n        fontSizeLg?: string;\n        textColor?: string;\n        colorTextPlaceholder?: string;\n        colorBackground?: string;\n        colorInfo?: string;\n        colorDanger?: string;\n        borderRadius?: string;\n        borderColor?: string;\n        borderWidth?: string;\n        borderFocusColor?: string;\n        spacingUnit?: string;\n    };\n    rules?: {\n        [key: string]: any;\n    };\n}\n\n/**\n *\n * BigCommercePayments Messages\n */\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface BigCommercePaymentsMessages {\n    render(id: string): void;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface BigCommercePaymentsMessagesOptions {\n    amount: number;\n    placement: string;\n    style?: BigCommercePaymentsMessagesStyleOptions;\n    fundingSource?: string;\n}\n\n// TODO: This interface can be removed once the PayPaySDK interface is removed\nexport interface BigCommercePaymentsMessagesStyleOptions {\n    layout?: string;\n}\n\n/**\n *\n * Other\n *\n */\nexport enum NonInstantAlternativePaymentMethods {\n    OXXO = 'oxxo',\n}\n\nexport interface PayPalOrderData {\n    orderId: string;\n    setupToken?: string;\n    approveUrl: string;\n}\n\nexport interface PayPalUpdateOrderRequestBody {\n    availableShippingOptions?: ShippingOption[];\n    cartId: string;\n    selectedShippingOption?: ShippingOption;\n}\n\nexport interface PayPalUpdateOrderResponse {\n    statusCode: number;\n}\n\nexport interface PayPalCreateOrderRequestBody extends HostedInstrument, VaultedInstrument {\n    cartId: string;\n    metadataId?: string;\n    setupToken?: boolean;\n    fastlaneToken?: string;\n    methodId?: string;\n    gatewayId?: string;\n}\n\nexport enum PayPalOrderStatus {\n    Approved = 'APPROVED',\n    Created = 'CREATED',\n    PayerActionRequired = 'PAYER_ACTION_REQUIRED',\n    PollingStop = 'POLLING_STOP',\n    PollingError = 'POLLING_ERROR',\n}\n\nexport interface PayPalOrderStatusData {\n    status: PayPalOrderStatus;\n}\n\nexport interface PayPalCreateOrderCardFieldsResponse {\n    orderId: string;\n    setupToken?: string;\n}\n","import { FormPoster } from '@bigcommerce/form-poster';\nimport { isNil, omitBy } from 'lodash';\n\nimport {\n    BillingAddressRequestBody,\n    BuyNowCartCreationError,\n    Cart,\n    CartSource,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    RequestError,\n    RequestOptions,\n    ShippingOption,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsRequestSender from './bigcommerce-payments-request-sender';\nimport BigCommercePaymentsScriptLoader from './bigcommerce-payments-script-loader';\nimport {\n    BigCommercePaymentsInitializationData,\n    PayPalButtonStyleOptions,\n    PayPalBuyNowInitializeOptions,\n    PayPalCreateOrderCardFieldsResponse,\n    PayPalCreateOrderRequestBody,\n    PayPalOrderDetails,\n    PayPalOrderStatus,\n    PayPalSDK,\n    StyleButtonColor,\n    StyleButtonLabel,\n    StyleButtonShape,\n} from './bigcommerce-payments-types';\n\nexport default class BigCommercePaymentsIntegrationService {\n    private paypalSdk?: PayPalSDK;\n\n    constructor(\n        private formPoster: FormPoster,\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsRequestSender: BigCommercePaymentsRequestSender,\n        private bigCommercePaymentsScriptLoader: BigCommercePaymentsScriptLoader,\n    ) {}\n\n    /**\n     *\n     * PayPalSDK methods\n     *\n     */\n    async loadPayPalSdk(\n        methodId: string,\n        providedCurrencyCode?: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalSDK | undefined> {\n        const state = this.paymentIntegrationService.getState();\n        const currencyCode = providedCurrencyCode || state.getCartOrThrow().currency.code;\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        this.paypalSdk = await this.bigCommercePaymentsScriptLoader.getPayPalSDK(\n            paymentMethod,\n            currencyCode,\n            initializesOnCheckoutPage,\n            forceLoad,\n        );\n\n        return this.paypalSdk;\n    }\n\n    getPayPalSdkOrThrow(): PayPalSDK {\n        if (!this.paypalSdk) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalSdk;\n    }\n\n    /**\n     *\n     * Buy Now cart creation methods\n     *\n     */\n    async createBuyNowCartOrThrow(\n        buyNowInitializeOptions: PayPalBuyNowInitializeOptions,\n    ): Promise<Cart> {\n        const cartRequestBody = buyNowInitializeOptions.getBuyNowCartRequestBody();\n\n        if (!cartRequestBody) {\n            throw new MissingDataError(MissingDataErrorType.MissingCart);\n        }\n\n        try {\n            return await this.paymentIntegrationService.createBuyNowCart(cartRequestBody);\n        } catch (error) {\n            throw new BuyNowCartCreationError();\n        }\n    }\n\n    /**\n     *\n     * Order methods\n     *\n     */\n    async createOrder(\n        providerId: string,\n        requestBody?: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<string> {\n        const cartId = this.paymentIntegrationService.getState().getCartOrThrow().id;\n\n        const { orderId } = await this.bigCommercePaymentsRequestSender.createOrder(providerId, {\n            cartId,\n            ...requestBody,\n        });\n\n        return orderId;\n    }\n\n    async createOrderCardFields(\n        providerId: string,\n        requestBody?: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<PayPalCreateOrderCardFieldsResponse> {\n        const cartId = this.paymentIntegrationService.getState().getCartOrThrow().id;\n\n        const { orderId, setupToken } = await this.bigCommercePaymentsRequestSender.createOrder(\n            providerId,\n            {\n                cartId,\n                ...requestBody,\n            },\n        );\n\n        return { orderId, ...(setupToken ? { setupToken } : {}) };\n    }\n\n    async updateOrder(): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const consignment = state.getConsignmentsOrThrow()[0];\n\n        try {\n            await this.bigCommercePaymentsRequestSender.updateOrder({\n                availableShippingOptions: consignment.availableShippingOptions,\n                cartId: cart.id,\n                selectedShippingOption: consignment.selectedShippingOption,\n            });\n        } catch (_error) {\n            throw new RequestError();\n        }\n    }\n\n    async getOrderStatus(methodId?: string, options?: RequestOptions): Promise<PayPalOrderStatus> {\n        try {\n            const { status } = await this.bigCommercePaymentsRequestSender.getOrderStatus(\n                methodId,\n                options,\n            );\n\n            return status;\n        } catch (_error) {\n            throw new RequestError();\n        }\n    }\n\n    /**\n     *\n     * Payment submitting and tokenizing methods\n     *\n     */\n    tokenizePayment(methodId: string, orderId?: string): void {\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n\n        if (!orderId) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        return this.formPoster.postForm('/checkout.php', {\n            payment_type: 'paypal',\n            action: 'set_external_checkout',\n            provider: methodId,\n            order_id: orderId,\n            ...(cart.source === CartSource.BuyNow && { cart_id: cart.id }),\n        });\n    }\n\n    async submitPayment(methodId: string, orderId: string, gatewayId?: string): Promise<void> {\n        const paymentData = {\n            formattedPayload: {\n                vault_payment_instrument: null,\n                set_as_default_stored_instrument: null,\n                device_info: null,\n                method_id: methodId,\n                paypal_account: {\n                    order_id: orderId,\n                },\n            },\n        };\n\n        await this.paymentIntegrationService.submitPayment({\n            methodId,\n            paymentData,\n            ...(gatewayId ? { gatewayId } : {}),\n        });\n    }\n\n    /**\n     *\n     * Shipping options methods\n     *\n     */\n    getShippingOptionOrThrow(selectedShippingOptionId?: string): ShippingOption {\n        const state = this.paymentIntegrationService.getState();\n        const consignment = state.getConsignmentsOrThrow()[0];\n\n        const availableShippingOptions = consignment.availableShippingOptions || [];\n\n        const recommendedShippingOption = availableShippingOptions.find(\n            (option) => option.isRecommended,\n        );\n\n        const selectedShippingOption = selectedShippingOptionId\n            ? availableShippingOptions.find((option) => option.id === selectedShippingOptionId)\n            : availableShippingOptions.find(\n                  (option) => option.id === consignment.selectedShippingOption?.id,\n              );\n\n        const shippingOptionToSelect =\n            selectedShippingOption || recommendedShippingOption || availableShippingOptions[0];\n\n        if (!shippingOptionToSelect) {\n            throw new Error(\"Your order can't be shipped to this address\");\n        }\n\n        return shippingOptionToSelect;\n    }\n\n    /**\n     *\n     * Address transforming methods\n     *\n     */\n    getAddress(address?: Partial<BillingAddressRequestBody>): BillingAddressRequestBody {\n        return {\n            firstName: address?.firstName || '',\n            lastName: address?.lastName || '',\n            email: address?.email || '',\n            phone: address?.phone || '',\n            company: '',\n            address1: address?.address1 || '',\n            address2: address?.address2 || '',\n            city: address?.city || '',\n            countryCode: address?.countryCode || '',\n            postalCode: address?.postalCode || '',\n            stateOrProvince: '',\n            stateOrProvinceCode: address?.stateOrProvinceCode || '',\n            customFields: [],\n        };\n    }\n\n    getBillingAddressFromOrderDetails({ payer }: PayPalOrderDetails): BillingAddressRequestBody {\n        return this.getAddress({\n            firstName: payer.name.given_name,\n            lastName: payer.name.surname,\n            email: payer.email_address,\n            address1: payer.address.address_line_1,\n            address2: payer.address.address_line_2,\n            city: payer.address.admin_area_2,\n            countryCode: payer.address.country_code,\n            postalCode: payer.address.postal_code,\n            stateOrProvinceCode: payer.address.admin_area_1,\n            phone: payer.phone?.phone_number?.national_number,\n        });\n    }\n\n    getShippingAddressFromOrderDetails(\n        orderDetails: PayPalOrderDetails,\n    ): BillingAddressRequestBody {\n        const { payer, purchase_units } = orderDetails;\n        const {\n            address,\n            name: { full_name },\n        } = purchase_units[0].shipping;\n\n        const [firstName, ...lastName] = full_name.split(' ');\n\n        return this.getAddress({\n            firstName,\n            lastName: lastName.join(' '),\n            email: payer.email_address,\n            address1: address.address_line_1,\n            address2: address.address_line_2,\n            city: address.admin_area_2,\n            countryCode: address.country_code,\n            postalCode: address.postal_code,\n            stateOrProvinceCode: address.admin_area_1,\n        });\n    }\n\n    /**\n     *\n     * Buttons style methods\n     *\n     */\n    getValidButtonStyle(style?: PayPalButtonStyleOptions): PayPalButtonStyleOptions {\n        const { color, height, label, shape } = style || {};\n\n        const validStyles = {\n            color: color && StyleButtonColor[color] ? color : undefined,\n            height: this.getValidHeight(height),\n            label: label && StyleButtonLabel[label] ? label : undefined,\n            shape: shape && StyleButtonShape[shape] ? shape : undefined,\n        };\n\n        return omitBy(validStyles, isNil);\n    }\n\n    getValidHeight(height?: number): number {\n        const defaultHeight = 40;\n        const minHeight = 25;\n        const maxHeight = 55;\n\n        if (!height || typeof height !== 'number') {\n            return defaultHeight;\n        }\n\n        if (height > maxHeight) {\n            return maxHeight;\n        }\n\n        if (height < minHeight) {\n            return minHeight;\n        }\n\n        return height;\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    removeElement(elementId?: string): void {\n        const element = elementId && document.getElementById(elementId);\n\n        if (element) {\n            // For now this is a temporary solution, further removeElement method will be removed\n            element.style.display = 'none';\n        }\n    }\n}\n","export const INTERNAL_USE_ONLY =\n    'This API endpoint is for internal use only and may change in the future';\n","enum ContentType {\n    Json = 'application/json',\n    JsonV1 = 'application/vnd.bc.v1+json',\n}\n\nexport default ContentType;\n","export const SDK_VERSION_HEADERS = { 'X-Checkout-SDK-Version': LIBRARY_VERSION };\n","import { RequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    ContentType,\n    INTERNAL_USE_ONLY,\n    RequestOptions,\n    SDK_VERSION_HEADERS,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    PayPalCreateOrderRequestBody,\n    PayPalOrderData,\n    PayPalOrderStatusData,\n    PayPalUpdateOrderRequestBody,\n    PayPalUpdateOrderResponse,\n} from './bigcommerce-payments-types';\n\nexport default class BigCommercePaymentsRequestSender {\n    constructor(private requestSender: RequestSender) {}\n\n    async createOrder(\n        providerId: string,\n        requestBody: Partial<PayPalCreateOrderRequestBody>,\n    ): Promise<PayPalOrderData> {\n        const url = `/api/storefront/payment/${providerId}`;\n        const body = requestBody;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.post<PayPalOrderData>(url, { headers, body });\n\n        return res.body;\n    }\n\n    async updateOrder(\n        requestBody: PayPalUpdateOrderRequestBody,\n    ): Promise<PayPalUpdateOrderResponse> {\n        const url = `/api/storefront/initialization/bigcommerce_payments`;\n        const body = requestBody;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.put<PayPalUpdateOrderResponse>(url, { headers, body });\n\n        return res.body;\n    }\n\n    async getOrderStatus(\n        methodId = 'bigcommerce_payments',\n        options?: RequestOptions,\n    ): Promise<PayPalOrderStatusData> {\n        const url = `/api/storefront/initialization/${methodId}`;\n        const headers = {\n            'X-API-INTERNAL': INTERNAL_USE_ONLY,\n            'Content-Type': ContentType.Json,\n            ...SDK_VERSION_HEADERS,\n        };\n\n        const res = await this.requestSender.get<PayPalOrderStatusData>(url, {\n            headers,\n            ...options,\n        });\n\n        return res.body;\n    }\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    BigCommercePaymentsHostWindow,\n    BigCommercePaymentsInitializationData,\n    BigCommercePaymentsScriptParams,\n    ComponentsScriptType,\n    FundingType,\n    PayPalSDK,\n} from './bigcommerce-payments-types';\n\nexport default class BigCommercePaymentsScriptLoader {\n    private window: BigCommercePaymentsHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalSDK(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalSDK> {\n        const paypalSdkScriptConfig = this.getPayPalSdkScriptConfigOrThrow(\n            paymentMethod,\n            currencyCode,\n            initializesOnCheckoutPage,\n        );\n\n        return this.loadPayPalSDK(paypalSdkScriptConfig, forceLoad);\n    }\n\n    private async loadPayPalSDK(\n        paypalSdkScriptConfig: BigCommercePaymentsScriptParams,\n        forceLoad = false,\n    ): Promise<PayPalSDK> {\n        if (!this.window.paypal || forceLoad) {\n            const options = this.transformConfig<BigCommercePaymentsScriptParams['options']>(\n                paypalSdkScriptConfig.options,\n            );\n            const attributes = this.transformConfig<BigCommercePaymentsScriptParams['attributes']>(\n                paypalSdkScriptConfig.attributes,\n            );\n\n            const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n            const scriptQuery = new URLSearchParams(options).toString();\n            const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n            await this.scriptLoader.loadScript(scriptSrc, { async: true, attributes });\n        }\n\n        if (!this.window.paypal) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypal;\n    }\n\n    private getPayPalSdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): BigCommercePaymentsScriptParams {\n        const { id, clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData?.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isVenmoEnabled,\n            isHostedCheckoutEnabled,\n            isPayPalCreditAvailable,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n            isGooglePayEnabled,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        const shouldEnableCard = id === 'bigcommerce_payments_creditcards';\n        const enableCardFunding = shouldEnableCard ? ['card'] : [];\n        const disableCardFunding = !shouldEnableCard ? ['card'] : [];\n\n        const enableCreditFunding = isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n        const disableCreditFunding = !isPayPalCreditAvailable ? ['credit', 'paylater'] : [];\n\n        const enableVenmoFunding = isVenmoEnabled ? ['venmo'] : [];\n        const disableVenmoFunding = !isVenmoEnabled ? ['venmo'] : [];\n        const disableAPMsFunding = availableAlternativePaymentMethods.filter(\n            (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n        );\n        const googlePayComponent: ComponentsScriptType = isGooglePayEnabled ? ['googlepay'] : [];\n        const cardFieldsComponent: ComponentsScriptType = initializesOnCheckoutPage\n            ? ['card-fields']\n            : [];\n        const disableFunding: FundingType[] = this.filterFundingOptions([\n            ...disableCardFunding,\n            ...disableCreditFunding,\n            ...disableVenmoFunding,\n            ...disableAPMsFunding,\n        ]);\n        const enableFunding: FundingType[] = this.filterFundingOptions([\n            ...enableCardFunding,\n            ...enableCreditFunding,\n            ...enableVenmoFunding,\n            ...enabledAlternativePaymentMethods,\n        ]);\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableFunding.length > 0 ? enableFunding : undefined,\n                'disable-funding': disableFunding.length > 0 ? disableFunding : undefined,\n                commit,\n                components: [\n                    'buttons',\n                    'hosted-fields',\n                    'payment-fields',\n                    'legal',\n                    ...googlePayComponent,\n                    ...cardFieldsComponent,\n                ],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n            },\n        };\n    }\n\n    private filterFundingOptions(fundingOptions: FundingType[] | undefined): FundingType[] {\n        const fundingTypesToBeFiltered = ['klarna', 'afterpay'];\n\n        if (!fundingOptions) {\n            return [];\n        }\n\n        return fundingOptions.filter(\n            (fundingOption: FundingType) => !fundingTypesToBeFiltered.includes(fundingOption),\n        );\n    }\n\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import { createFormPoster } from '@bigcommerce/form-poster';\nimport { createRequestSender } from '@bigcommerce/request-sender';\nimport { getScriptLoader } from '@bigcommerce/script-loader';\n\nimport { PaymentIntegrationService } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    BigCommercePaymentsIntegrationService,\n    BigCommercePaymentsRequestSender,\n    BigCommercePaymentsScriptLoader,\n} from './index';\n\nconst createBigCommercePaymentsIntegrationService = (\n    paymentIntegrationService: PaymentIntegrationService,\n) => {\n    const { getHost } = paymentIntegrationService.getState();\n\n    return new BigCommercePaymentsIntegrationService(\n        createFormPoster(),\n        paymentIntegrationService,\n        new BigCommercePaymentsRequestSender(createRequestSender({ host: getHost() })),\n        new BigCommercePaymentsScriptLoader(getScriptLoader()),\n    );\n};\n\nexport default createBigCommercePaymentsIntegrationService;\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a method is unable to proceed because the\n * caller has not provided all the arguments according to their requirements,\n * i.e.: if an argument is missing or it is not the expected data type.\n */\nexport default class InvalidArgumentError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Invalid arguments have been provided.');\n\n        this.name = 'InvalidArgumentError';\n        this.type = 'invalid_argument';\n    }\n}\n","import { noop } from 'lodash';\n\nimport {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsCustomerInitializeOptions, {\n    WithBigCommercePaymentsCustomerInitializeOptions,\n} from './bigcommerce-payments-customer-initialize-options';\n\nexport default class BigCommercePaymentsCustomerStrategy implements CustomerStrategy {\n    private onError = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithBigCommercePaymentsCustomerInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments.container\" argument is not provided.',\n            );\n        }\n\n        if (bigcommerce_payments.onClick && typeof bigcommerce_payments.onClick !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments.onClick\" argument is not a function.',\n            );\n        }\n\n        this.onError = bigcommerce_payments.onError || noop;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            // eslint-disable-next-line no-console\n            console.error(\n                '[BC PayPal]: PayPal Button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, bigcommerce_payments);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n\n        return Promise.resolve();\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n\n        return Promise.resolve();\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        bigcommerce_payments: BigCommercePaymentsCustomerInitializeOptions,\n    ): void {\n        const { container, onClick, onComplete } = bigcommerce_payments;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, paymentButtonStyles } =\n            paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder('bigcommerce_payments'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const hostedCheckoutCallbacks = {\n            onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                this.onShippingAddressChange(data),\n            onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                this.onShippingOptionsChange(data),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle({\n                ...checkoutTopButtonStyles,\n                height: DefaultCheckoutButtonHeight,\n            }),\n            ...defaultCallbacks,\n            ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n        };\n\n        const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButton.isEligible()) {\n            paypalButton.render(`#${container}`);\n        } else {\n            this.bigCommercePaymentsIntegrationService.removeElement(container);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<void> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.bigCommercePaymentsIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.bigCommercePaymentsIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.bigCommercePaymentsIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address except shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption =\n                this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private handleError(error: unknown) {\n        if (typeof this.onError === 'function') {\n            this.onError(error);\n        } else {\n            throw error;\n        }\n    }\n}\n","const DefaultCheckoutButtonHeight = 40;\n\nexport default DefaultCheckoutButtonHeight;\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsCustomerStrategy from './bigcommerce-payments-customer-strategy';\n\nconst createBigCommercePaymentsCustomerStrategy: CustomerStrategyFactory<\n    BigCommercePaymentsCustomerStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsCustomerStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsCustomerStrategy, [\n    { id: 'bigcommerce_payments' },\n]);\n","import { HostedInstrument, NonceInstrument } from './payment';\n\ntype PaymentInstrument = CardInstrument | AccountInstrument | HostedInstrument | NonceInstrument;\n\nexport default PaymentInstrument;\n\nexport interface BaseInstrument {\n    bigpayToken: string;\n    defaultInstrument: boolean;\n    provider: string;\n    trustedShippingAddress: boolean;\n    method: string;\n    type: string;\n}\n\nexport enum UntrustedShippingCardVerificationType {\n    CVV = 'cvv',\n    PAN = 'pan',\n}\n\nexport interface CardInstrument extends BaseInstrument {\n    brand: string;\n    expiryMonth: string;\n    expiryYear: string;\n    iin: string;\n    last4: string;\n    type: 'card';\n    untrustedShippingCardVerificationMode: UntrustedShippingCardVerificationType;\n}\n\ninterface BaseAccountInstrument extends BaseInstrument {\n    method: string;\n    type: 'account' | 'bank';\n}\n\nexport interface PayPalInstrument extends BaseAccountInstrument {\n    externalId: string;\n    method: 'paypal';\n}\n\nexport interface AchInstrument extends BaseAccountInstrument {\n    issuer: string;\n    accountNumber: string;\n    type: 'bank';\n    method: 'ach' | 'ecp';\n}\n\nexport interface BankInstrument extends BaseAccountInstrument {\n    accountNumber: string;\n    issuer: string;\n    iban: string;\n    method: string;\n    type: 'bank';\n}\n\nexport type AccountInstrument = PayPalInstrument | BankInstrument | AchInstrument;\n\nexport interface VaultAccessToken {\n    vaultAccessToken: string;\n    vaultAccessExpiry: number;\n}\n\nexport interface SessionContext {\n    customerId: number;\n    storeId: string;\n    currencyCode?: string;\n}\n\nexport interface InstrumentRequestContext extends SessionContext {\n    authToken: string;\n}\n","import { CardInstrument, CustomerAddress } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n/**\n *\n * BigCommerce Payments Funding sources\n *\n */\nexport type FundingType = string;\n\n/**\n *\n * BigCommerce Payments Initialization Data\n *\n */\nexport interface BigCommercePaymentsInitializationData {\n    attributionId?: string;\n    availableAlternativePaymentMethods: FundingType[];\n    buttonStyle?: PayPalButtonStyleOptions;\n    buyerCountry?: string;\n    clientId: string;\n    clientToken?: string;\n    fastlaneStyles?: FastlaneStylesSettings;\n    connectClientToken?: string; // TODO: remove when BCP Fastlane A/B test will be finished\n    enabledAlternativePaymentMethods: FundingType[];\n    isDeveloperModeApplicable?: boolean;\n    intent?: BigCommercePaymentsIntent;\n    isAcceleratedCheckoutEnabled?: boolean; // PayPal Fastlane related\n    isFastlaneShippingOptionAutoSelectEnabled?: boolean; // PayPal Fastlane related\n    isFastlaneStylingEnabled?: boolean;\n    isHostedCheckoutEnabled?: boolean;\n    isBigCommercePaymentsAnalyticsV2Enabled?: boolean; // PayPal Fastlane related\n    isPayPalCreditAvailable?: boolean;\n    isVenmoEnabled?: boolean;\n    isGooglePayEnabled?: boolean;\n    merchantId?: string;\n    orderId?: string;\n    shouldRenderFields?: boolean;\n    shouldRunAcceleratedCheckout?: boolean; // TODO: remove when BCP Fastlane A/B test will be finished\n    paymentButtonStyles?: Record<string, PayPalButtonStyleOptions>;\n    paypalBNPLConfiguration?: PayPalBNPLConfigurationItem[];\n    threeDSVerificationMethod?: string;\n}\n\n/**\n *\n * PayPalHostWindow contains different\n * PayPal Sdk instances for different purposes\n *\n */\nexport interface PayPalHostWindow extends Window {\n    paypalFastlane?: PayPalFastlane;\n    paypalFastlaneSdk?: PayPalFastlaneSdk;\n    paypalMessages?: PayPalMessagesSdk;\n    paypalApms?: PayPalApmSdk;\n    paypalGooglePay?: PayPalGooglePaySdk;\n}\n\n/**\n *\n * PayPal SDK config\n *\n */\nexport interface PayPalSdkConfig {\n    options: {\n        'client-id'?: string;\n        'merchant-id'?: string;\n        'buyer-country'?: string;\n        'enable-funding'?: FundingType[];\n        'disable-funding'?: FundingType[];\n        currency?: string;\n        commit?: boolean;\n        intent?: BigCommercePaymentsIntent;\n        components?: PayPalSdkComponents;\n    };\n    attributes: {\n        'data-client-metadata-id'?: string;\n        'data-partner-attribution-id'?: string;\n        'data-user-id-token'?: string;\n        'data-namespace'?: string;\n        'data-client-token'?: string;\n        'data-sdk-client-token'?: string;\n    };\n}\n\nexport enum BigCommercePaymentsIntent {\n    AUTHORIZE = 'authorize',\n    CAPTURE = 'capture',\n}\n\nexport type PayPalSdkComponents = Array<\n    'fastlane' | 'messages' | 'buttons' | 'payment-fields' | 'googlepay' | 'three-domain-secure'\n>;\n\n/**\n *\n * PayPal Sdk instances\n *\n */\nexport enum LiabilityShiftEnum {\n    Possible = 'POSSIBLE',\n    No = 'NO',\n    Unknown = 'UNKNOWN',\n    Yes = 'YES',\n}\n\nexport interface threeDSecureParameters {\n    amount: string;\n    currency: string;\n    nonce: string;\n    threeDSRequested: boolean;\n    transactionContext: {\n        experience_context: {\n            brand_name?: string;\n            locale: string;\n            return_url: string;\n            cancel_url: string;\n        };\n    };\n}\n\nexport interface PayPalFastlaneSdk {\n    ThreeDomainSecureClient: {\n        isEligible(params: threeDSecureParameters): Promise<boolean>;\n        show(): Promise<ThreeDomainSecureClientShowResponse>;\n    };\n    Fastlane(options?: PayPalFastlaneOptions): Promise<PayPalFastlane>;\n}\n\ninterface ThreeDomainSecureClientShowResponse {\n    liabilityShift: LiabilityShiftEnum;\n    authenticationState: TDSecureAuthenticationState;\n    nonce: string; // Enriched nonce or the original nonce\n}\n\nexport interface PayPalMessagesSdk {\n    Messages(options: MessagingOptions): MessagingRender;\n}\n\nexport interface PayPalApmSdk {\n    Buttons(options: BigCommercePaymentsButtonsOptions): BigCommercePaymentsButtons;\n    PaymentFields(\n        options: BigCommercePaymentsPaymentFieldsOptions,\n    ): BigCommercePaymentsPaymentFields;\n}\n\nexport interface PayPalGooglePaySdk {\n    Googlepay(): GooglePay;\n}\n\nexport enum TDSecureVerificationMethod {\n    Always = 'SCA_ALWAYS',\n}\n\nexport enum TDSecureAuthenticationState {\n    Succeeded = 'succeeded',\n    Cancelled = 'cancelled',\n    Errored = 'errored',\n}\n\n/**\n *\n * Google Pay related types\n *\n */\n\ninterface GooglePay {\n    config: () => Promise<GooglePayConfig>;\n    confirmOrder: (confirmOrderConfig: ConfirmOrderConfig) => Promise<{ status: string }>;\n    initiatePayerAction: (payerActionConfig: PayerActionConfig) => Promise<void>;\n}\n\ninterface ConfirmOrderConfig {\n    orderId: string;\n    paymentMethodData: ConfirmOrderData;\n}\n\nexport interface ConfirmOrderData {\n    tokenizationData: {\n        type: string;\n        token: string;\n    };\n    info: {\n        cardNetwork: string;\n        cardDetails: string;\n    };\n    type: string;\n}\n\ninterface PayerActionConfig {\n    orderId: string;\n}\n\nexport interface GooglePayConfig {\n    allowedPaymentMethods: AllowedPaymentMethods[];\n    apiVersion: number;\n    apiVersionMinor: number;\n    countryCode: string;\n    isEligible: boolean;\n    merchantInfo: {\n        merchantId: string;\n        merchantOrigin: string;\n    };\n}\n\nexport interface AllowedPaymentMethods {\n    type: string;\n    parameters: {\n        allowedAuthMethods: string[];\n        allowedCardNetworks: string[];\n        billingAddressRequired: boolean;\n        assuranceDetailsRequired: boolean;\n        billingAddressParameters: {\n            format: string;\n        };\n    };\n    tokenizationSpecification: {\n        type: string;\n        parameters: {\n            gateway: string;\n            gatewayMerchantId: string;\n        };\n    };\n}\n\n/**\n *\n * BigCommerce Payments Buttons\n *\n */\nexport interface BigCommercePaymentsButtons {\n    render(id: string): void;\n    close(): void;\n    isEligible(): boolean;\n}\n\nexport interface BigCommercePaymentsButtonsOptions {\n    style?: PayPalButtonStyleOptions;\n    fundingSource: string;\n    createOrder(): Promise<string>;\n    onApprove(\n        data: PayPalButtonApproveCallbackPayload,\n        actions: PayPalButtonApproveCallbackActions,\n    ): Promise<boolean | void> | void;\n    onInit?(\n        data: PayPalButtonInitCallbackPayload,\n        actions: PayPalButtonInitCallbackActions,\n    ): Promise<void>;\n    onClick?(\n        data: PayPalButtonClickCallbackPayload,\n        actions: PayPalButtonClickCallbackActions,\n    ): Promise<void> | void;\n    onError?(error: Error): void;\n    onCancel?(): void;\n}\n\nexport interface PayPalButtonClickCallbackPayload {\n    fundingSource: string;\n}\n\nexport interface PayPalButtonClickCallbackActions {\n    reject(): void;\n    resolve(): void;\n}\n\nexport interface PayPalButtonInitCallbackPayload {\n    correlationID: string;\n}\n\nexport interface PayPalButtonInitCallbackActions {\n    disable(): void;\n    enable(): void;\n}\n\nexport interface PayPalButtonApproveCallbackPayload {\n    orderID?: string;\n}\n\nexport interface PayPalButtonApproveCallbackActions {\n    order: {\n        get: () => Promise<PayPalOrderDetails>;\n    };\n}\n\nexport interface PayPalOrderDetails {\n    payer: {\n        name: {\n            given_name: string;\n            surname: string;\n        };\n        email_address: string;\n        address: PayPalOrderAddress;\n    };\n    purchase_units: Array<{\n        shipping: {\n            address: PayPalOrderAddress;\n        };\n    }>;\n}\n\nexport interface PayPalOrderAddress {\n    address_line_1: string;\n    admin_area_2: string;\n    admin_area_1?: string;\n    postal_code: string;\n    country_code: string;\n}\n\nexport enum StyleButtonLabel {\n    paypal = 'paypal',\n    checkout = 'checkout',\n    buynow = 'buynow',\n    pay = 'pay',\n    installment = 'installment',\n}\n\nexport enum StyleButtonColor {\n    gold = 'gold',\n    blue = 'blue',\n    silver = 'silver',\n    black = 'black',\n    white = 'white',\n}\n\nexport enum StyleButtonShape {\n    pill = 'pill',\n    rect = 'rect',\n}\n\nexport interface PayPalButtonStyleOptions {\n    color?: StyleButtonColor;\n    shape?: StyleButtonShape;\n    height?: number;\n    label?: StyleButtonLabel;\n}\n\n/**\n *\n * BigCommerce Payments PaymentFields fields\n *\n */\nexport interface BigCommercePaymentsPaymentFields {\n    render(id: string): void;\n}\n\nexport interface BigCommercePaymentsPaymentFieldsOptions {\n    style?: BigCommercePaymentsFieldsStyleOptions;\n    fundingSource: string;\n    fields: {\n        name?: {\n            value?: string;\n        };\n        email?: {\n            value?: string;\n        };\n    };\n}\n\nexport interface BigCommercePaymentsFieldsStyleOptions {\n    variables?: {\n        fontFamily?: string;\n        fontSizeBase?: string;\n        fontSizeSm?: string;\n        fontSizeM?: string;\n        fontSizeLg?: string;\n        textColor?: string;\n        colorTextPlaceholder?: string;\n        colorBackground?: string;\n        colorInfo?: string;\n        colorDanger?: string;\n        borderRadius?: string;\n        borderColor?: string;\n        borderWidth?: string;\n        borderFocusColor?: string;\n        spacingUnit?: string;\n    };\n    rules?: {\n        [key: string]: any;\n    };\n}\n\n/**\n *\n * PayLater Messages related types\n * doc: https://developer.paypal.com/docs/checkout/pay-later/us/integrate/reference\n */\nexport interface MessagingRender {\n    render(container: string): void;\n}\n\nexport interface MessagesStyleOptions {\n    color?: string; // 'blue' | 'black' | 'white' | 'white-no-border' | 'gray' | 'monochrome' | 'grayscale'\n    layout?: string; // 'text' | 'flex'\n    logo?: {\n        type?: string; // 'primary' | 'alternative' | 'inline' | 'none'\n        position?: string; // 'left' | 'right' | 'top'\n    };\n    ratio?: string; // '1x1' | '1x4' | '8x1' | '20x1'\n    text?: {\n        align?: string; // 'left' | 'right' | 'center'\n        color?: string; // 'black' | 'white' | 'monochrome' | 'grayscale'\n        size?: number; // from 10 to 16\n    };\n}\n\nexport interface MessagingOptions {\n    amount: number;\n    placement: string;\n    style?: MessagesStyleOptions;\n}\n\nexport interface PayPalBNPLConfigurationItem {\n    id: string;\n    name: string;\n    status: boolean;\n    styles: Record<string, string>;\n}\n\n/**\n *\n * PayPal Fastlane related types\n *\n */\nexport interface PayPalFastlane {\n    identity: PayPalFastlaneIdentity;\n    events: PayPalFastlaneEvents;\n    profile: PayPalFastlaneProfile;\n    FastlaneCardComponent(\n        options: PayPalFastlaneCardComponentOptions,\n    ): Promise<PayPalFastlaneCardComponentMethods>;\n}\n\nexport interface PayPalFastlaneOptions {\n    styles?: PayPalFastlaneStylesOption;\n}\n\nexport interface PayPalFastlaneIdentity {\n    lookupCustomerByEmail(email: string): Promise<PayPalFastlaneLookupCustomerByEmailResult>;\n    triggerAuthenticationFlow(\n        customerContextId: string,\n    ): Promise<PayPalFastlaneAuthenticationResult>;\n}\n\nexport interface PayPalFastlaneLookupCustomerByEmailResult {\n    customerContextId?: string;\n}\n\nexport interface PayPalFastlaneAuthenticationResult {\n    authenticationState?: PayPalFastlaneAuthenticationState;\n    profileData?: PayPalFastlaneProfileData;\n}\n\nexport enum PayPalFastlaneAuthenticationState {\n    SUCCEEDED = 'succeeded',\n    FAILED = 'failed',\n    CANCELED = 'canceled',\n    UNRECOGNIZED = 'unrecognized',\n}\n\nexport interface PayPalFastlaneProfileData {\n    name: PayPalFastlaneProfileName;\n    shippingAddress: PayPalFastlaneShippingAddress;\n    card: PayPalFastlaneProfileCard;\n}\n\nexport interface PayPalFastlaneProfileName {\n    fullName: string;\n    firstName?: string;\n    lastName?: string;\n}\n\nexport interface PayPalFastlaneProfilePhone {\n    countryCode: string;\n    nationalNumber: string;\n}\n\nexport interface PayPalFastlaneShippingAddress {\n    name: PayPalFastlaneProfileName;\n    phoneNumber: PayPalFastlaneProfilePhone;\n    address: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneProfileCard {\n    id: string; // nonce / token\n    paymentSource: PayPalFastlanePaymentSource;\n}\n\nexport interface PayPalFastlanePaymentSource {\n    card: PayPalFastlaneCardSource;\n}\n\nexport interface PayPalFastlaneCardSource {\n    brand: string;\n    expiry: string; // \"YYYY-MM\"\n    lastDigits: string; // \"1111\"\n    name: string;\n    billingAddress: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneAddress {\n    company?: string;\n    addressLine1: string;\n    addressLine2?: string;\n    adminArea1: string; // State\n    adminArea2: string; // City\n    postalCode: string;\n    countryCode?: string;\n}\n\nexport interface PayPalFastlaneProfileToBcCustomerDataMappingResult {\n    authenticationState: PayPalFastlaneAuthenticationState;\n    addresses: CustomerAddress[];\n    billingAddress?: CustomerAddress;\n    shippingAddress?: CustomerAddress;\n    instruments: CardInstrument[];\n}\n\nexport interface PayPalFastlaneStylesOption {\n    root?: {\n        backgroundColorPrimary?: string;\n        errorColor?: string;\n        fontFamily?: string;\n        fontSizeBase?: string;\n        padding?: string;\n        primaryColor?: string;\n    };\n    input?: {\n        borderRadius?: string;\n        borderColor?: string;\n        focusBorderColor?: string;\n        backgroundColor?: string;\n        borderWidth?: string;\n        textColorBase?: string;\n    };\n    toggle?: {\n        colorPrimary?: string;\n        colorSecondary?: string;\n    };\n    text?: {\n        body?: {\n            color?: string;\n            fontSize?: string;\n        };\n        caption?: {\n            color?: string;\n            fontSize?: string;\n        };\n    };\n    branding?: string; // 'light' | 'dark'\n}\n\nexport interface PayPalFastlaneProfile {\n    showCardSelector(): Promise<PayPalFastlaneCardSelectorResponse>;\n    showShippingAddressSelector(): Promise<PayPalFastlaneShippingAddressSelectorResponse>;\n}\n\nexport interface PayPalFastlaneShippingAddressSelectorResponse {\n    selectionChanged: boolean;\n    selectedAddress: PayPalFastlaneShippingAddress;\n}\n\nexport interface PayPalFastlaneCardSelectorResponse {\n    selectionChanged: boolean;\n    selectedCard: PayPalFastlaneProfileCard;\n}\n\nexport interface PayPalFastlaneCardComponentMethods {\n    getPaymentToken(\n        options: PayPalFastlaneGetPaymentTokenOptions,\n    ): Promise<PayPalFastlaneProfileCard>;\n    render(element: string): void;\n}\n\nexport interface PayPalFastlaneGetPaymentTokenOptions {\n    name?: PayPalFastlaneProfileName;\n    billingAddress?: PayPalFastlaneAddress;\n}\n\nexport interface PayPalFastlaneCardComponentOptions {\n    fields?: PayPalFastlaneCardComponentFields;\n}\n\nexport interface PayPalFastlaneCardComponentFields {\n    cardholderName?: {\n        enabled?: boolean;\n        prefill?: string;\n    };\n    phoneNumber?: {\n        placeholder?: string;\n        prefill?: string;\n    };\n}\n\nexport interface PayPalFastlaneEvents {\n    apmSelected: (options: PayPalFastlaneApmSelectedEventOptions) => void;\n    emailSubmitted: (options: PayPalFastlaneEmailEnteredEventOptions) => void;\n    orderPlaced: (options: PayPalFastlaneOrderPlacedEventOptions) => void;\n}\n\nexport interface PayPalFastlaneEventCommonOptions {\n    context_type: 'cs_id';\n    context_id: string; // checkout session id\n    page_type: 'checkout_page';\n    page_name: string; // title of the checkout initiation page\n    partner_name: 'bigc';\n    user_type: 'store_member' | 'store_guest'; // type of the user on the merchant site\n    store_id: string;\n    merchant_name: string;\n    experiment: string; // stringify JSON object \"[{ treatment_group: 'test' | 'control' }]\"\n}\n\nexport interface PayPalFastlaneApmSelectedEventOptions extends PayPalFastlaneEventCommonOptions {\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page\n    apm_selected: string; // alternate payment method selected / methodId\n    apm_location: 'pre-email section' | 'payment section'; // placement of APM, whether it be above the email entry or in the radio buttons\n}\n\nexport interface PayPalFastlaneEmailEnteredEventOptions extends PayPalFastlaneEventCommonOptions {\n    user_email_saved: boolean; // shows whether checkout was loaded with or without a saved email\n    apm_shown: '0' | '1'; // alternate payment shown on the checkout page\n    apm_list: string; // list of alternate payment shown on checkout page 'applepay,googlepay,paypal'\n}\n\nexport interface PayPalFastlaneOrderPlacedEventOptions extends PayPalFastlaneEventCommonOptions {\n    selected_payment_method: string;\n    currency_code: string;\n}\n\nexport interface PayPalFastlanePaymentFormattedPayload {\n    paypal_connect_token?: {\n        order_id?: string;\n        token: string;\n    };\n    paypal_fastlane_token?: {\n        order_id?: string;\n        token: string;\n    };\n}\n\nexport interface FastlaneStylesSettings {\n    fastlaneRootSettingsBackgroundColor?: string;\n    fastlaneRootSettingsErrorColor?: string;\n    fastlaneRootSettingsFontFamily?: string;\n    fastlaneRootSettingsPadding?: string;\n    fastlaneRootSettingsPrimaryColor?: string;\n    fastlaneRootSettingsFontSize?: string;\n    fastlaneInputSettingsBackgroundColor?: string;\n    fastlaneInputSettingsBorderRadius?: string;\n    fastlaneInputSettingsBorderWidth?: string;\n    fastlaneInputSettingsTextColorBase?: string;\n    fastlaneInputSettingsBorderColor?: string;\n    fastlaneInputSettingsFocusBorderBase?: string;\n    fastlaneToggleSettingsColorPrimary?: string;\n    fastlaneToggleSettingsColorSecondary?: string;\n    fastlaneTextBodySettingsColor?: string;\n    fastlaneTextBodySettingsFontSize?: string;\n    fastlaneTextCaptionSettingsFontSize?: string;\n    fastlaneTextCaptionSettingsColor?: string;\n    fastlaneBrandingSettings?: string;\n}\n\nexport interface RedirectError {\n    body: {\n        additional_action_required: {\n            data: {\n                redirect_url: string;\n            };\n        };\n    };\n}\n","import { ScriptLoader } from '@bigcommerce/script-loader';\n\nimport {\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentMethod,\n    PaymentMethodClientUnavailableError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport {\n    BigCommercePaymentsInitializationData,\n    FundingType,\n    PayPalFastlaneSdk,\n    PayPalGooglePaySdk,\n    PayPalHostWindow,\n    PayPalMessagesSdk,\n    PayPalSdkConfig,\n} from './bigcommerce-payments-types';\n\nexport default class PayPalSdkHelper {\n    private window: PayPalHostWindow;\n\n    constructor(private scriptLoader: ScriptLoader) {\n        this.window = window;\n    }\n\n    async getPayPalFastlaneSdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): Promise<PayPalFastlaneSdk> {\n        if (!this.window.paypalFastlaneSdk) {\n            const config = this.getPayPalFastlaneSdkConfiguration(\n                paymentMethod,\n                currencyCode,\n                sessionId,\n            );\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalFastlaneSdk) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalFastlaneSdk;\n    }\n\n    async getPayPalGooglePaySdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage?: boolean,\n        forceLoad?: boolean,\n    ): Promise<PayPalGooglePaySdk> {\n        if (!this.window.paypalGooglePay || forceLoad) {\n            const paypalSdkScriptConfig = this.getPayPalGooglePaySdkScriptConfigOrThrow(\n                paymentMethod,\n                currencyCode,\n                initializesOnCheckoutPage,\n            );\n\n            await this.loadPayPalSdk(paypalSdkScriptConfig);\n        }\n\n        if (!this.window.paypalGooglePay) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalGooglePay;\n    }\n\n    async getPayPalApmsSdk(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ) {\n        if (!this.window.paypalApms) {\n            const config = this.getPayPalApmSdkConfiguration(paymentMethod, currencyCode);\n\n            await this.loadPayPalSdk(config);\n\n            if (!this.window.paypalApms) {\n                throw new PaymentMethodClientUnavailableError();\n            }\n        }\n\n        return this.window.paypalApms;\n    }\n\n    async getPayPalMessages(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): Promise<PayPalMessagesSdk> {\n        if (!this.window.paypalMessages) {\n            const paypalSdkMessagesConfig = this.getPayPalSdkMessagesConfiguration(\n                paymentMethod,\n                currencyCode,\n            );\n\n            await this.loadPayPalSdk(paypalSdkMessagesConfig);\n        }\n\n        if (!this.window.paypalMessages) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalMessages;\n    }\n\n    /**\n     *\n     *  loadPayPalSdk is a paypal sdk script loader\n     *  which loads paypal sdk based on provided configuration\n     *\n     */\n    private async loadPayPalSdk({ options, attributes }: PayPalSdkConfig): Promise<void> {\n        const scriptOptions = this.transformConfig<PayPalSdkConfig['options']>(options);\n        const scriptAttributes = this.transformConfig<PayPalSdkConfig['attributes']>(attributes);\n\n        const paypalSdkUrl = 'https://www.paypal.com/sdk/js';\n        const scriptQuery = new URLSearchParams(scriptOptions).toString();\n        const scriptSrc = `${paypalSdkUrl}?${scriptQuery}`;\n\n        await this.scriptLoader.loadScript(scriptSrc, {\n            async: true,\n            attributes: scriptAttributes,\n        });\n    }\n\n    /**\n     *\n     * Configurations section\n     *\n     */\n    private getPayPalFastlaneSdkConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        sessionId: string,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { intent, clientId, merchantId, attributionId } = initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit: true,\n                components: ['fastlane', 'three-domain-secure'],\n                currency: currencyCode,\n                intent,\n            },\n            attributes: {\n                'data-client-metadata-id': sessionId.replace(/-/g, ''),\n                'data-namespace': 'paypalFastlaneSdk',\n                'data-partner-attribution-id': attributionId,\n                'data-sdk-client-token': clientToken,\n            },\n        };\n    }\n\n    private getPayPalGooglePaySdkScriptConfigOrThrow(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n        initializesOnCheckoutPage = true,\n    ): PayPalSdkConfig {\n        const { clientToken, initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isHostedCheckoutEnabled,\n            isDeveloperModeApplicable,\n        } = initializationData;\n\n        const commit = isHostedCheckoutEnabled || initializesOnCheckoutPage;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                commit,\n                components: ['googlepay'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-client-token': clientToken,\n                'data-namespace': 'paypalGooglePay',\n            },\n        };\n    }\n\n    private getPayPalApmSdkConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const {\n            intent,\n            clientId,\n            merchantId,\n            buyerCountry,\n            attributionId,\n            isDeveloperModeApplicable,\n            availableAlternativePaymentMethods = [],\n            enabledAlternativePaymentMethods = [],\n        } = initializationData;\n\n        const enableAPMsFunding = this.filterFundingOptions(enabledAlternativePaymentMethods);\n        const disableAPMsFunding = this.filterFundingOptions(\n            availableAlternativePaymentMethods.filter(\n                (apm: string) => !enabledAlternativePaymentMethods.includes(apm),\n            ),\n        );\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                'enable-funding': enableAPMsFunding.length > 0 ? enableAPMsFunding : undefined,\n                'disable-funding': disableAPMsFunding.length > 0 ? disableAPMsFunding : undefined,\n                commit: true,\n                components: ['buttons', 'payment-fields'],\n                currency: currencyCode,\n                intent,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-partner-attribution-id': attributionId,\n                'data-namespace': 'paypalApms',\n            },\n        };\n    }\n\n    private getPayPalSdkMessagesConfiguration(\n        paymentMethod: PaymentMethod<BigCommercePaymentsInitializationData>,\n        currencyCode: string,\n    ): PayPalSdkConfig {\n        const { initializationData } = paymentMethod;\n\n        if (!initializationData || !initializationData.clientId) {\n            throw new MissingDataError(MissingDataErrorType.MissingPaymentMethod);\n        }\n\n        const { clientId, merchantId, attributionId, isDeveloperModeApplicable, buyerCountry } =\n            initializationData;\n\n        return {\n            options: {\n                'client-id': clientId,\n                'merchant-id': merchantId,\n                components: ['messages'],\n                currency: currencyCode,\n                ...(isDeveloperModeApplicable && { 'buyer-country': buyerCountry }),\n            },\n            attributes: {\n                'data-namespace': 'paypalMessages',\n                'data-partner-attribution-id': attributionId,\n            },\n        };\n    }\n\n    /**\n     *\n     * Utils methods\n     *\n     */\n    private filterFundingOptions(fundingOptions: FundingType[] | undefined): FundingType[] {\n        const fundingTypesToBeFiltered = ['klarna', 'afterpay'];\n\n        if (!fundingOptions) {\n            return [];\n        }\n\n        return fundingOptions.filter(\n            (fundingOption: FundingType) => !fundingTypesToBeFiltered.includes(fundingOption),\n        );\n    }\n\n    private transformConfig<T extends Record<string, unknown>>(config: T): Record<string, string> {\n        let transformedConfig = {};\n\n        const keys = Object.keys(config) as Array<keyof T>;\n\n        keys.forEach((key) => {\n            const value = config[key];\n\n            if (\n                value === undefined ||\n                value === null ||\n                value === '' ||\n                (Array.isArray(value) && value.length === 0)\n            ) {\n                return;\n            }\n\n            transformedConfig = {\n                ...transformedConfig,\n                [key]: Array.isArray(value) ? value.join(',') : value,\n            };\n        });\n\n        return transformedConfig;\n    }\n}\n","import { createScriptLoader } from '@bigcommerce/script-loader';\n\nimport PayPalSdkHelper from './paypal-sdk-helper';\n\nexport default function createBigCommercePaymentsSdk(): PayPalSdkHelper {\n    return new PayPalSdkHelper(createScriptLoader());\n}\n","interface CookieOptions {\n    expires?: Date;\n    path?: string;\n    domain?: string;\n    secure?: boolean;\n}\n\nexport default class CookieStorage {\n    static get(name: string): string | null {\n        const cookieKey = `${encodeURIComponent(`${name}`)}=`;\n        const cookie = document.cookie;\n\n        let value = null;\n\n        const firstIndex = cookie.indexOf(cookieKey);\n\n        if (firstIndex > -1) {\n            let lastIndex = cookie.indexOf(';', firstIndex);\n\n            if (lastIndex === -1) {\n                lastIndex = cookie.length;\n            }\n\n            value = decodeURIComponent(cookie.substring(firstIndex + cookieKey.length, lastIndex));\n        }\n\n        return value;\n    }\n\n    static set(name: string, value: string, options: CookieOptions = { secure: true }) {\n        let cookieText = `${encodeURIComponent(name)}=${encodeURIComponent(value)}`;\n\n        const { expires, path, domain, secure } = options;\n\n        if (expires) {\n            cookieText += `; expires=${expires.toUTCString()}`;\n        } else {\n            const now = new Date();\n            // info: default cookie expiration time after setup\n            const minutes = 60;\n\n            now.setTime(now.getTime() + minutes * 60 * 1000);\n\n            cookieText += `; expires=${now.toUTCString()}`;\n        }\n\n        if (path) {\n            cookieText += `; path=${path}`;\n        }\n\n        if (domain) {\n            cookieText += `; domain=${domain}`;\n        }\n\n        if (secure) {\n            cookieText += '; secure';\n        }\n\n        document.cookie = cookieText;\n    }\n\n    static remove(name: string, options?: CookieOptions) {\n        CookieStorage.set(name, '', { expires: new Date(0), ...options });\n    }\n}\n","import { isEqual, omit } from 'lodash';\n\nimport {\n    Address,\n    CardInstrument,\n    CustomerAddress,\n    PaymentMethodClientUnavailableError,\n    UntrustedShippingCardVerificationType,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { CookieStorage } from '@bigcommerce/checkout-sdk/storage';\n\nimport {\n    PayPalFastlane,\n    PayPalFastlaneAddress,\n    PayPalFastlaneAuthenticationResult,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneLookupCustomerByEmailResult,\n    PayPalFastlaneProfileCard,\n    PayPalFastlaneProfileName,\n    PayPalFastlaneProfilePhone,\n    PayPalFastlaneProfileToBcCustomerDataMappingResult,\n    PayPalFastlaneSdk,\n    PayPalFastlaneStylesOption,\n    PayPalHostWindow,\n} from './bigcommerce-payments-types';\n\nexport default class BigCommercePaymentsFastlaneUtils {\n    private window: PayPalHostWindow;\n\n    constructor() {\n        this.window = window;\n    }\n\n    async initializePayPalFastlane(\n        paypalFastlaneSdk: PayPalFastlaneSdk,\n        isTestModeEnabled: boolean,\n        styles?: PayPalFastlaneStylesOption,\n    ): Promise<PayPalFastlane> {\n        if (isTestModeEnabled) {\n            window.localStorage.setItem('fastlaneEnv', 'sandbox');\n            window.localStorage.setItem('axoEnv', 'sandbox'); // TODO: remove if this key does not use on PayPal side\n        }\n\n        if (!this.window.paypalFastlane) {\n            const defaultStyles = {\n                root: {\n                    backgroundColorPrimary: 'transparent',\n                },\n            };\n\n            this.window.paypalFastlane = await paypalFastlaneSdk.Fastlane({\n                styles: styles || defaultStyles,\n            });\n        }\n\n        return this.window.paypalFastlane;\n    }\n\n    getPayPalFastlaneOrThrow(): PayPalFastlane {\n        if (!this.window.paypalFastlane) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.window.paypalFastlane;\n    }\n\n    /**\n     *\n     * Detects the customer to PayPal Fastlane relation and\n     * returns customerContextId to use it for authentication\n     *\n     */\n    async lookupCustomerOrThrow(email: string): Promise<PayPalFastlaneLookupCustomerByEmailResult> {\n        const paypalFastlane = this.getPayPalFastlaneOrThrow();\n\n        return paypalFastlane.identity.lookupCustomerByEmail(email);\n    }\n\n    /**\n     *\n     * Triggers authentication flow (shows OTP popup) if the customer recognised as PayPal Fastlane user\n     * and returns PayPal Fastlane Profile data to use it in BC checkout\n     *\n     */\n    async triggerAuthenticationFlowOrThrow(\n        customerContextId?: string,\n    ): Promise<PayPalFastlaneAuthenticationResult> {\n        if (!customerContextId) {\n            return {};\n        }\n\n        const paypalFastlane = this.getPayPalFastlaneOrThrow();\n\n        return paypalFastlane.identity.triggerAuthenticationFlow(customerContextId);\n    }\n\n    /**\n     *\n     * 'updateStorageSessionId' method is used to:\n     * - set session id after user was authenticated (or unrecognised) to trigger authentication after page refresh\n     *\n     * Flow info:\n     * If user unrecognised then the lookup method will be working but the OTP will not be shown\n     * If user recognised and not canceled then the lookup method will be working and the OTP will be shown only if needed\n     * If user cancels the OPT then OTP will not be triggered after page refresh\n     *\n     */\n    updateStorageSessionId(sessionId: string): void {\n        const expires = new Date();\n\n        expires.setDate(expires.getDate() + 14); // 2 weeks expiry\n\n        const cookiesOption = {\n            expires,\n            secure: true,\n        };\n\n        CookieStorage.set('bc-fastlane-sessionId', sessionId, cookiesOption);\n    }\n\n    removeStorageSessionId(): void {\n        CookieStorage.remove('bc-fastlane-sessionId');\n    }\n\n    getStorageSessionId(): string {\n        return CookieStorage.get('bc-fastlane-sessionId') || '';\n    }\n\n    /**\n     *\n     * 'mapPayPalFastlaneProfileToBcCustomerData' method is responsible for:\n     * - mapping PayPal Fastlane Profile data to BC data shape\n     * - returning mapped data to use for updating PaymentProviderCustomer state and\n     * update shipping and billing addresses\n     *\n     */\n    mapPayPalFastlaneProfileToBcCustomerData(\n        methodId: string,\n        authenticationResult: PayPalFastlaneAuthenticationResult,\n    ): PayPalFastlaneProfileToBcCustomerDataMappingResult {\n        const { authenticationState, profileData } = authenticationResult;\n\n        const paypalBillingAddress = profileData?.card?.paymentSource?.card?.billingAddress;\n        const paypalShippingAddress = profileData?.shippingAddress;\n        const paypalProfileName = profileData?.name;\n        const paypalInstrument = profileData?.card;\n\n        const shippingAddress = paypalShippingAddress\n            ? this.mapPayPalToBcAddress(\n                  paypalShippingAddress.address,\n                  paypalShippingAddress.name,\n                  paypalShippingAddress.phoneNumber,\n              )\n            : undefined;\n        const billingAddress =\n            paypalBillingAddress && paypalProfileName\n                ? this.mapPayPalToBcAddress(\n                      paypalBillingAddress,\n                      paypalProfileName,\n                      paypalShippingAddress?.phoneNumber,\n                  )\n                : undefined;\n        const instruments = paypalInstrument\n            ? this.mapPayPalToBcInstrument(methodId, paypalInstrument)\n            : [];\n\n        const addresses = this.filterAddresses([shippingAddress, billingAddress]);\n\n        return {\n            authenticationState:\n                authenticationState || PayPalFastlaneAuthenticationState.UNRECOGNIZED,\n            addresses,\n            billingAddress,\n            shippingAddress,\n            instruments,\n        };\n    }\n\n    mapPayPalToBcInstrument(\n        methodId: string,\n        instrument: PayPalFastlaneProfileCard,\n    ): CardInstrument[] {\n        const { id, paymentSource } = instrument;\n        const { brand, expiry, lastDigits } = paymentSource.card;\n\n        const [expiryYear, expiryMonth] = expiry.split('-');\n\n        return [\n            {\n                bigpayToken: id,\n                brand,\n                defaultInstrument: false,\n                expiryMonth,\n                expiryYear,\n                iin: '',\n                last4: lastDigits,\n                method: methodId,\n                provider: methodId,\n                trustedShippingAddress: false,\n                untrustedShippingCardVerificationMode: UntrustedShippingCardVerificationType.PAN,\n                type: 'card',\n            },\n        ];\n    }\n\n    mapBcToPayPalAddress(address?: Address): PayPalFastlaneAddress {\n        return {\n            company: address?.company || '',\n            addressLine1: address?.address1 || '',\n            addressLine2: address?.address2 || '',\n            adminArea1: address?.stateOrProvinceCode || address?.stateOrProvince || '',\n            adminArea2: address?.city || '',\n            postalCode: address?.postalCode || '',\n            countryCode: address?.countryCode || '',\n        };\n    }\n\n    mapPayPalToBcAddress(\n        address: PayPalFastlaneAddress,\n        profileName: PayPalFastlaneProfileName,\n        phone?: PayPalFastlaneProfilePhone,\n        customFields?: CustomerAddress['customFields'],\n    ): CustomerAddress {\n        const [firstName, lastName] = profileName.fullName.split(' ');\n\n        const phoneData = {\n            nationalNumber: phone?.nationalNumber || '',\n            countryCode: phone?.countryCode || '',\n        };\n\n        return {\n            id: Date.now(),\n            type: 'paypal-address',\n            firstName: profileName.firstName || firstName || '',\n            lastName: profileName.lastName || lastName || '',\n            company: address.company || '',\n            address1: address.addressLine1,\n            address2: address.addressLine2 || '',\n            city: address.adminArea2,\n            stateOrProvince: address.adminArea1,\n            stateOrProvinceCode: address.adminArea1,\n            country: address.countryCode || '', // TODO: update country with valid naming\n            countryCode: address.countryCode || '',\n            postalCode: address.postalCode,\n            phone: phoneData.countryCode + phoneData.nationalNumber,\n            customFields: customFields || [],\n        };\n    }\n\n    /**\n     *\n     * This method is responsible for filtering PayPal Fastlane addresses if they are the same\n     * and returns an array of addresses to use them for shipping and/or billing address selections\n     * so the customer will be able to use addresses from PayPal Fastlane in checkout flow\n     *\n     */\n    filterAddresses(addresses: Array<CustomerAddress | undefined>): CustomerAddress[] {\n        return addresses.reduce(\n            (customerAddresses: CustomerAddress[], currentAddress: CustomerAddress | undefined) => {\n                if (!currentAddress) {\n                    return customerAddresses;\n                }\n\n                const sameAddressInTheArray = customerAddresses.some((customerAddress) =>\n                    this.isEqualAddresses(customerAddress, currentAddress),\n                );\n\n                return sameAddressInTheArray\n                    ? customerAddresses\n                    : [...customerAddresses, currentAddress];\n            },\n            [],\n        );\n    }\n\n    private isEqualAddresses(\n        firstAddress: CustomerAddress,\n        secondAddress: CustomerAddress,\n    ): boolean {\n        return isEqual(this.normalizeAddress(firstAddress), this.normalizeAddress(secondAddress));\n    }\n\n    private normalizeAddress(address: CustomerAddress) {\n        return omit(address, ['id', 'phone']);\n    }\n}\n","import BigCommercePaymentsFastlaneUtils from './bigcommerce-payments-fastlane-utils';\n\nexport default function createBigCommercePaymentsFastlaneUtils(): BigCommercePaymentsFastlaneUtils {\n    return new BigCommercePaymentsFastlaneUtils();\n}\n","import { omitBy } from 'lodash';\n\nimport { FastlaneStylesSettings, PayPalFastlaneStylesOption } from '../index';\n\nfunction isInvalidStyleOption(styleOption: unknown) {\n    return typeof styleOption !== 'string';\n}\n\nexport default function getFastlaneStyles(\n    styleSettings?: FastlaneStylesSettings,\n    uiStyles?: PayPalFastlaneStylesOption,\n) {\n    if (!uiStyles && !styleSettings) {\n        return undefined;\n    }\n\n    return cleanUpFastlaneStyles(mergeFastlaneStyles(styleSettings, uiStyles));\n}\n\nfunction mergeFastlaneStyles(\n    styleSettings?: FastlaneStylesSettings,\n    uiStyles?: PayPalFastlaneStylesOption,\n): PayPalFastlaneStylesOption {\n    return {\n        root: {\n            backgroundColorPrimary:\n                styleSettings?.fastlaneRootSettingsBackgroundColor ||\n                uiStyles?.root?.backgroundColorPrimary,\n            errorColor: styleSettings?.fastlaneRootSettingsErrorColor || uiStyles?.root?.errorColor,\n            fontFamily: styleSettings?.fastlaneRootSettingsFontFamily || uiStyles?.root?.fontFamily,\n            fontSizeBase:\n                styleSettings?.fastlaneRootSettingsFontSize || uiStyles?.root?.fontSizeBase,\n            padding: styleSettings?.fastlaneRootSettingsPadding || uiStyles?.root?.padding,\n            primaryColor:\n                styleSettings?.fastlaneRootSettingsPrimaryColor || uiStyles?.root?.primaryColor,\n        },\n        input: {\n            borderRadius:\n                styleSettings?.fastlaneInputSettingsBorderRadius || uiStyles?.input?.borderRadius,\n            borderColor:\n                styleSettings?.fastlaneInputSettingsBorderColor || uiStyles?.input?.borderColor,\n            focusBorderColor:\n                styleSettings?.fastlaneInputSettingsFocusBorderBase ||\n                uiStyles?.input?.focusBorderColor,\n            backgroundColor:\n                styleSettings?.fastlaneInputSettingsBackgroundColor ||\n                uiStyles?.input?.backgroundColor,\n            borderWidth:\n                styleSettings?.fastlaneInputSettingsBorderWidth || uiStyles?.input?.borderWidth,\n            textColorBase:\n                styleSettings?.fastlaneInputSettingsTextColorBase || uiStyles?.input?.textColorBase,\n        },\n        toggle: {\n            colorPrimary:\n                styleSettings?.fastlaneToggleSettingsColorPrimary || uiStyles?.toggle?.colorPrimary,\n            colorSecondary:\n                styleSettings?.fastlaneToggleSettingsColorSecondary ||\n                uiStyles?.toggle?.colorSecondary,\n        },\n        text: {\n            body: {\n                color: styleSettings?.fastlaneTextBodySettingsColor || uiStyles?.text?.body?.color,\n                fontSize:\n                    styleSettings?.fastlaneTextBodySettingsFontSize ||\n                    uiStyles?.text?.body?.fontSize,\n            },\n            caption: {\n                color:\n                    styleSettings?.fastlaneTextCaptionSettingsColor ||\n                    uiStyles?.text?.caption?.color,\n                fontSize:\n                    styleSettings?.fastlaneTextCaptionSettingsFontSize ||\n                    uiStyles?.text?.caption?.fontSize,\n            },\n        },\n        branding: styleSettings?.fastlaneBrandingSettings || uiStyles?.branding,\n    };\n}\n\nfunction cleanUpFastlaneStyles(styles: PayPalFastlaneStylesOption) {\n    const fastlaneStyles: PayPalFastlaneStylesOption = {};\n\n    const root = omitBy(styles.root, isInvalidStyleOption);\n    const input = omitBy(styles.input, isInvalidStyleOption);\n    const toggle = omitBy(styles.toggle, isInvalidStyleOption);\n    const textBody = omitBy(styles.text?.body, isInvalidStyleOption);\n    const textCaption = omitBy(styles.text?.caption, isInvalidStyleOption);\n    const branding = styles.branding;\n\n    if (Object.keys(root).length) {\n        fastlaneStyles.root = root;\n    }\n\n    if (Object.keys(input).length) {\n        fastlaneStyles.input = input;\n    }\n\n    if (Object.keys(toggle).length) {\n        fastlaneStyles.toggle = toggle;\n    }\n\n    if (Object.keys(textBody).length) {\n        fastlaneStyles.text = {};\n        fastlaneStyles.text.body = textBody;\n    }\n\n    if (Object.keys(textCaption).length) {\n        fastlaneStyles.text = {\n            ...fastlaneStyles.text,\n        };\n        fastlaneStyles.text.caption = textCaption;\n    }\n\n    if (branding) {\n        fastlaneStyles.branding = branding;\n    }\n\n    return fastlaneStyles;\n}\n","import {\n    BigCommercePaymentsFastlaneUtils,\n    BigCommercePaymentsInitializationData,\n    getFastlaneStyles,\n    PayPalFastlaneAuthenticationResult,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneStylesOption,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsFastlaneCustomerInitializeOptions, {\n    WithBigCommercePaymentsFastlaneCustomerInitializeOptions,\n} from './bigcommerce-payments-fastlane-customer-initialize-options';\n\nexport default class BigCommercePaymentsFastlaneCustomerStrategy implements CustomerStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsSdk: PayPalSdkHelper,\n        private bigCommercePaymentsFastlaneUtils: BigCommercePaymentsFastlaneUtils,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions &\n            WithBigCommercePaymentsFastlaneCustomerInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments_fastlane } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" argument is not provided.',\n            );\n        }\n\n        try {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const paymentMethod =\n                state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n            const isTestModeEnabled = !!paymentMethod.initializationData?.isDeveloperModeApplicable;\n\n            const paypalFastlaneSdk = await this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(\n                paymentMethod,\n                cart.currency.code,\n                cart.id,\n            );\n\n            await this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(\n                paypalFastlaneSdk,\n                isTestModeEnabled,\n                this.getFastlaneStyles(methodId, bigcommerce_payments_fastlane),\n            );\n        } catch (_) {\n            // TODO: add logger to be able to debug issues if there any\n            // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n        }\n\n        return Promise.resolve();\n    }\n\n    async deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    async executePaymentMethodCheckout(\n        options?: ExecutePaymentMethodCheckoutOptions,\n    ): Promise<void> {\n        const { checkoutPaymentMethodExecuted, continueWithCheckoutCallback, methodId } =\n            options || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"methodId\" argument is not provided.',\n            );\n        }\n\n        if (typeof continueWithCheckoutCallback !== 'function') {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"continueWithCheckoutCallback\" argument is not provided and it must be a function.',\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const customer = state.getCustomerOrThrow();\n\n        if (customer.isGuest) {\n            if (\n                checkoutPaymentMethodExecuted &&\n                typeof checkoutPaymentMethodExecuted === 'function'\n            ) {\n                checkoutPaymentMethodExecuted();\n            }\n\n            try {\n                await this.runPayPalAuthenticationFlowOrThrow(methodId);\n            } catch (_) {\n                // TODO: add logger to be able to debug issues if there any\n                // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n            }\n        }\n\n        continueWithCheckoutCallback();\n    }\n\n    /**\n     *\n     * Authentication flow methods\n     *\n     */\n    private async runPayPalAuthenticationFlowOrThrow(methodId: string): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n        const customer = state.getCustomer();\n        const billingAddress = state.getBillingAddress();\n        const customerEmail = customer?.email || billingAddress?.email || '';\n\n        const { customerContextId } =\n            await this.bigCommercePaymentsFastlaneUtils.lookupCustomerOrThrow(customerEmail);\n\n        const authenticationResult =\n            await this.bigCommercePaymentsFastlaneUtils.triggerAuthenticationFlowOrThrow(\n                customerContextId,\n            );\n\n        const isAuthenticationFlowCanceled =\n            authenticationResult.authenticationState === PayPalFastlaneAuthenticationState.CANCELED;\n\n        await this.updateCustomerDataState(methodId, authenticationResult);\n\n        if (isAuthenticationFlowCanceled) {\n            this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId();\n        } else {\n            this.bigCommercePaymentsFastlaneUtils.updateStorageSessionId(cartId);\n        }\n    }\n\n    private async updateCustomerDataState(\n        methodId: string,\n        authenticationResult: PayPalFastlaneAuthenticationResult,\n    ): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n\n        const { authenticationState, addresses, billingAddress, shippingAddress, instruments } =\n            this.bigCommercePaymentsFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(\n                methodId,\n                authenticationResult,\n            );\n\n        await this.paymentIntegrationService.updatePaymentProviderCustomer({\n            authenticationState,\n            addresses,\n            instruments,\n        });\n\n        if (billingAddress) {\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n        }\n\n        if (shippingAddress && cart.lineItems.physicalItems.length > 0) {\n            const updatedState = await this.paymentIntegrationService.updateShippingAddress(\n                shippingAddress,\n            );\n\n            const paymentMethod =\n                updatedState.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(\n                    methodId,\n                );\n            const { isFastlaneShippingOptionAutoSelectEnabled } =\n                paymentMethod.initializationData || {};\n            const consignments = updatedState.getConsignments() || [];\n            const availableShippingOptions = consignments[0]?.availableShippingOptions || [];\n            const firstShippingOption = availableShippingOptions[0];\n            const recommendedShippingOption = availableShippingOptions.find(\n                (option) => option.isRecommended,\n            );\n\n            if (\n                (recommendedShippingOption || firstShippingOption) &&\n                isFastlaneShippingOptionAutoSelectEnabled\n            ) {\n                const shippingOptionId = recommendedShippingOption?.id || firstShippingOption.id;\n\n                await this.paymentIntegrationService.selectShippingOption(shippingOptionId);\n            }\n        }\n    }\n\n    /**\n     *\n     * Fastlane styling methods\n     *\n     */\n    private getFastlaneStyles(\n        methodId: string,\n        bigcommerce_payments_fastlane:\n            | BigCommercePaymentsFastlaneCustomerInitializeOptions\n            | undefined,\n    ): PayPalFastlaneStylesOption | undefined {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        const { fastlaneStyles, isFastlaneStylingEnabled } = paymentMethod.initializationData || {};\n\n        return getFastlaneStyles(\n            isFastlaneStylingEnabled ? fastlaneStyles : {},\n            bigcommerce_payments_fastlane?.styles,\n        );\n    }\n}\n","import {\n    createBigCommercePaymentsFastlaneUtils,\n    createBigCommercePaymentsSdk,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsFastlaneCustomerStrategy from './bigcommerce-payments-fastlane-customer-strategy';\n\nconst createBigCommercePaymentsFastlaneCustomerStrategy: CustomerStrategyFactory<\n    BigCommercePaymentsFastlaneCustomerStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsFastlaneCustomerStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsSdk(),\n        createBigCommercePaymentsFastlaneUtils(),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsFastlaneCustomerStrategy, [\n    { id: 'bigcommerce_payments_fastlane' }, // this method id will be provided for users from test group\n    { id: 'bigcommerce_payments_creditcards' }, // this method id will be provided for users from control group\n]);\n","import { noop } from 'lodash';\n\nimport {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsPayLaterCustomerInitializeOptions, {\n    WithBigCommercePaymentsPayLaterCustomerInitializeOptions,\n} from './bigcommerce-payments-paylater-customer-initialize-options';\n\nexport default class BigCommercePaymentsPayLaterCustomerStrategy implements CustomerStrategy {\n    private onError = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions &\n            WithBigCommercePaymentsPayLaterCustomerInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments_paylater, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_paylater) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_paylater.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_paylater.container\" argument is not provided.',\n            );\n        }\n\n        if (\n            bigcommerce_payments_paylater.onClick &&\n            typeof bigcommerce_payments_paylater.onClick !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_paylater.onClick\" argument is not a function.',\n            );\n        }\n\n        this.onError = bigcommerce_payments_paylater.onError || noop;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            // eslint-disable-next-line no-console\n            console.error(\n                '[BC BigCommercePayments PayLater]: button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, bigcommerce_payments_paylater);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        bigCommercePaymentsPayLater: BigCommercePaymentsPayLaterCustomerInitializeOptions,\n    ): void {\n        const { container, onComplete, onClick } = bigCommercePaymentsPayLater;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, paymentButtonStyles } =\n            paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder(\n                    'bigcommerce_payments_paylater',\n                ),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const hostedCheckoutCallbacks = {\n            onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                this.onShippingAddressChange(data),\n            onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                this.onShippingOptionsChange(data),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const fundingSources = [paypalSdk.FUNDING.PAYLATER, paypalSdk.FUNDING.CREDIT];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (!hasRenderedSmartButton) {\n                const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n                    fundingSource,\n                    style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle({\n                        ...checkoutTopButtonStyles,\n                        height: DefaultCheckoutButtonHeight,\n                    }),\n                    ...defaultCallbacks,\n                    ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n                };\n\n                const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n                if (paypalButton.isEligible()) {\n                    paypalButton.render(`#${container}`);\n                    hasRenderedSmartButton = true;\n                }\n            }\n        });\n\n        if (!hasRenderedSmartButton) {\n            this.bigCommercePaymentsIntegrationService.removeElement(container);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<void> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const cart = this.paymentIntegrationService.getState().getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.bigCommercePaymentsIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.bigCommercePaymentsIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.bigCommercePaymentsIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address except shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption =\n                this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            this.handleError(error);\n        }\n    }\n\n    private handleError(error: unknown) {\n        if (typeof this.onError === 'function') {\n            this.onError(error);\n        } else {\n            throw error;\n        }\n    }\n}\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsPayLaterCustomerStrategy from './bigcommerce-payments-paylater-customer-strategy';\n\nconst createBigCommercePaymentsPayLaterCustomerStrategy: CustomerStrategyFactory<\n    BigCommercePaymentsPayLaterCustomerStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsPayLaterCustomerStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsPayLaterCustomerStrategy, [\n    { id: 'bigcommerce_payments_paylater' },\n]);\n","import {\n    CustomerCredentials,\n    CustomerInitializeOptions,\n    CustomerStrategy,\n    DefaultCheckoutButtonHeight,\n    ExecutePaymentMethodCheckoutOptions,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n    RequestOptions,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsVenmoCustomerInitializeOptions, {\n    WithBigCommercePaymentsVenmoCustomerInitializeOptions,\n} from './bigcommerce-payments-venmo-customer-initialize-options';\n\nexport default class BigCommercePaymentsVenmoCustomerStrategy implements CustomerStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CustomerInitializeOptions & WithBigCommercePaymentsVenmoCustomerInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments_venmo, methodId } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_venmo) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_venmo.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_venmo.container\" argument is not provided.',\n            );\n        }\n\n        if (\n            bigcommerce_payments_venmo.onClick &&\n            typeof bigcommerce_payments_venmo.onClick !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_venmo.onClick\" argument is not a function.',\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethod(methodId);\n\n        if (!paymentMethod) {\n            await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        }\n\n        const paypalSdk = await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        if (!paypalSdk || !paypalSdk.Buttons || typeof paypalSdk.Buttons !== 'function') {\n            // eslint-disable-next-line no-console\n            console.error(\n                '[BC Payments Venmo]: Button could not be rendered, due to issues with loading PayPal SDK',\n            );\n\n            return;\n        }\n\n        this.renderButton(methodId, bigcommerce_payments_venmo);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    async signIn(credentials: CustomerCredentials, options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signInCustomer(credentials, options);\n    }\n\n    async signOut(options?: RequestOptions): Promise<void> {\n        await this.paymentIntegrationService.signOutCustomer(options);\n    }\n\n    executePaymentMethodCheckout(options?: ExecutePaymentMethodCheckoutOptions): Promise<void> {\n        options?.continueWithCheckoutCallback?.();\n\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        methodId: string,\n        bigcommerce_payments_venmo: BigCommercePaymentsVenmoCustomerInitializeOptions,\n    ): void {\n        const { container, onClick } = bigcommerce_payments_venmo;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutTopButtonStyles } = paymentButtonStyles || {};\n\n        const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.VENMO,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle({\n                ...checkoutTopButtonStyles,\n                height: DefaultCheckoutButtonHeight,\n            }),\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder(\n                    'bigcommerce_payments_venmo',\n                ),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n            ...(onClick && { onClick: () => onClick() }),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${container}`);\n        } else {\n            this.bigCommercePaymentsIntegrationService.removeElement(container);\n        }\n    }\n}\n","import {\n    CustomerStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsVenmoCustomerStrategy from './bigcommerce-payments-venmo-customer-strategy';\n\nconst createBigCommercePaymentsVenmoCustomerStrategy: CustomerStrategyFactory<\n    BigCommercePaymentsVenmoCustomerStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsVenmoCustomerStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsVenmoCustomerStrategy, [\n    { id: 'bigcommerce_payments_venmo' },\n]);\n","import {\n    LoadingIndicatorContainerStyles,\n    LoadingIndicatorStyles,\n} from './loading-indicator-styles';\n\nconst DEFAULT_STYLES: LoadingIndicatorStyles = {\n    size: 70,\n    color: '#d9d9d9',\n    backgroundColor: '#ffffff',\n};\n\nexport const DEFAULT_CONTAINER_STYLES = {\n    position: 'fixed',\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n\nconst ROTATION_ANIMATION = 'embedded-checkout-loading-indicator-rotation';\n\ninterface LoadingIndicatorOptions {\n    styles?: LoadingIndicatorStyles;\n    containerStyles?: LoadingIndicatorContainerStyles;\n}\n\nexport default class LoadingIndicator {\n    private container: HTMLElement;\n    private indicator: HTMLElement;\n    private styles: LoadingIndicatorStyles;\n    private containerStyles: LoadingIndicatorContainerStyles;\n\n    constructor(options?: LoadingIndicatorOptions) {\n        this.styles = { ...DEFAULT_STYLES, ...(options && options.styles) };\n        this.containerStyles = { ...(options && options.containerStyles) };\n\n        this.defineAnimation();\n\n        this.container = this.buildContainer();\n        this.indicator = this.buildIndicator();\n\n        this.container.appendChild(this.indicator);\n    }\n\n    show(parentId?: string): void {\n        if (parentId) {\n            const parent = document.getElementById(parentId);\n\n            if (!parent) {\n                throw new Error(\n                    'Unable to attach the loading indicator because the parent ID is not valid.',\n                );\n            }\n\n            parent.appendChild(this.container);\n        }\n\n        this.container.style.visibility = 'visible';\n        this.container.style.opacity = '1';\n    }\n\n    hide(): void {\n        const handleTransitionEnd = () => {\n            this.container.style.visibility = 'hidden';\n\n            this.container.removeEventListener('transitionend', handleTransitionEnd);\n        };\n\n        this.container.addEventListener('transitionend', handleTransitionEnd);\n\n        this.container.style.opacity = '0';\n    }\n\n    private buildContainer(): HTMLElement {\n        const container = document.createElement('div');\n\n        container.style.display = 'block';\n        container.style.bottom = '0';\n        container.style.left = '0';\n        container.style.height = '100%';\n        container.style.width = '100%';\n        container.style.position = 'absolute';\n        container.style.right = '0';\n        container.style.top = '0';\n        container.style.transition = 'all 250ms ease-out';\n        container.style.opacity = '0';\n\n        this.setStyleAttribute(container, this.containerStyles);\n\n        return container;\n    }\n\n    private buildIndicator(): HTMLElement {\n        const indicator = document.createElement('div');\n\n        indicator.style.display = 'block';\n        indicator.style.width = `${this.styles.size}px`;\n        indicator.style.height = `${this.styles.size}px`;\n        indicator.style.borderRadius = `${this.styles.size}px`;\n        indicator.style.border = 'solid 1px';\n        indicator.style.borderColor = `${this.styles.backgroundColor} ${this.styles.backgroundColor} ${this.styles.color} ${this.styles.color}`;\n        indicator.style.margin = '0 auto';\n        indicator.style.position = 'absolute';\n        indicator.style.left = '0';\n        indicator.style.right = '0';\n        indicator.style.top = '50%';\n        indicator.style.transform = 'translateY(-50%) rotate(0deg)';\n        indicator.style.transformStyle = 'preserve-3d';\n        indicator.style.animation = `${ROTATION_ANIMATION} 500ms infinite cubic-bezier(0.69, 0.31, 0.56, 0.83)`;\n\n        return indicator;\n    }\n\n    private setStyleAttribute(element: HTMLElement, attrs: { [key: string]: string }): void {\n        Object.keys(attrs).forEach((k) => {\n            element.style.setProperty(k, attrs[k]);\n        });\n    }\n\n    private defineAnimation(): void {\n        // In order to define CSS animation, we need to insert a stylesheet into the host frame.\n        // We only have to do it once.\n        if (document.getElementById(ROTATION_ANIMATION)) {\n            return;\n        }\n\n        const style = document.createElement('style');\n\n        style.id = ROTATION_ANIMATION;\n\n        // eslint-disable-next-line @typescript-eslint/no-unnecessary-condition\n        document.head?.appendChild(style);\n\n        if (style.sheet instanceof CSSStyleSheet) {\n            // We need to provide the 2nd parameter for IE11, even though it is\n            // 0 by default for all other browsers.\n            style.sheet.insertRule(\n                `\n                @keyframes ${ROTATION_ANIMATION} {\n                    0% { transform: translateY(-50%) rotate(0deg); }\n                    100% { transform: translateY(-50%) rotate(360deg); }\n                }\n            `,\n                0,\n            );\n        }\n    }\n}\n","export const LOADING_INDICATOR_STYLES = {\n    'background-color': 'rgba(0, 0, 0, 0.4)',\n    'z-index': '1000',\n};\n","import { MessagesStyleOptions, PayPalBNPLConfigurationItem } from '../bigcommerce-payments-types';\n\nfunction getPaypalMessagesStylesFromBNPLConfig({\n    styles,\n}: PayPalBNPLConfigurationItem): MessagesStyleOptions {\n    const messagesStyles: MessagesStyleOptions = {};\n\n    if (styles.color) {\n        messagesStyles.color = styles.color;\n    }\n\n    if (styles.layout) {\n        messagesStyles.layout = styles.layout;\n    }\n\n    if (styles['logo-type'] || styles['logo-position']) {\n        messagesStyles.logo = {};\n\n        if (styles['logo-type']) {\n            messagesStyles.logo.type = styles['logo-type'];\n        }\n\n        if (styles['logo-position']) {\n            messagesStyles.logo.position = styles['logo-position'];\n        }\n    }\n\n    if (styles.ratio) {\n        messagesStyles.ratio = styles.ratio;\n    }\n\n    if (styles['text-color'] || styles['text-size']) {\n        messagesStyles.text = {};\n\n        if (styles['text-color']) {\n            messagesStyles.text.color = styles['text-color'];\n        }\n\n        if (styles['text-size']) {\n            messagesStyles.text.size = +styles['text-size'];\n        }\n    }\n\n    return messagesStyles;\n}\n\nexport default getPaypalMessagesStylesFromBNPLConfig;\n","import InvalidArgumentError from './invalid-argument-error';\n\n/**\n * This error should be thrown when we are unable to submit a payment because\n * the caller has not provided all the required fields, i.e.: if an argument is\n * missing or it is not the expected data type.\n */\nexport default class PaymentArgumentInvalidError extends InvalidArgumentError {\n    constructor(invalidFields?: string[]) {\n        let message = 'Unable to submit payment for the order because the payload is invalid.';\n\n        if (invalidFields) {\n            message = `${message} Make sure the following fields are provided correctly: ${invalidFields.join(\n                ', ',\n            )}.`;\n        }\n\n        super(message);\n\n        this.name = 'PaymentArgumentInvalidError';\n    }\n}\n","import { Response } from '@bigcommerce/request-sender';\n\nimport RequestError from './request-error';\n\n/**\n * Throw this error if we are unable to successfully submit a server request\n * using a payment method because the method has invalid configuration or is in\n * an invalid state.\n */\nexport default class PaymentMethodInvalidError<T = any> extends RequestError<T> {\n    constructor(response?: Response<T>) {\n        super(response, {\n            message: 'There is a problem processing your payment. Please try again later.',\n        });\n\n        this.name = 'PaymentMethodInvalidError';\n        this.type = 'payment_method_invalid';\n    }\n}\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we are trying to make an order finalization request for a\n * payment method that does not require such procedure.\n */\nexport default class OrderFinalizationNotRequiredError extends StandardError {\n    constructor() {\n        super('The current order does not need to be finalized at this stage.');\n\n        this.name = 'OrderFinalizationNotRequiredError';\n        this.type = 'order_finalization_not_required';\n    }\n}\n","import { HostedInstrument } from './payment';\n\nexport default function isHostedInstrumentLike(\n    instrument: unknown,\n): instrument is HostedInstrument {\n    return (\n        typeof instrument === 'object' &&\n        instrument !== null &&\n        (typeof (instrument as HostedInstrument).shouldSaveInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSaveInstrument === 'boolean') &&\n        (typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'undefined' ||\n            typeof (instrument as HostedInstrument).shouldSetAsDefaultInstrument === 'boolean')\n    );\n}\n","import {\n    FormattedPayload,\n    FormattedVaultedInstrument,\n    HostedVaultedInstrument,\n    PaymentInstrumentPayload,\n    VaultedInstrument,\n} from './payment';\n\nexport default function isVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is VaultedInstrument {\n    return Boolean((instrument as VaultedInstrument).instrumentId);\n}\n\nexport function isHostedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is HostedVaultedInstrument {\n    return (\n        Boolean((instrument as HostedVaultedInstrument).instrumentId) &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccNumber') &&\n        !Object.prototype.hasOwnProperty.call(instrument, 'ccCvv')\n    );\n}\n\nexport function isFormattedVaultedInstrument(\n    instrument: PaymentInstrumentPayload,\n): instrument is FormattedPayload<FormattedVaultedInstrument> {\n    const formattedInstrument = (instrument as FormattedPayload<FormattedVaultedInstrument>)\n        .formattedPayload;\n\n    if (!formattedInstrument) {\n        return false;\n    }\n\n    return (\n        typeof formattedInstrument.bigpay_token === 'string' ||\n        Boolean(formattedInstrument.bigpay_token && formattedInstrument.bigpay_token.token)\n    );\n}\n","export interface BaseInstrument {\n    bigpayToken: string;\n    defaultInstrument: boolean;\n    provider: string;\n    trustedShippingAddress: boolean;\n    method: string;\n    type: string;\n}\n\nexport function isBaseInstrument(instrument: unknown): instrument is BaseInstrument {\n    if (typeof instrument !== 'object' || instrument === null) {\n        return false;\n    }\n\n    return (\n        'bigpayToken' in instrument &&\n        'defaultInstrument' in instrument &&\n        'provider' in instrument &&\n        'trustedShippingAddress' in instrument &&\n        'method' in instrument &&\n        'type' in instrument\n    );\n}\n","import {\n    getPaypalMessagesStylesFromBNPLConfig,\n    isBigCommercePaymentsProviderError,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalMessagesSdk,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    HostedInstrument,\n    InvalidArgumentError,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentInstrumentPayload,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\nimport { isBaseInstrument } from '@bigcommerce/checkout-sdk/utility';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtons,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    ClickCallbackActions,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsPaymentInitializeOptions, {\n    WithBigCommercePaymentsPaymentInitializeOptions,\n} from './bigcommerce-payments-payment-initialize-options';\n\nexport default class BigCommercePaymentsPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: BigCommercePaymentsButtons;\n    private bigcommerce_payments?: BigCommercePaymentsPaymentInitializeOptions;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private paypalSdkHelper: PayPalSdkHelper,\n        private loadingIndicator: LoadingIndicator,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithBigCommercePaymentsPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments } = options || {};\n\n        this.bigcommerce_payments = bigcommerce_payments;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        const { container, bannerContainerId } = bigcommerce_payments;\n\n        const {\n            orderId,\n            paypalBNPLConfiguration = [],\n            isPayPalCreditAvailable,\n        } = paymentMethod.initializationData || {};\n\n        if (bannerContainerId !== undefined) {\n            if (!document.getElementById(bannerContainerId)) {\n                // eslint-disable-next-line no-console\n                console.error('Unable to create banner without valid banner container ID.');\n\n                return;\n            }\n\n            const bannerConfiguration = paypalBNPLConfiguration?.find(\n                ({ id }) => id === 'checkout',\n            );\n\n            if (isPayPalCreditAvailable || !bannerConfiguration?.status) {\n                return;\n            }\n\n            const paypalMessages = await this.paypalSdkHelper.getPayPalMessages(\n                paymentMethod,\n                state.getCartOrThrow().currency.code,\n            );\n\n            if (!paypalMessages || typeof paypalMessages?.Messages !== 'function') {\n                console.error(\n                    '[BC PayPalCommerce PayLater]: banner could not be rendered, due to issues with loading PayPal SDK',\n                );\n\n                return;\n            }\n\n            return this.renderMessages(paypalMessages, bannerContainerId, bannerConfiguration);\n        }\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (orderId) {\n            this.orderId = orderId;\n\n            return;\n        }\n\n        this.loadingIndicatorContainer = container?.split('#')[1];\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        if (bigcommerce_payments.onInit && typeof bigcommerce_payments.onInit === 'function') {\n            bigcommerce_payments.onInit(() => this.renderButton(methodId, bigcommerce_payments));\n        }\n\n        if (\n            bigcommerce_payments.shouldRenderPayPalButtonOnInitialization === undefined ||\n            bigcommerce_payments.shouldRenderPayPalButtonOnInitialization\n        ) {\n            this.renderButton(methodId, bigcommerce_payments);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n        const { onError } = this.bigcommerce_payments || {};\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, paymentData } = payment;\n\n        if (this.isPayPalVaultedInstrumentPaymentData(paymentData) && !this.orderId) {\n            this.orderId = await this.createOrder();\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        const paymentPayload = this.isPayPalVaultedInstrumentPaymentData(paymentData)\n            ? this.prepareVaultedInstrumentPaymentPayload(methodId, this.orderId, paymentData)\n            : this.preparePaymentPayload(methodId, this.orderId, paymentData);\n\n        try {\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paymentIntegrationService.submitPayment(paymentPayload);\n        } catch (error: unknown) {\n            if (this.isProviderError(error)) {\n                await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(payment.methodId);\n\n                await new Promise((_resolve, reject) => {\n                    if (this.bigcommerce_payments) {\n                        this.paypalButton?.close();\n                        this.renderButton(payment.methodId, this.bigcommerce_payments);\n                        this.handleError(new Error('INSTRUMENT_DECLINED'), onError);\n                    }\n\n                    reject();\n                });\n            }\n\n            this.handleError(error, onError);\n\n            return Promise.reject();\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    private prepareVaultedInstrumentPaymentPayload(\n        methodId: string,\n        paypalOrderId: string,\n        paymentData: VaultedInstrument & HostedInstrument,\n    ): Payment {\n        const { instrumentId, shouldSetAsDefaultInstrument } = paymentData;\n\n        const shouldConfirmInstrument = !this.isTrustedVaultingFlow(paymentData);\n\n        if (shouldConfirmInstrument) {\n            return {\n                methodId,\n                paymentData: {\n                    shouldSaveInstrument: shouldConfirmInstrument,\n                    shouldSetAsDefaultInstrument,\n                    formattedPayload: {\n                        paypal_account: {\n                            order_id: paypalOrderId,\n                        },\n                    },\n                },\n            };\n        }\n\n        return {\n            methodId,\n            paymentData: {\n                instrumentId,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_account: {\n                        order_id: paypalOrderId,\n                    },\n                    bigpay_token: {\n                        token: instrumentId,\n                    },\n                },\n            },\n        };\n    }\n\n    private preparePaymentPayload(\n        methodId: string,\n        paypalOrderId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n    ): Payment {\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        return {\n            methodId,\n            paymentData: {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_account: {\n                        order_id: paypalOrderId,\n                    },\n                },\n            },\n        };\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        bigcommerce_payments: BigCommercePaymentsPaymentInitializeOptions,\n    ): void {\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n        const { container, onError, onRenderButton, onValidate, submitForm } = bigcommerce_payments;\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"container\" argument is not provided.',\n            );\n        }\n\n        const buttonOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(\n                checkoutPaymentButtonStyles,\n            ),\n            createOrder: () => this.createOrder(),\n            onClick: (_, actions) => this.handleClick(actions, onValidate),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onError: (error) => this.handleError(error, onError),\n            onCancel: () => this.toggleLoadingIndicator(false),\n        };\n\n        this.paypalButton = paypalSdk.Buttons(buttonOptions);\n\n        if (!this.paypalButton.isEligible()) {\n            return;\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        this.paypalButton.render(container);\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: BigCommercePaymentsPaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        await onValidate?.(onValidationPassed, reject);\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: BigCommercePaymentsPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm?.();\n    }\n\n    private handleError(\n        error: unknown,\n        onError: BigCommercePaymentsPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    private async createOrder(): Promise<string> {\n        const fieldsValues = this.getFieldsValues();\n\n        return this.bigCommercePaymentsIntegrationService.createOrder(\n            'bigcommerce_paymentscheckout',\n            {\n                shouldSaveInstrument: fieldsValues?.shouldSaveInstrument || false,\n            },\n        );\n    }\n\n    /**\n     *\n     * Vaulting flow methods\n     *\n     * */\n    private getFieldsValues(): HostedInstrument | undefined {\n        const { getFieldsValues } = this.bigcommerce_payments || {};\n\n        return typeof getFieldsValues === 'function' ? getFieldsValues() : undefined;\n    }\n\n    private isTrustedVaultingFlow(paymentData?: PaymentInstrumentPayload): boolean {\n        if (paymentData && isVaultedInstrument(paymentData)) {\n            const state = this.paymentIntegrationService.getState();\n\n            const instruments = state.getInstruments();\n\n            const findInstrument = instruments?.find(\n                (instrument) =>\n                    isBaseInstrument(instrument) &&\n                    instrument.bigpayToken === paymentData.instrumentId,\n            );\n            const trustedShippingAddress = isBaseInstrument(findInstrument)\n                ? findInstrument.trustedShippingAddress\n                : {};\n\n            return !!trustedShippingAddress;\n        }\n\n        return false;\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Guards\n     *\n     */\n    private isPayPalVaultedInstrumentPaymentData(\n        paymentData?: PaymentInstrumentPayload,\n    ): paymentData is VaultedInstrument & HostedInstrument {\n        return (\n            !!paymentData && isVaultedInstrument(paymentData) && isHostedInstrumentLike(paymentData)\n        );\n    }\n\n    /**\n     *\n     * Render Pay Later Messages\n     *\n     * */\n    private renderMessages(\n        paypalMessages: PayPalMessagesSdk,\n        bannerContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'payment',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        paypalMessages.Messages(paypalMessagesOptions).render(`#${bannerContainerId}`);\n    }\n\n    private isProviderError(error: unknown): boolean {\n        if (isBigCommercePaymentsProviderError(error)) {\n            const paypalProviderError = error?.errors?.filter((e) => e.provider_error) || [];\n\n            return paypalProviderError[0]?.provider_error?.code === 'INSTRUMENT_DECLINED';\n        }\n\n        return false;\n    }\n}\n","export interface ProviderError extends Error {\n    errors?: ErrorElement[];\n    status?: string;\n    three_ds_result?: {\n        acs_url: unknown;\n        payer_auth_request: unknown;\n        merchant_data: unknown;\n        callback_url: unknown;\n    };\n}\n\nexport interface ErrorElement {\n    code: string;\n    message: string;\n    provider_error?: {\n        code: string;\n    };\n}\n\nexport default function isBigCommercePaymentsProviderError(error: unknown): error is ProviderError {\n    return typeof error === 'object' && error !== null && 'errors' in error;\n}\n","import { createBigCommercePaymentsSdk } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport { LOADING_INDICATOR_STYLES } from '../bigcommerce-payments-constants';\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsPaymentStrategy from './bigcommerce-payments-payment-strategy';\n\nconst createBigCommercePaymentsPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        createBigCommercePaymentsSdk(),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsPaymentStrategy, [\n    { id: 'bigcommerce_payments' },\n]);\n","import {\n    PaymentProviderCustomer,\n    PayPalConnectCustomer,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\n// TODO: update PayPalConnectCustomer with PayPalFastlaneCustomer\nexport default function isPayPalFastlaneCustomer(\n    customer?: PaymentProviderCustomer,\n): customer is PayPalConnectCustomer {\n    if (!customer) {\n        return false;\n    }\n\n    return (\n        'authenticationState' in customer || 'addresses' in customer || 'instruments' in customer\n    );\n}\n","export interface Features {\n    [featureName: string]: boolean | undefined;\n}\n\nexport default function isExperimentEnabled(\n    features: Features,\n    experimentName: string,\n    fallbackValue = true,\n): boolean {\n    return features[experimentName] ?? fallbackValue;\n}\n","import {\n    BigCommercePaymentsFastlaneUtils,\n    BigCommercePaymentsInitializationData,\n    getFastlaneStyles,\n    isBigcommerceFastlaneRequestError,\n    isPayPalFastlaneCustomer,\n    PayPalFastlaneAuthenticationState,\n    PayPalFastlaneCardComponentMethods,\n    PayPalFastlaneCardComponentOptions,\n    PayPalFastlanePaymentFormattedPayload,\n    PayPalFastlaneSdk,\n    PayPalSdkHelper,\n    TDSecureAuthenticationState,\n    TDSecureVerificationMethod,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CardInstrument,\n    InvalidArgumentError,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport BigCommercePaymentsRequestSender from '../bigcommerce-payments-request-sender';\nimport { LiabilityShiftEnum } from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsFastlanePaymentInitializeOptions, {\n    WithBigCommercePaymentsFastlanePaymentInitializeOptions,\n} from './bigcommerce-payments-fastlane-payment-initialize-options';\n\nexport default class BigCommercePaymentsFastlanePaymentStrategy implements PaymentStrategy {\n    private paypalComponentMethods?: PayPalFastlaneCardComponentMethods;\n    private threeDSVerificationMethod?: string;\n    private paypalFastlaneSdk?: PayPalFastlaneSdk;\n    private bigcommerce_payments_fastlane?: BigCommercePaymentsFastlanePaymentInitializeOptions;\n    private methodId?: string;\n    private orderId?: string;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsRequestSender: BigCommercePaymentsRequestSender,\n        private bigCommercePaymentsSdk: PayPalSdkHelper,\n        private bigCommercePaymentsFastlaneUtils: BigCommercePaymentsFastlaneUtils,\n    ) {}\n\n    /**\n     *\n     * Default methods\n     *\n     * */\n    async initialize(\n        options: PaymentInitializeOptions & WithBigCommercePaymentsFastlanePaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments_fastlane } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        this.methodId = methodId;\n\n        if (!bigcommerce_payments_fastlane) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_fastlane\" argument is not provided.',\n            );\n        }\n\n        this.bigcommerce_payments_fastlane = bigcommerce_payments_fastlane;\n\n        if (\n            !bigcommerce_payments_fastlane.onInit ||\n            typeof bigcommerce_payments_fastlane.onInit !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_fastlane.onInit\" argument is not provided or it is not a function.',\n            );\n        }\n\n        if (\n            !bigcommerce_payments_fastlane.onChange ||\n            typeof bigcommerce_payments_fastlane.onChange !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_fastlane.onChange\" argument is not provided or it is not a function.',\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { isDeveloperModeApplicable, isFastlaneStylingEnabled } =\n            paymentMethod.initializationData || {};\n\n        this.threeDSVerificationMethod =\n            paymentMethod.initializationData?.threeDSVerificationMethod;\n\n        this.paypalFastlaneSdk = await this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(\n            paymentMethod,\n            cart.currency.code,\n            cart.id,\n        );\n\n        const paypalFastlaneStyling = isFastlaneStylingEnabled\n            ? paymentMethod?.initializationData?.fastlaneStyles\n            : {};\n\n        const fastlaneStyles = getFastlaneStyles(\n            paypalFastlaneStyling,\n            bigcommerce_payments_fastlane?.styles,\n        );\n\n        await this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(\n            this.paypalFastlaneSdk,\n            !!isDeveloperModeApplicable,\n            fastlaneStyles,\n        );\n\n        if (this.shouldRunAuthenticationFlow()) {\n            await this.runPayPalAuthenticationFlowOrThrow(methodId);\n        }\n\n        await this.initializePayPalPaymentComponent();\n\n        bigcommerce_payments_fastlane.onInit((container: string) =>\n            this.renderPayPalPaymentComponent(container),\n        );\n        bigcommerce_payments_fastlane.onChange(() =>\n            this.handlePayPalStoredInstrumentChange(methodId),\n        );\n    }\n\n    async execute(orderRequest: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = orderRequest;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { paymentData, methodId } = payment;\n\n        const isVaultedFlow = paymentData && isVaultedInstrument(paymentData);\n\n        try {\n            await this.paymentIntegrationService.submitOrder(order, options);\n\n            const paymentPayload = isVaultedFlow\n                ? await this.prepareVaultedInstrumentPaymentPayload(methodId, paymentData)\n                : await this.preparePaymentPayload(methodId, paymentData);\n\n            await this.paymentIntegrationService.submitPayment<PayPalFastlanePaymentFormattedPayload>(\n                paymentPayload,\n            );\n\n            this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId();\n        } catch (error) {\n            if (\n                isBigcommerceFastlaneRequestError(error) &&\n                error.response.name === 'INVALID_REQUEST'\n            ) {\n                const invalidRequestError = {\n                    translationKey: 'payment.errors.invalid_request_error',\n                };\n\n                this.handleError(invalidRequestError);\n\n                return Promise.reject();\n            }\n\n            if (error instanceof Error && error.name !== 'FastlaneError') {\n                throw error;\n            }\n\n            return Promise.reject();\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    async deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Authentication flow methods\n     *\n     */\n    private shouldRunAuthenticationFlow(): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const customer = state.getCustomerOrThrow();\n        const paymentProviderCustomer = state.getPaymentProviderCustomer();\n        const paypalFastlaneCustomer = isPayPalFastlaneCustomer(paymentProviderCustomer)\n            ? paymentProviderCustomer\n            : {};\n\n        const paypalFastlaneSessionId = this.bigCommercePaymentsFastlaneUtils.getStorageSessionId();\n\n        if (\n            !customer.isGuest ||\n            paypalFastlaneCustomer?.authenticationState ===\n                PayPalFastlaneAuthenticationState.CANCELED\n        ) {\n            return false;\n        }\n\n        return !paypalFastlaneCustomer?.authenticationState && paypalFastlaneSessionId === cart.id;\n    }\n\n    private async runPayPalAuthenticationFlowOrThrow(methodId: string): Promise<void> {\n        try {\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const customer = state.getCustomer();\n            const billingAddress = state.getBillingAddress();\n            const customerEmail = customer?.email || billingAddress?.email || '';\n\n            const { customerContextId } =\n                await this.bigCommercePaymentsFastlaneUtils.lookupCustomerOrThrow(customerEmail);\n\n            const authenticationResult =\n                await this.bigCommercePaymentsFastlaneUtils.triggerAuthenticationFlowOrThrow(\n                    customerContextId,\n                );\n\n            const { authenticationState, addresses, instruments } =\n                this.bigCommercePaymentsFastlaneUtils.mapPayPalFastlaneProfileToBcCustomerData(\n                    methodId,\n                    authenticationResult,\n                );\n\n            await this.paymentIntegrationService.updatePaymentProviderCustomer({\n                authenticationState,\n                addresses,\n                instruments,\n            });\n\n            const isAuthenticationFlowCanceled =\n                authenticationResult.authenticationState ===\n                PayPalFastlaneAuthenticationState.CANCELED;\n\n            if (isAuthenticationFlowCanceled) {\n                this.bigCommercePaymentsFastlaneUtils.removeStorageSessionId();\n            } else {\n                this.bigCommercePaymentsFastlaneUtils.updateStorageSessionId(cart.id);\n            }\n        } catch (error) {\n            // Info: Do not throw anything here to avoid blocking customer from passing checkout flow\n        }\n    }\n\n    /**\n     *\n     * BigCommercePayments Fastlane Card Component rendering method\n     *\n     */\n    private async initializePayPalPaymentComponent(): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n        const phone = billingAddress.phone;\n        const fullName = `${billingAddress.firstName} ${billingAddress.lastName}`.trim();\n\n        const paypalFastlane = this.bigCommercePaymentsFastlaneUtils.getPayPalFastlaneOrThrow();\n\n        const cardComponentOptions: PayPalFastlaneCardComponentOptions = {\n            fields: {\n                cardholderName: {\n                    prefill: fullName,\n                    enabled: true,\n                },\n                ...(phone && {\n                    phoneNumber: {\n                        prefill: phone,\n                    },\n                }),\n            },\n        };\n\n        this.paypalComponentMethods = await paypalFastlane.FastlaneCardComponent(\n            cardComponentOptions,\n        );\n    }\n\n    private renderPayPalPaymentComponent(container?: string): void {\n        const paypalComponentMethods = this.getPayPalComponentMethodsOrThrow();\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                'Unable to render card component because \"container\" argument is not provided.',\n            );\n        }\n\n        paypalComponentMethods.render(container);\n    }\n\n    private getPayPalComponentMethodsOrThrow(): PayPalFastlaneCardComponentMethods {\n        if (!this.paypalComponentMethods) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalComponentMethods;\n    }\n\n    /**\n     *\n     * Payment Payload preparation methods\n     *\n     */\n    private async prepareVaultedInstrumentPaymentPayload(\n        methodId: string,\n        paymentData: VaultedInstrument,\n    ): Promise<Payment<PayPalFastlanePaymentFormattedPayload>> {\n        const { instrumentId } = paymentData;\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        const is3DSEnabled =\n            this.isBigcommercePaymentsFastlaneThreeDSAvailable() &&\n            paymentMethod.config.is3dsEnabled;\n\n        const nonce = is3DSEnabled ? await this.get3DSNonce(instrumentId) : instrumentId;\n\n        await this.createOrder(nonce);\n\n        return {\n            methodId,\n            paymentData: {\n                formattedPayload: {\n                    paypal_fastlane_token: {\n                        order_id: this.orderId,\n                        token: nonce,\n                    },\n                },\n            },\n        };\n    }\n\n    private async preparePaymentPayload(\n        methodId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n    ): Promise<Payment<PayPalFastlanePaymentFormattedPayload>> {\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        const fullName = `${billingAddress.firstName} ${billingAddress.lastName}`.trim();\n\n        const { getPaymentToken } = this.getPayPalComponentMethodsOrThrow();\n\n        const { id } = await getPaymentToken({\n            name: { fullName },\n            billingAddress:\n                this.bigCommercePaymentsFastlaneUtils.mapBcToPayPalAddress(billingAddress),\n        });\n\n        const is3DSEnabled =\n            this.isBigcommercePaymentsFastlaneThreeDSAvailable() &&\n            paymentMethod.config.is3dsEnabled;\n\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        const nonce = is3DSEnabled ? await this.get3DSNonce(id) : id;\n\n        await this.createOrder(nonce);\n\n        return {\n            methodId,\n            paymentData: {\n                ...paymentData,\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                formattedPayload: {\n                    paypal_fastlane_token: {\n                        order_id: this.orderId,\n                        token: nonce,\n                    },\n                },\n            },\n        };\n    }\n\n    private async createOrder(id: string): Promise<void> {\n        const state = this.paymentIntegrationService.getState();\n        const cartId = state.getCartOrThrow().id;\n\n        if (this.methodId) {\n            const { orderId } = await this.bigCommercePaymentsRequestSender.createOrder(\n                this.methodId,\n                {\n                    cartId,\n                    fastlaneToken: id,\n                },\n            );\n\n            this.orderId = orderId;\n        }\n    }\n\n    /**\n     *\n     * 3DSecure methods\n     *\n     * */\n    private async get3DSNonce(nonce: string): Promise<string> {\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const order = state.getOrderOrThrow();\n        const checkoutUrl = state.getStoreConfigOrThrow().links.checkoutLink;\n\n        const threeDomainSecureComponent = this.paypalFastlaneSdk?.ThreeDomainSecureClient;\n\n        if (!threeDomainSecureComponent) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        const threeDomainSecureParameters = {\n            amount: order.orderAmount.toFixed(2),\n            currency: cart.currency.code,\n            nonce,\n            threeDSRequested: this.threeDSVerificationMethod === TDSecureVerificationMethod.Always,\n            transactionContext: {\n                experience_context: {\n                    locale: 'en-US',\n                    return_url: checkoutUrl,\n                    cancel_url: checkoutUrl,\n                },\n            },\n        };\n\n        const isThreeDomainSecureEligible = await threeDomainSecureComponent.isEligible(\n            threeDomainSecureParameters,\n        );\n\n        if (\n            this.threeDSVerificationMethod === TDSecureVerificationMethod.Always &&\n            !isThreeDomainSecureEligible\n        ) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        if (isThreeDomainSecureEligible) {\n            const {\n                liabilityShift,\n                authenticationState,\n                nonce: threeDSNonce,\n            } = await threeDomainSecureComponent.show();\n\n            if (\n                liabilityShift === LiabilityShiftEnum.No ||\n                liabilityShift === LiabilityShiftEnum.Unknown ||\n                authenticationState === TDSecureAuthenticationState.Errored ||\n                authenticationState === TDSecureAuthenticationState.Cancelled\n            ) {\n                throw new PaymentMethodInvalidError();\n            }\n\n            if (\n                authenticationState === TDSecureAuthenticationState.Succeeded &&\n                [LiabilityShiftEnum.Yes, LiabilityShiftEnum.Possible].includes(liabilityShift)\n            ) {\n                return threeDSNonce;\n            }\n        }\n\n        return nonce;\n    }\n\n    /**\n     *\n     * BigCommercePayments Fastlane instrument change\n     *\n     */\n    private async handlePayPalStoredInstrumentChange(\n        methodId: string,\n    ): Promise<CardInstrument | undefined> {\n        const paypalAxoSdk = this.bigCommercePaymentsFastlaneUtils.getPayPalFastlaneOrThrow();\n\n        const { selectionChanged, selectedCard } = await paypalAxoSdk.profile.showCardSelector();\n\n        if (selectionChanged) {\n            const state = this.paymentIntegrationService.getState();\n            const paymentProviderCustomer = state.getPaymentProviderCustomer();\n            const paypalFastlaneCustomer = isPayPalFastlaneCustomer(paymentProviderCustomer)\n                ? paymentProviderCustomer\n                : {};\n\n            const selectedInstrument =\n                this.bigCommercePaymentsFastlaneUtils.mapPayPalToBcInstrument(\n                    methodId,\n                    selectedCard,\n                )[0];\n\n            await this.paymentIntegrationService.updatePaymentProviderCustomer({\n                ...paypalFastlaneCustomer,\n                instruments: [selectedInstrument],\n            });\n\n            return selectedInstrument;\n        }\n\n        return undefined;\n    }\n\n    /**\n     *\n     * Bigcommerce Payments Fastlane experiments handling\n     *\n     */\n    private isBigcommercePaymentsFastlaneThreeDSAvailable(): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const features = state.getStoreConfigOrThrow().checkoutSettings.features;\n\n        return isExperimentEnabled(features, 'PROJECT-7080.bcp_fastlane_three_ds');\n    }\n\n    private handleError(error: unknown): void {\n        if (\n            this.bigcommerce_payments_fastlane?.onError &&\n            typeof this.bigcommerce_payments_fastlane.onError === 'function'\n        ) {\n            this.bigcommerce_payments_fastlane.onError(error);\n        }\n    }\n}\n","export interface BigcommerceFastlaneRequestError {\n    name: string;\n    message: string;\n    response: {\n        name: string;\n    };\n}\n\nexport default function isBigcommerceFastlaneRequestError(\n    error: unknown,\n): error is BigcommerceFastlaneRequestError {\n    return (\n        typeof error === 'object' &&\n        error !== null &&\n        'message' in error &&\n        'response' in error &&\n        'name' in (error as BigcommerceFastlaneRequestError).response\n    );\n}\n","import { createRequestSender } from '@bigcommerce/request-sender';\n\nimport {\n    createBigCommercePaymentsFastlaneUtils,\n    createBigCommercePaymentsSdk,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsRequestSender from '../bigcommerce-payments-request-sender';\n\nimport BigCommercePaymentsFastlanePaymentStrategy from './bigcommerce-payments-fastlane-payment-strategy';\n\nconst createBigCommercePaymentsFastlanePaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsFastlanePaymentStrategy\n> = (paymentIntegrationService) => {\n    const { getHost } = paymentIntegrationService.getState();\n\n    return new BigCommercePaymentsFastlanePaymentStrategy(\n        paymentIntegrationService,\n        new BigCommercePaymentsRequestSender(createRequestSender({ host: getHost() })),\n        createBigCommercePaymentsSdk(),\n        createBigCommercePaymentsFastlaneUtils(),\n    );\n};\n\nexport default toResolvableModule(createBigCommercePaymentsFastlanePaymentStrategy, [\n    { id: 'bigcommerce_payments_fastlane' }, // BigCommercePayments Fastlane relates to 'bigcommerce_payments_fastlane' method id\n]);\n","import StandardError from './standard-error';\n\n/**\n * Throw this error if we try to call a method that is only a stub and has not\n * been fully implemented.\n */\nexport default class NotImplementedError extends StandardError {\n    constructor(message?: string) {\n        super(message || 'Not implemented.');\n\n        this.name = 'NotImplementedError';\n        this.type = 'not_implemented';\n    }\n}\n","import {\n    BigCommercePaymentsInitializationData,\n    getPaypalMessagesStylesFromBNPLConfig,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalMessagesSdk,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    InvalidArgumentError,\n    NotImplementedError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtons,\n    BigCommercePaymentsButtonsOptions,\n    ClickCallbackActions,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsPayLaterPaymentInitializeOptions, {\n    WithBigCommercePaymentsPayLaterPaymentInitializeOptions,\n} from './bigcommerce-payments-paylater-payment-initialize-options';\n\nexport default class BigCommercePaymentsPayLaterPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private bigCommercePaymentsButtons?: BigCommercePaymentsButtons;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n        private paypalSdkHelper: PayPalSdkHelper,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions &\n            WithBigCommercePaymentsPayLaterPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments_paylater } = options || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_paylater) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { paypalBNPLConfiguration = [], orderId } = paymentMethod.initializationData || {};\n        const { bannerContainerId, container } = bigcommerce_payments_paylater;\n\n        if (bannerContainerId !== undefined) {\n            if (!document.getElementById(bannerContainerId)) {\n                // eslint-disable-next-line no-console\n                console.error('Unable to create banner without valid banner container ID.');\n\n                return;\n            }\n\n            const bannerConfiguration =\n                paypalBNPLConfiguration &&\n                paypalBNPLConfiguration.find(({ id }) => id === 'checkout');\n\n            if (!bannerConfiguration?.status) {\n                return;\n            }\n\n            const paypalMessages = await this.paypalSdkHelper.getPayPalMessages(\n                paymentMethod,\n                state.getCartOrThrow().currency.code,\n            );\n\n            return this.renderMessages(paypalMessages, bannerContainerId, bannerConfiguration);\n        }\n\n        // Info:\n        // The BigCommercePayments button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render BigCommercePayments button.\n        if (orderId) {\n            this.orderId = orderId;\n\n            return;\n        }\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        this.loadingIndicatorContainer = container?.split('#')[1];\n\n        this.renderButton(methodId, bigcommerce_payments_paylater);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.bigCommercePaymentsIntegrationService.submitPayment(\n            payment.methodId,\n            this.orderId,\n        );\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.bigCommercePaymentsButtons?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        bigcommerce_payments_paylater: BigCommercePaymentsPayLaterPaymentInitializeOptions,\n    ): void {\n        if (!bigcommerce_payments_paylater?.container) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"container\" argument is not provided.',\n            );\n        }\n\n        const bigCommerceSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n\n        const { container, onError, onRenderButton, onValidate, submitForm } =\n            bigcommerce_payments_paylater;\n\n        const fundingSources = [bigCommerceSdk.FUNDING.PAYLATER, bigCommerceSdk.FUNDING.CREDIT];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (hasRenderedSmartButton) {\n                return;\n            }\n\n            const buttonOptions: BigCommercePaymentsButtonsOptions = {\n                fundingSource,\n                style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(\n                    checkoutPaymentButtonStyles,\n                ),\n                createOrder: () =>\n                    this.bigCommercePaymentsIntegrationService.createOrder(\n                        'bigcommerce_payments_paylater',\n                    ),\n                onClick: (_, actions) => this.handleClick(actions, onValidate),\n                onApprove: (data) => this.handleApprove(data, submitForm),\n                onCancel: () => this.toggleLoadingIndicator(false),\n                onError: (error) => this.handleError(error, onError),\n            };\n\n            this.bigCommercePaymentsButtons = bigCommerceSdk.Buttons(buttonOptions);\n\n            if (\n                !this.bigCommercePaymentsButtons.isEligible() &&\n                fundingSource === bigCommerceSdk.FUNDING.PAYLATER\n            ) {\n                return;\n            }\n\n            if (\n                !this.bigCommercePaymentsButtons.isEligible() &&\n                fundingSource === bigCommerceSdk.FUNDING.CREDIT\n            ) {\n                throw new NotImplementedError(\n                    `BigCommercePayments ${fundingSource} is not available for your region. Please use BigCommercePayments Checkout instead.`,\n                );\n            }\n\n            if (onRenderButton && typeof onRenderButton === 'function') {\n                onRenderButton();\n            }\n\n            this.bigCommercePaymentsButtons.render(container);\n            hasRenderedSmartButton = true;\n        });\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: BigCommercePaymentsPayLaterPaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        if (onValidate && typeof onValidate === 'function') {\n            await onValidate(onValidationPassed, reject);\n        }\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: BigCommercePaymentsPayLaterPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        if (submitForm && typeof submitForm === 'function') {\n            submitForm();\n        }\n    }\n\n    private handleError(\n        error: Error,\n        onError: BigCommercePaymentsPayLaterPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Render Pay Later Messages\n     *\n     * */\n    private renderMessages(\n        paypalMessages: PayPalMessagesSdk,\n        bannerContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'payment',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        paypalMessages.Messages(paypalMessagesOptions).render(`#${bannerContainerId}`);\n    }\n}\n","import { createBigCommercePaymentsSdk } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport { LOADING_INDICATOR_STYLES } from '../bigcommerce-payments-constants';\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsPayLaterPaymentStrategy from './bigcommerce-payments-paylater-payment-strategy';\n\nconst createBigCommercePaymentsPayLaterPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsPayLaterPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsPayLaterPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n        createBigCommercePaymentsSdk(),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsPayLaterPaymentStrategy, [\n    { id: 'bigcommerce_payments_paylater' },\n]);\n","import { Response } from '@bigcommerce/request-sender';\n\nimport RequestError from './request-error';\n\n/**\n * Throw this error if a request fails to complete within its required timeframe\n * because of a network issue.\n */\nexport default class TimeoutError<T = any> extends RequestError<T> {\n    constructor(response?: Response<T>) {\n        super(response, {\n            message: 'The request has timed out or aborted.',\n        });\n\n        this.name = 'TimeoutError';\n        this.type = 'timeout';\n    }\n}\n","import { noop } from 'lodash';\n\nimport {\n    InvalidArgumentError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    TimeoutError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    BigCommercePaymentsInitializationData,\n    BirthDate,\n    PayPalOrderStatus,\n} from '../bigcommerce-payments-types';\n\nimport {\n    BigCommercePaymentsRatePayPaymentInitializeOptions,\n    WithBigCommercePaymentsRatePayPaymentInitializeOptions,\n} from './bigcommerce-payments-ratepay-initialize-options';\n\nconst POLLING_INTERVAL = 3000;\nconst MAX_POLLING_TIME = 300000;\n\nexport default class BigCommercePaymentsRatePayPaymentStrategy implements PaymentStrategy {\n    private guid?: string;\n    private bigcommerce_payments_ratepay?: BigCommercePaymentsRatePayPaymentInitializeOptions;\n    private loadingIndicatorContainer?: string;\n    private pollingTimer = 0;\n    private stopPolling = noop;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n        private pollingInterval: number = POLLING_INTERVAL,\n        private maxPollingIntervalTime: number = MAX_POLLING_TIME,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions & WithBigCommercePaymentsRatePayPaymentInitializeOptions,\n    ): Promise<void> {\n        const { gatewayId, methodId, bigcommerce_payments_ratepay } = options;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!gatewayId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.gatewayId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_ratepay) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_ratepay\" argument is not provided.`,\n            );\n        }\n\n        const { legalTextContainer, container, loadingContainerId } = bigcommerce_payments_ratepay;\n\n        if (!container) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.container\" argument is not provided.`,\n            );\n        }\n\n        if (!legalTextContainer) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.legalTextContainer\" argument is not provided.`,\n            );\n        }\n\n        if (!loadingContainerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.loadingContainerId\" argument is not provided.`,\n            );\n        }\n\n        this.loadingIndicatorContainer = loadingContainerId;\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { merchantId } = paymentMethod.initializationData || {};\n\n        if (!merchantId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because merchantId argument is not provided.`,\n            );\n        }\n\n        this.bigcommerce_payments_ratepay = bigcommerce_payments_ratepay;\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        this.createFraudNetScript(merchantId, methodId, gatewayId);\n\n        this.loadFraudnetConfig();\n\n        this.renderLegalText(legalTextContainer, container);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        const { getFieldsValues } = this.bigcommerce_payments_ratepay || {};\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!getFieldsValues || typeof getFieldsValues !== 'function') {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.getFieldsValues\" argument is not provided.`,\n            );\n        }\n\n        this.toggleLoadingIndicator(true);\n\n        try {\n            const orderId = await this.bigCommercePaymentsIntegrationService.createOrder(\n                'bigcommerce_payments_apmscheckout',\n                { metadataId: this.guid },\n            );\n\n            const { ratepayBirthDate, ratepayPhoneNumber, ratepayPhoneCountryCode } =\n                getFieldsValues();\n\n            const paymentData = {\n                formattedPayload: {\n                    vault_payment_instrument: null,\n                    set_as_default_stored_instrument: null,\n                    device_info: null,\n                    method_id: payment.methodId,\n                    rate_pay: {\n                        birth_date: this.normalizeDate(ratepayBirthDate),\n                        phone: {\n                            national_number: ratepayPhoneNumber,\n                            country_code: ratepayPhoneCountryCode.split('+')[1],\n                        },\n                    },\n                    paypal_account: {\n                        order_id: orderId,\n                    },\n                },\n            };\n\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paymentIntegrationService.submitPayment({\n                methodId: payment.methodId,\n                paymentData,\n            });\n\n            return await new Promise((resolve, reject) => {\n                this.initializePollingMechanism(\n                    payment.methodId,\n                    resolve,\n                    reject,\n                    payment.gatewayId,\n                );\n            });\n        } catch (error: unknown) {\n            this.handleError(error);\n\n            return new Promise((_resolve, reject) => reject());\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        const { legalTextContainer } = this.bigcommerce_payments_ratepay || {};\n        const fraudNetScript = document.querySelectorAll('[data-id=\"fraudnetScript\"]')[0];\n        const fraudNetConfig = document.querySelectorAll('[data-id=\"fraudnetConfig\"]')[0];\n\n        this.deinitializePollingMechanism();\n\n        fraudNetScript.remove();\n        fraudNetConfig.remove();\n\n        if (legalTextContainer) {\n            const legalTextContainerElement = document.getElementById(legalTextContainer);\n\n            legalTextContainerElement?.remove();\n        }\n\n        return Promise.resolve();\n    }\n\n    private normalizeDate(date: BirthDate) {\n        const formattedDate = this.formatDate(date.getDate());\n        const formattedMonth = this.formatDate(date.getMonth() + 1);\n\n        return `${date.getFullYear()}-${formattedMonth}-${formattedDate}`;\n    }\n\n    private formatDate(date: number): string {\n        return `${date < 10 ? 0 : ''}${date}`;\n    }\n\n    private renderLegalText(legalTextContainerElementId: string, container: string) {\n        const legalTextContainerId = legalTextContainerElementId;\n        const buttonContainerId = container.split('#')[1];\n        const buttonContainer = document.getElementById(buttonContainerId);\n        const buttonContainerParent = buttonContainer?.parentNode;\n        const legalTextContainer = document.createElement('div');\n\n        legalTextContainer.style.marginBottom = '20px';\n        legalTextContainer.setAttribute('id', legalTextContainerId);\n        buttonContainerParent?.prepend(legalTextContainer);\n\n        const bigCommercePaymentsSdk =\n            this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const ratePayButton = bigCommercePaymentsSdk.Legal({\n            fundingSource: bigCommercePaymentsSdk.Legal.FUNDING.PAY_UPON_INVOICE,\n        });\n        const legalTextContainerElement = document.getElementById(legalTextContainerId);\n\n        if (legalTextContainerElement) {\n            ratePayButton.render(`#${legalTextContainerId}`);\n        } else {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"legalTextContainerElement\" argument is not found.`,\n            );\n        }\n    }\n\n    private handleError(error: unknown): void {\n        const { onError } = this.bigcommerce_payments_ratepay || {};\n\n        this.resetPollingMechanism();\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    private createFraudNetScript(merchantId: string, methodId: string, gatewayId: string) {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow(methodId, gatewayId);\n        const { testMode } = paymentMethod.config;\n        const scriptElement = document.createElement('script');\n\n        scriptElement.setAttribute('type', 'application/json');\n        scriptElement.setAttribute('fncls', 'fnparams-dede7cc5-15fd-4c75-a9f4-36c430ee3a99');\n        scriptElement.setAttribute('data-id', 'fraudnetScript');\n        this.guid = this.generateGUID();\n\n        const fraudNetConfig = {\n            f: this.guid,\n            s: `${merchantId}_checkout-page`,\n            sandbox: testMode,\n        };\n\n        scriptElement.innerHTML = JSON.stringify(fraudNetConfig);\n        document.body.appendChild(scriptElement);\n    }\n\n    private generateGUID() {\n        let guid = '';\n        const characters = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\n        for (let i = 0; i < 32; i += 1) {\n            const randomIndex = Math.floor(Math.random() * characters.length);\n\n            guid += characters[randomIndex];\n        }\n\n        return guid;\n    }\n\n    private loadFraudnetConfig() {\n        const script = document.createElement('script');\n\n        script.setAttribute('data-id', 'fraudnetConfig');\n        script.src = 'https://c.paypal.com/da/r/fb.js';\n        document.body.appendChild(script);\n    }\n\n    private async reinitializeStrategy(\n        options: PaymentInitializeOptions & WithBigCommercePaymentsRatePayPaymentInitializeOptions,\n    ): Promise<void> {\n        await this.deinitialize();\n        await this.initialize(options);\n    }\n\n    /**\n     *\n     * Polling mechanism\n     *\n     *\n     * */\n    private async initializePollingMechanism(\n        methodId: string,\n        resolvePromise: () => void,\n        rejectPromise: () => void,\n        gatewayId?: string,\n    ): Promise<void> {\n        await new Promise<void>((resolve, reject) => {\n            const timeout = setTimeout(resolve, this.pollingInterval);\n\n            this.stopPolling = () => {\n                clearTimeout(timeout);\n                this.toggleLoadingIndicator(false);\n\n                return reject();\n            };\n        });\n\n        try {\n            this.pollingTimer += this.pollingInterval;\n\n            const orderStatus = await this.bigCommercePaymentsIntegrationService.getOrderStatus(\n                'bigcommerce_payments_apms',\n                {\n                    params: {\n                        useMetadata: true,\n                    },\n                },\n            );\n\n            const isOrderApproved = orderStatus === PayPalOrderStatus.PollingStop;\n            const isPollingError = orderStatus === PayPalOrderStatus.PollingError;\n\n            if (isOrderApproved) {\n                this.deinitializePollingMechanism();\n\n                return resolvePromise();\n            }\n\n            if (isPollingError) {\n                return rejectPromise();\n            }\n\n            if (!isOrderApproved && this.pollingTimer < this.maxPollingIntervalTime) {\n                return await this.initializePollingMechanism(\n                    methodId,\n                    resolvePromise,\n                    rejectPromise,\n                    gatewayId,\n                );\n            }\n\n            await this.reinitializeStrategy({\n                methodId,\n                gatewayId,\n                bigcommerce_payments_ratepay: this.bigcommerce_payments_ratepay,\n            });\n\n            this.handleError(new TimeoutError());\n        } catch (error) {\n            this.handleError(error);\n            rejectPromise();\n        }\n    }\n\n    private deinitializePollingMechanism(): void {\n        this.stopPolling();\n        this.pollingTimer = 0;\n    }\n\n    private resetPollingMechanism(): void {\n        this.deinitializePollingMechanism();\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport { LOADING_INDICATOR_STYLES } from '../bigcommerce-payments-constants';\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsRatePayPaymentStrategy from './bigcommerce-payments-ratepay-payment-strategy';\n\nconst createBigCommercePaymentsRatePayPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsRatePayPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsRatePayPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({\n            containerStyles: { ...LOADING_INDICATOR_STYLES, position: 'fixed' },\n        }),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsRatePayPaymentStrategy, [\n    { gateway: 'bigcommerce_payments_apms', id: 'ratepay' },\n]);\n","// copied from packages/core/src/hosted-form/hosted-field-type.ts\n\nenum HostedFieldType {\n    CardCode = 'cardCode',\n    CardCodeVerification = 'cardCodeVerification',\n    CardExpiry = 'cardExpiry',\n    CardName = 'cardName',\n    CardNumber = 'cardNumber',\n    CardNumberVerification = 'cardNumberVerification',\n    CardExpiryVerification = 'cardExpiryVerification',\n}\n\nexport default HostedFieldType;\n","import HostedFieldType from './hosted-field-type';\nimport { HostedCardFieldOptionsMap, HostedStoredCardFieldOptionsMap } from './hosted-form-options';\n\nexport default function isCreditCardFormFields(\n    fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n): fields is HostedCardFieldOptionsMap {\n    return (\n        HostedFieldType.CardNumber in fields &&\n        HostedFieldType.CardName in fields &&\n        HostedFieldType.CardExpiry in fields\n    );\n}\n","import HostedFieldType from './hosted-field-type';\nimport { HostedCardFieldOptionsMap, HostedStoredCardFieldOptionsMap } from './hosted-form-options';\n\nexport default function isCreditCardVaultedFormFields(\n    fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n): fields is HostedStoredCardFieldOptionsMap {\n    return (\n        HostedFieldType.CardNumberVerification in fields &&\n        HostedFieldType.CardCodeVerification in fields &&\n        HostedFieldType.CardExpiryVerification in fields\n    );\n}\n","import StandardError from './standard-error';\n\n/**\n * This error should be thrown when a payment method experiences some kind of\n * failure (i.e.: its client library returns a rejected promise). And there is\n * no other error type that is more specific than this one.\n */\nexport default class PaymentMethodFailedError extends StandardError {\n    constructor(message?: string) {\n        super(\n            message ||\n                'Unable to proceed because the client library of a payment method has thrown an unexpected error.',\n        );\n\n        this.name = 'PaymentMethodFailedError';\n        this.type = 'payment_method_client_invalid';\n    }\n}\n","import StandardError from './standard-error';\n\nexport enum NotInitializedErrorType {\n    CheckoutButtonNotInitialized,\n    CustomerNotInitialized,\n    PaymentNotInitialized,\n    ShippingNotInitialized,\n    SpamProtectionNotInitialized,\n}\n\n/**\n * Throw this error if a method requires a certain initialization call to be\n * made first. Some objects can be constructed but they cannot be used until a\n * separate initialization call is made.\n */\nexport default class NotInitializedError extends StandardError {\n    constructor(public subtype: NotInitializedErrorType) {\n        super(getErrorMessage(subtype));\n\n        this.name = 'NotInitializedError';\n        this.type = 'not_initialized';\n    }\n}\n\nfunction getErrorMessage(type: NotInitializedErrorType): string {\n    switch (type) {\n        case NotInitializedErrorType.CustomerNotInitialized:\n            return 'Unable to proceed because the customer step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.PaymentNotInitialized:\n            return 'Unable to proceed because the payment step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.ShippingNotInitialized:\n            return 'Unable to proceed because the shipping step of checkout has not been initialized.';\n\n        case NotInitializedErrorType.SpamProtectionNotInitialized:\n            return 'Unable to proceed because the checkout spam protection has not been initialized.';\n\n        default:\n            return 'Unable to proceed because the required component has not been initialized.';\n    }\n}\n","import StandardError from './standard-error';\n\nexport interface PaymentInvalidFormErrorDetails {\n    [key: string]: Array<{ message: string; type: string }>;\n}\n\nexport default class PaymentInvalidFormError extends StandardError {\n    constructor(public details: PaymentInvalidFormErrorDetails, message?: string) {\n        super(message || 'Unable to proceed because the payment form contains invalid data.');\n\n        this.name = 'PaymentInvalidFormError';\n        this.type = 'payment_invalid_form';\n    }\n}\n","import { isNil, omitBy } from 'lodash';\n\nimport {\n    BigCommercePaymentsFastlaneUtils,\n    BigCommercePaymentsInitializationData,\n    isBigCommercePaymentsFastlaneCustomer,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    HostedCardFieldOptions,\n    HostedCardFieldOptionsMap,\n    HostedFieldBlurEventData,\n    HostedFieldEnterEventData,\n    HostedFieldFocusEventData,\n    HostedFieldStylesMap,\n    HostedFieldType,\n    HostedFieldValidateEventData,\n    HostedFormOptions,\n    HostedInputValidateErrorData,\n    HostedInputValidateErrorDataMap,\n    HostedInstrument,\n    HostedStoredCardFieldOptionsMap,\n    InvalidArgumentError,\n    isCreditCardFormFields,\n    isCreditCardVaultedFormFields,\n    isHostedInstrumentLike,\n    isVaultedInstrument,\n    NotInitializedError,\n    NotInitializedErrorType,\n    OrderFinalizationNotRequiredError,\n    OrderPaymentRequestBody,\n    OrderRequestBody,\n    Payment,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentInvalidFormError,\n    PaymentInvalidFormErrorDetails,\n    PaymentMethodFailedError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    VaultedInstrument,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    BigCommercePaymentsCardFields,\n    BigCommercePaymentsCardFieldsConfig,\n    BigCommercePaymentsCardFieldsOnApproveData,\n    BigCommercePaymentsCardFieldsState,\n    BigCommercePaymentsFields,\n    BigCommercePaymentsHostedFieldsRenderOptions,\n    LiabilityShiftEnum,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsCreditCardsPaymentInitializeOptions, {\n    WithBigCommercePaymentsCreditCardsPaymentInitializeOptions,\n} from './bigcommerce-payments-credit-cards-payment-initialize-options';\n\nexport default class BigCommercePaymentsCreditCardsPaymentStrategy implements PaymentStrategy {\n    private executionPaymentData?: OrderPaymentRequestBody['paymentData'];\n    private isCreditCardForm?: boolean;\n    private isCreditCardVaultedForm?: boolean;\n\n    private cardFields?: BigCommercePaymentsCardFields;\n    private cvvField?: BigCommercePaymentsFields;\n    private expiryField?: BigCommercePaymentsFields;\n    private numberField?: BigCommercePaymentsFields;\n    private nameField?: BigCommercePaymentsFields;\n\n    private hostedFormOptions?: HostedFormOptions;\n    private returnedOrderId?: string;\n    private returnedVaultedToken?: string;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private bigCommercePaymentsSdk: PayPalSdkHelper,\n        private bigCommercePaymentsFastlaneUtils: BigCommercePaymentsFastlaneUtils,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions &\n            WithBigCommercePaymentsCreditCardsPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments_creditcards } = options;\n        const bigCommercePaymentsInitializationOptions = bigcommerce_payments_creditcards;\n\n        const { form, onCreditCardFieldsRenderingError, onLoadComplete } =\n            bigCommercePaymentsInitializationOptions || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!form) {\n            throw new InvalidArgumentError(\n                'Unable to proceed because \"options.bigcommerce_payments_creditcards.form\" argument is not provided.',\n            );\n        }\n\n        this.hostedFormOptions = form;\n\n        this.isCreditCardForm = isCreditCardFormFields(form.fields);\n        this.isCreditCardVaultedForm =\n            isCreditCardVaultedFormFields(form.fields) && !this.hasUndefinedValues();\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(\n            methodId,\n            undefined,\n            true,\n            true,\n        );\n\n        if (this.isCreditCardForm || this.isCreditCardVaultedForm) {\n            await this.initializeFields(form, onCreditCardFieldsRenderingError);\n        }\n\n        onLoadComplete?.();\n\n        if (this.shouldInitializePayPalFastlane(methodId)) {\n            await this.initializePayPalFastlaneOrThrow(methodId);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n        const { methodId, paymentData } = payment || {};\n\n        if (!payment || !methodId) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        this.executionPaymentData = paymentData;\n\n        if (this.isCreditCardForm || this.isCreditCardVaultedForm) {\n            await this.validateHostedFormOrThrow();\n            await this.submitHostedForm();\n        } else {\n            // The condition gets triggered when customer pays with vaulted instrument and shipping address is trusted\n            const { orderId } =\n                await this.bigCommercePaymentsIntegrationService.createOrderCardFields(\n                    'bigcommerce_payments_creditcardscheckout',\n                    this.getInstrumentParams(),\n                );\n\n            this.returnedOrderId = orderId;\n        }\n\n        const submitPaymentPayload = this.preparePaymentPayload(\n            methodId,\n            paymentData,\n            this.returnedOrderId,\n            this.returnedVaultedToken,\n        );\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.paymentIntegrationService.submitPayment(submitPaymentPayload);\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    async deinitialize(): Promise<void> {\n        await this.cvvField?.close();\n        await this.expiryField?.close();\n        await this.numberField?.close();\n        await this.nameField?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Submit Payment Payload preparing method\n     *\n     * `vaultedToken` is used when we pay with vaulted instrument (with trusted shipping address and untrusted)\n     * `setupToken` is used when we pay with vaulted instrument (untrusted shipping address)\n     * `orderId` is used in every case (basic card payment, trusted shipping address and untrusted)\n     */\n    private preparePaymentPayload(\n        methodId: string,\n        paymentData: OrderPaymentRequestBody['paymentData'],\n        orderId?: string,\n        nonce?: string,\n    ): Payment {\n        const { shouldSaveInstrument = false, shouldSetAsDefaultInstrument = false } =\n            isHostedInstrumentLike(paymentData) ? paymentData : {};\n\n        const instrumentId =\n            paymentData && isVaultedInstrument(paymentData) ? paymentData.instrumentId : undefined;\n\n        const bigpay_token = omitBy(\n            {\n                verification_nonce: nonce,\n                token: instrumentId,\n            },\n            isNil,\n        );\n\n        return {\n            methodId,\n            paymentData: {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n                instrumentId,\n                formattedPayload: {\n                    ...(nonce || instrumentId ? { bigpay_token } : {}),\n                    ...(orderId ? { card_with_order: { order_id: orderId } } : {}),\n                },\n            },\n        };\n    }\n\n    /**\n     *\n     * Card fields initialize\n     *\n     */\n    private async initializeFields(\n        formOptions: HostedFormOptions,\n        onCreditCardFieldsRenderingError?: BigCommercePaymentsCreditCardsPaymentInitializeOptions['onCreditCardFieldsRenderingError'],\n    ): Promise<void> {\n        const { fields, styles } = formOptions;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const executeCallback = this.getExecuteCallback(fields);\n\n        const cardFieldsConfig: BigCommercePaymentsCardFieldsConfig = {\n            style: this.getInputStyles(styles),\n            onApprove: ({\n                orderID,\n                vaultSetupToken,\n                liabilityShift,\n            }: BigCommercePaymentsCardFieldsOnApproveData) => {\n                if (\n                    liabilityShift === LiabilityShiftEnum.No ||\n                    liabilityShift === LiabilityShiftEnum.Unknown\n                ) {\n                    throw new Error();\n                }\n\n                return this.handleApprove({ orderID, vaultSetupToken });\n            },\n            onError: () => {\n                throw new PaymentMethodFailedError();\n            },\n            inputEvents: {\n                onChange: (event) => this.onChangeHandler(formOptions, event),\n                onFocus: (event) => this.onFocusHandler(formOptions, event),\n                onBlur: (event) => this.onBlurHandler(formOptions, event),\n                onInputSubmitRequest: (event) => this.onInputSubmitRequest(formOptions, event),\n            },\n            ...executeCallback,\n        };\n\n        this.cardFields = await paypalSdk.CardFields(cardFieldsConfig);\n\n        if (!this.cardFields.isEligible()) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        try {\n            this.stylizeInputContainers(fields);\n\n            if (isCreditCardFormFields(fields)) {\n                await this.renderFields(fields);\n            }\n\n            if (isCreditCardVaultedFormFields(fields)) {\n                await this.renderVaultedFields(fields);\n            }\n        } catch (error: unknown) {\n            if (typeof onCreditCardFieldsRenderingError === 'function') {\n                onCreditCardFieldsRenderingError(error);\n            }\n        }\n    }\n\n    /**\n     *\n     * Get execute callback method\n     * Depends on shipping address is trusted or not we should pass to PP\n     * `createVaultSetupToken` callback if address is untrusted or\n     * `createOrder` if address is trusted\n     *\n     */\n    private getExecuteCallback(\n        fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n    ) {\n        const isVaultedForm = isCreditCardVaultedFormFields(fields);\n\n        return isVaultedForm ? this.createVaultSetupTokenCallback() : this.createOrderCallback();\n    }\n\n    private createVaultSetupTokenCallback() {\n        return {\n            createVaultSetupToken: async () => {\n                const { setupToken } =\n                    (await this.bigCommercePaymentsIntegrationService.createOrderCardFields(\n                        'bigcommerce_payments_creditcardscheckout',\n                        {\n                            ...this.getInstrumentParams(),\n                            setupToken: true,\n                        },\n                    )) || {};\n\n                return setupToken;\n            },\n        };\n    }\n\n    private createOrderCallback() {\n        return {\n            createOrder: async () => {\n                const { orderId } =\n                    (await this.bigCommercePaymentsIntegrationService.createOrderCardFields(\n                        'bigcommerce_payments_creditcardscheckout',\n                        this.getInstrumentParams(),\n                    )) || {};\n\n                return orderId;\n            },\n        };\n    }\n\n    /**\n     *\n     * onApprove method\n     * When submitting a form with a `submitHostedForm` method if there is no error\n     * then onApprove callback is triggered and depends on the flow\n     * we will receive an `orderID` if it's basic paying and `vaultSetupToken` if we are paying\n     * with vaulted instrument and shipping address is untrusted\n     *\n     */\n    private handleApprove({\n        orderID,\n        vaultSetupToken,\n    }: BigCommercePaymentsCardFieldsOnApproveData) {\n        if (orderID) {\n            this.returnedOrderId = orderID;\n        }\n\n        if (vaultSetupToken) {\n            this.returnedVaultedToken = vaultSetupToken;\n        }\n    }\n\n    /**\n     *\n     * Rendering Card Fields methods\n     *\n     */\n    private async renderFields(fieldsOptions: HostedCardFieldOptionsMap) {\n        const cardFields = this.getCardFieldsOrThrow();\n\n        if (fieldsOptions.cardCode?.containerId) {\n            this.cvvField = cardFields.CVVField({\n                placeholder: '',\n            });\n            await this.cvvField.render(`#${fieldsOptions.cardCode.containerId}`);\n        }\n\n        if (fieldsOptions.cardExpiry?.containerId) {\n            this.expiryField = cardFields.ExpiryField();\n            await this.expiryField.render(`#${fieldsOptions.cardExpiry.containerId}`);\n        }\n\n        if (fieldsOptions.cardName?.containerId) {\n            this.nameField = cardFields.NameField({\n                placeholder: '',\n            });\n            await this.nameField.render(`#${fieldsOptions.cardName.containerId}`);\n        }\n\n        if (fieldsOptions.cardNumber?.containerId) {\n            this.numberField = cardFields.NumberField({\n                placeholder: '',\n            });\n            await this.numberField.render(`#${fieldsOptions.cardNumber.containerId}`);\n        }\n    }\n\n    private async renderVaultedFields(fieldsOptions: HostedStoredCardFieldOptionsMap) {\n        const cardFields = this.getCardFieldsOrThrow();\n\n        if (fieldsOptions.cardCodeVerification?.containerId) {\n            this.cvvField = cardFields.CVVField({\n                placeholder: '',\n            });\n            await this.cvvField.render(`#${fieldsOptions.cardCodeVerification.containerId}`);\n        }\n\n        if (fieldsOptions.cardExpiryVerification?.containerId) {\n            this.expiryField = cardFields.ExpiryField();\n            await this.expiryField.render(`#${fieldsOptions.cardExpiryVerification.containerId}`);\n        }\n\n        if (fieldsOptions.cardNumberVerification?.containerId) {\n            this.numberField = cardFields.NumberField({\n                placeholder: '',\n            });\n            await this.numberField.render(`#${fieldsOptions.cardNumberVerification.containerId}`);\n        }\n    }\n\n    /**\n     *\n     * Instrument params method\n     *\n     */\n    private getInstrumentParams(): HostedInstrument | VaultedInstrument {\n        if (!this.executionPaymentData) {\n            return {};\n        }\n\n        if (isHostedInstrumentLike(this.executionPaymentData)) {\n            const { shouldSaveInstrument, shouldSetAsDefaultInstrument } =\n                this.executionPaymentData;\n\n            return {\n                shouldSaveInstrument,\n                shouldSetAsDefaultInstrument,\n            };\n        }\n\n        if (isVaultedInstrument(this.executionPaymentData)) {\n            const { instrumentId } = this.executionPaymentData;\n\n            return {\n                instrumentId,\n            };\n        }\n\n        return {};\n    }\n\n    private getFieldTypeByEmittedField({\n        emittedBy,\n    }: BigCommercePaymentsCardFieldsState):\n        | HostedFieldBlurEventData\n        | HostedFieldEnterEventData\n        | HostedFieldFocusEventData {\n        return {\n            fieldType: this.mapFieldType(emittedBy),\n        };\n    }\n\n    /**\n     *\n     * Form submit method\n     * Triggers a form submit\n     *\n     * */\n    private async submitHostedForm() {\n        const cardFields = this.getCardFieldsOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const billingAddress = state.getBillingAddressOrThrow();\n\n        const submitConfig = {\n            billingAddress: {\n                company: billingAddress.company,\n                addressLine1: billingAddress.address1,\n                addressLine2: billingAddress.address2,\n                adminArea1: billingAddress.stateOrProvinceCode,\n                adminArea2: billingAddress.city,\n                postalCode: billingAddress.postalCode,\n                countryCode: billingAddress.countryCode,\n            },\n        };\n\n        try {\n            if (this.isCreditCardVaultedForm) {\n                await cardFields.submit();\n            } else {\n                await cardFields.submit(submitConfig);\n            }\n        } catch (_) {\n            throw new PaymentMethodFailedError(\n                'Failed authentication. Please try to authorize again.',\n            );\n        }\n    }\n\n    /**\n     *\n     * Validation and errors\n     *\n     */\n    private async validateHostedFormOrThrow() {\n        const cardFields = this.getCardFieldsOrThrow();\n        const cardFieldsState = await cardFields.getState().then((data) => data);\n        const validationData = this.getValidityData(cardFieldsState);\n\n        if (validationData.isValid) {\n            return;\n        }\n\n        this.hostedFormOptions?.onValidate?.(validationData);\n\n        throw new PaymentInvalidFormError(this.mapValidationErrors(validationData.errors));\n    }\n\n    private getValidityData({\n        fields,\n    }: BigCommercePaymentsCardFieldsState): HostedFieldValidateEventData {\n        const updatedFields = { ...fields };\n\n        delete updatedFields.cardNameField;\n\n        const fieldsKeys = Object.keys(updatedFields) as Array<\n            keyof BigCommercePaymentsCardFieldsState['fields']\n        >;\n\n        const isValid = fieldsKeys.every((key) => updatedFields[key]?.isValid);\n\n        const errors = fieldsKeys.reduce((fieldsErrors, key) => {\n            const fieldType = this.mapFieldType(key);\n\n            return {\n                ...fieldsErrors,\n                [fieldType]: updatedFields[key]?.isValid\n                    ? undefined\n                    : [this.getInvalidErrorByFieldType(fieldType)],\n            };\n        }, {});\n\n        return { isValid, errors };\n    }\n\n    private getInvalidErrorByFieldType(fieldType: string): HostedInputValidateErrorData {\n        switch (fieldType) {\n            case HostedFieldType.CardCode:\n            case HostedFieldType.CardCodeVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card code',\n                    type: 'invalid_card_code',\n                };\n\n            case HostedFieldType.CardNumber:\n            case HostedFieldType.CardNumberVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card number',\n                    type: 'invalid_card_number',\n                };\n\n            case HostedFieldType.CardExpiry:\n            case HostedFieldType.CardExpiryVerification:\n                return {\n                    fieldType,\n                    message: 'Invalid card expiry',\n                    type: 'invalid_card_expiry',\n                };\n\n            default:\n                return {\n                    fieldType,\n                    message: 'Invalid field',\n                    type: 'invalid',\n                };\n        }\n    }\n\n    private mapValidationErrors(\n        validationErrors: HostedInputValidateErrorDataMap = {},\n    ): PaymentInvalidFormErrorDetails {\n        const errors: PaymentInvalidFormErrorDetails = {};\n        const validationErrorsKeys = Object.keys(validationErrors) as Array<\n            keyof HostedInputValidateErrorDataMap\n        >;\n\n        validationErrorsKeys.forEach((key) => {\n            errors[key] = [\n                {\n                    message: validationErrors[key]?.[0]?.message || '',\n                    type: key,\n                },\n            ];\n        });\n\n        return errors;\n    }\n\n    /**\n     *\n     * Fields mappers\n     *\n     */\n    private mapFieldType(type: string): HostedFieldType {\n        switch (type) {\n            case 'name':\n                return HostedFieldType.CardName;\n\n            case 'cardNumberField':\n            case 'number':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardNumber\n                    : HostedFieldType.CardNumberVerification;\n\n            case 'cardExpiryField':\n            case 'expiry':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardExpiry\n                    : HostedFieldType.CardExpiryVerification;\n\n            case 'cardCvvField':\n            case 'cvv':\n                return this.isCreditCardForm\n                    ? HostedFieldType.CardCode\n                    : HostedFieldType.CardCodeVerification;\n\n            default:\n                throw new Error('Unexpected field type');\n        }\n    }\n\n    /**\n     *\n     * Utils\n     *\n     */\n    private getCardFieldsOrThrow(): BigCommercePaymentsCardFields {\n        if (!this.cardFields) {\n            throw new NotInitializedError(NotInitializedErrorType.PaymentNotInitialized);\n        }\n\n        return this.cardFields;\n    }\n\n    private getInputStyles(\n        styles?: HostedFieldStylesMap,\n    ): BigCommercePaymentsHostedFieldsRenderOptions['styles'] {\n        const commonStyles = {\n            'font-size': styles?.default?.fontSize || '1rem',\n            'font-family':\n                styles?.default?.fontFamily || 'Montserrat, Arial, Helvetica, sans-serif',\n            'font-weight': styles?.default?.fontWeight || '400',\n            outline: 'none',\n            padding: '9px 13px',\n        };\n\n        const defaultStyles = { ...commonStyles, color: '#333333' };\n        const errorStyles = { ...commonStyles, color: 'red' };\n\n        return {\n            input: defaultStyles,\n            '.invalid': errorStyles,\n            '.valid': defaultStyles,\n            ':focus': defaultStyles,\n        };\n    }\n\n    private stylizeInputContainers(\n        fields: HostedCardFieldOptionsMap | HostedStoredCardFieldOptionsMap,\n    ): void {\n        Object.values(fields || {}).forEach((id: HostedCardFieldOptions) => {\n            const element = document.getElementById(`${id?.containerId || ''}`);\n\n            if (element) {\n                element.style.padding = '0px';\n                element.style.boxShadow = 'none';\n                element.style.border = 'none';\n                element.style.background = 'transparent';\n                element.style.marginBottom = '10px';\n                element.style.marginLeft = '-5px';\n            }\n        });\n    }\n\n    private hasUndefinedValues() {\n        if (this.hostedFormOptions) {\n            return Object.values(this.hostedFormOptions.fields).some(\n                (value) => value === undefined,\n            );\n        }\n\n        return true;\n    }\n\n    /**\n     *\n     * Input events methods\n     *\n     */\n    private onChangeHandler(\n        formOptions: HostedFormOptions,\n        event: BigCommercePaymentsCardFieldsState,\n    ): void {\n        formOptions?.onValidate?.(this.getValidityData(event));\n    }\n\n    private onFocusHandler(\n        formOptions: HostedFormOptions,\n        event: BigCommercePaymentsCardFieldsState,\n    ): void {\n        formOptions?.onFocus?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    private onBlurHandler(\n        formOptions: HostedFormOptions,\n        event: BigCommercePaymentsCardFieldsState,\n    ): void {\n        formOptions?.onBlur?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    private onInputSubmitRequest(\n        formOptions: HostedFormOptions,\n        event: BigCommercePaymentsCardFieldsState,\n    ): void {\n        formOptions?.onEnter?.(this.getFieldTypeByEmittedField(event));\n    }\n\n    /**\n     *\n     * BigCommercePayments Accelerated checkout related methods\n     *\n     */\n    // TODO: remove this part when BCP Fastlane A/B testing will be finished\n    private shouldInitializePayPalFastlane(methodId: string) {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const paymentProviderCustomer = state.getPaymentProviderCustomer();\n        const bigCommercePaymentsPaymentProviderCustomer = isBigCommercePaymentsFastlaneCustomer(\n            paymentProviderCustomer,\n        )\n            ? paymentProviderCustomer\n            : {};\n\n        return (\n            paymentMethod?.initializationData?.isAcceleratedCheckoutEnabled &&\n            paymentMethod?.initializationData?.isBigCommercePaymentsAnalyticsV2Enabled &&\n            !bigCommercePaymentsPaymentProviderCustomer?.authenticationState\n        );\n    }\n\n    // TODO: remove this part when BCP Fastlane A/B testing will be finished\n    private async initializePayPalFastlaneOrThrow(methodId: string): Promise<void> {\n        try {\n            const state = this.paymentIntegrationService.getState();\n            const cart = state.getCartOrThrow();\n            const paymentMethod =\n                state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n            const { initializationData } = paymentMethod;\n\n            if (!initializationData?.connectClientToken) {\n                return;\n            }\n\n            const payPalFastlaneSdk = await this.bigCommercePaymentsSdk.getPayPalFastlaneSdk(\n                paymentMethod,\n                cart.currency.code,\n                cart.id,\n            );\n\n            await this.bigCommercePaymentsFastlaneUtils.initializePayPalFastlane(\n                payPalFastlaneSdk,\n                !!initializationData?.isDeveloperModeApplicable,\n            );\n        } catch (_: unknown) {\n            // We should avoid throwing any error from this flow to do no brake default flow\n            // This flow is optional\n        }\n    }\n}\n","import {\n    PaymentProviderCustomer,\n    PayPalConnectCustomer,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nexport default function isBigCommercePaymentsFastlaneCustomer(\n    customer?: PaymentProviderCustomer,\n): customer is PayPalConnectCustomer {\n    if (!customer) {\n        return false;\n    }\n\n    return (\n        'authenticationState' in customer || 'addresses' in customer || 'instruments' in customer\n    );\n}\n","import {\n    createBigCommercePaymentsFastlaneUtils,\n    createBigCommercePaymentsSdk,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsCreditCardsPaymentStrategy from './bigcommerce-payments-credit-cards-payment-strategy';\n\nconst createBigCommercePaymentsCreditCardsPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsCreditCardsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsCreditCardsPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        createBigCommercePaymentsSdk(),\n        createBigCommercePaymentsFastlaneUtils(),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsCreditCardsPaymentStrategy, [\n    { id: 'bigcommerce_payments_creditcards' },\n]);\n","import { noop } from 'lodash';\n\nimport {\n    PayPalApmSdk,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    InvalidArgumentError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodClientUnavailableError,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n    TimeoutError,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\nimport { isExperimentEnabled } from '@bigcommerce/checkout-sdk/utility';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtons,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    NonInstantAlternativePaymentMethods,\n    PayPalOrderStatus,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions, {\n    WithBigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n} from './bigcommerce-payments-alternative-methods-payment-initialize-options';\n\nconst POLLING_INTERVAL = 3000;\nconst MAX_POLLING_TIME = 300000;\n\nexport default class BigCommercePaymentsAlternativeMethodsPaymentStrategy\n    implements PaymentStrategy\n{\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private bigCommercePaymentsButton?: BigCommercePaymentsButtons;\n    private paypalApms?: PayPalApmSdk;\n    private pollingTimer = 0;\n    private stopPolling = noop;\n    private isPollingEnabled = false;\n    private bigCommercePaymentsAlternativeMethods?: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private bigCommercePaymentsSdkHelper: PayPalSdkHelper,\n        private loadingIndicator: LoadingIndicator,\n        private pollingInterval: number = POLLING_INTERVAL,\n        private maxPollingIntervalTime: number = MAX_POLLING_TIME,\n    ) {}\n\n    async initialize(\n        options: PaymentInitializeOptions &\n            WithBigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n    ): Promise<void> {\n        const { gatewayId, methodId, bigcommerce_payments_apms } = options;\n\n        this.bigCommercePaymentsAlternativeMethods = bigcommerce_payments_apms;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!gatewayId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.gatewayId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_apms) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument is not provided.`,\n            );\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { orderId, shouldRenderFields } = paymentMethod.initializationData || {};\n\n        const features = state.getStoreConfigOrThrow().checkoutSettings.features;\n\n        this.isPollingEnabled = isExperimentEnabled(features, 'PAYPAL-5624.bcp_ideal_polling');\n\n        // Info:\n        // The APM button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render the button.\n        if (orderId) {\n            this.orderId = orderId;\n\n            return;\n        }\n\n        this.paypalApms = await this.bigCommercePaymentsSdkHelper.getPayPalApmsSdk(\n            paymentMethod,\n            state.getCartOrThrow().currency.code,\n        );\n\n        this.loadingIndicatorContainer = bigcommerce_payments_apms.container.split('#')[1];\n\n        this.renderButton(methodId, gatewayId, bigcommerce_payments_apms);\n\n        if (shouldRenderFields) {\n            this.renderFields(methodId, bigcommerce_payments_apms);\n        }\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, gatewayId } = payment;\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        if (this.isPollingEnabled && methodId === 'ideal') {\n            await new Promise((resolve, reject) => {\n                void this.initializePollingMechanism(methodId, resolve, reject, gatewayId);\n            });\n        }\n\n        if (!this.isNonInstantPaymentMethod(methodId)) {\n            await this.paymentIntegrationService.submitOrder(order, options);\n        }\n\n        await this.bigCommercePaymentsIntegrationService.submitPayment(\n            methodId,\n            this.orderId,\n            gatewayId,\n        );\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        if (this.isPollingEnabled) {\n            this.resetPollingMechanism();\n        }\n\n        this.bigCommercePaymentsButton?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Polling mechanism\n     *\n     *\n     * */\n    private async initializePollingMechanism(\n        methodId: string,\n        resolvePromise: (value?: unknown) => void,\n        rejectPromise: (value?: unknown) => void,\n        gatewayId?: string,\n    ): Promise<void> {\n        await new Promise<void>((resolve, reject) => {\n            const timeout = setTimeout(resolve, this.pollingInterval);\n\n            this.stopPolling = () => {\n                clearTimeout(timeout);\n                this.toggleLoadingIndicator(false);\n\n                return reject();\n            };\n        });\n\n        try {\n            this.pollingTimer += this.pollingInterval;\n\n            const orderStatus = await this.bigCommercePaymentsIntegrationService.getOrderStatus(\n                gatewayId,\n            );\n\n            const isOrderApproved = orderStatus === PayPalOrderStatus.Approved;\n            const isPollingError = orderStatus === PayPalOrderStatus.PollingError;\n\n            if (isOrderApproved) {\n                this.deInitializePollingMechanism();\n\n                return resolvePromise();\n            }\n\n            if (isPollingError) {\n                return rejectPromise();\n            }\n\n            if (!isOrderApproved && this.pollingTimer < this.maxPollingIntervalTime) {\n                return await this.initializePollingMechanism(\n                    methodId,\n                    resolvePromise,\n                    rejectPromise,\n                    gatewayId,\n                );\n            }\n\n            await this.reinitializeStrategy({\n                methodId,\n                gatewayId,\n                bigCommercePaymentsAlternativeMethods: this.bigCommercePaymentsAlternativeMethods,\n            });\n\n            this.handleError(new TimeoutError());\n        } catch (error) {\n            rejectPromise();\n        }\n    }\n\n    private deInitializePollingMechanism(): void {\n        this.stopPolling();\n        this.pollingTimer = 0;\n    }\n\n    private resetPollingMechanism(): void {\n        this.deInitializePollingMechanism();\n    }\n\n    private async reinitializeStrategy(\n        options: PaymentInitializeOptions &\n            WithBigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n    ) {\n        await this.deinitialize();\n        await this.initialize(options);\n    }\n\n    private handleError(error: unknown) {\n        const { onError } = this.bigCommercePaymentsAlternativeMethods || {};\n\n        if (this.isPollingEnabled) {\n            this.resetPollingMechanism();\n        }\n\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        gatewayId: string,\n        bigcommerce_payments_apms: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n    ): void {\n        const paypalAmpsSdk = this.getPaypalAmpsSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod = state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(\n            methodId,\n            gatewayId,\n        );\n        const { buttonStyle } = paymentMethod.initializationData || {};\n\n        const { container, onError, onRenderButton, submitForm } = bigcommerce_payments_apms;\n\n        const buttonOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: methodId,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(buttonStyle),\n            onInit: (_, actions) => bigcommerce_payments_apms.onInitButton(actions),\n            createOrder: () => this.onCreateOrder(methodId, gatewayId, bigcommerce_payments_apms),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onCancel: () => {\n                this.toggleLoadingIndicator(false);\n                this.deInitializePollingMechanism();\n            },\n            onError: (error) => {\n                this.deInitializePollingMechanism();\n                this.handleFailure(error, onError);\n            },\n            onClick: async (_, actions) =>\n                bigcommerce_payments_apms.onValidate(actions.resolve, actions.reject),\n        };\n\n        this.bigCommercePaymentsButton = paypalAmpsSdk.Buttons(buttonOptions);\n\n        if (!this.bigCommercePaymentsButton.isEligible()) {\n            return;\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        this.bigCommercePaymentsButton.render(container);\n    }\n\n    private async onCreateOrder(\n        methodId: string,\n        gatewayId: string,\n        bigcommerce_payments_apms: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n    ): Promise<string> {\n        const { onValidate } = bigcommerce_payments_apms;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return () => Promise.resolve();\n        };\n\n        await onValidate(onValidationPassed, noop);\n\n        const orderId = await this.bigCommercePaymentsIntegrationService.createOrder(\n            'bigcommerce_payments_apms',\n        );\n\n        if (this.isNonInstantPaymentMethod(methodId)) {\n            const order = { useStoreCredit: false };\n            const options = {\n                params: {\n                    methodId,\n                    gatewayId,\n                },\n            };\n\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.bigCommercePaymentsIntegrationService.submitPayment(\n                methodId,\n                orderId,\n                gatewayId,\n            );\n        }\n\n        return orderId;\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm();\n    }\n\n    private handleFailure(\n        error: Error,\n        onError: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Fields methods\n     *\n     * */\n    private renderFields(\n        methodId: string,\n        bigcommerce_payments_apms: BigCommercePaymentsAlternativeMethodsPaymentInitializeOptions,\n    ): void {\n        const paypalAmpsSdk = this.getPaypalAmpsSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const { firstName, lastName, email } = state.getBillingAddressOrThrow();\n\n        const { apmFieldsContainer, apmFieldsStyles } = bigcommerce_payments_apms;\n\n        if (!apmFieldsContainer) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument should contain \"apmFieldsContainer\".',\n            );\n        }\n\n        const fieldContainerElement = document.querySelector(apmFieldsContainer);\n\n        if (fieldContainerElement) {\n            fieldContainerElement.innerHTML = '';\n        }\n\n        const fieldsOptions = {\n            fundingSource: methodId,\n            style: apmFieldsStyles || {},\n            fields: {\n                name: {\n                    value: `${firstName} ${lastName}`,\n                },\n                email: {\n                    value: email,\n                },\n            },\n        };\n\n        const paypalPaymentFields = paypalAmpsSdk.PaymentFields(fieldsOptions);\n\n        paypalPaymentFields.render(apmFieldsContainer);\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n\n    /**\n     *\n     * Utils\n     *\n     * */\n    private isNonInstantPaymentMethod(methodId: string): boolean {\n        return methodId.toUpperCase() in NonInstantAlternativePaymentMethods;\n    }\n\n    private getPaypalAmpsSdkOrThrow() {\n        if (!this.paypalApms) {\n            throw new PaymentMethodClientUnavailableError();\n        }\n\n        return this.paypalApms;\n    }\n}\n","import { createBigCommercePaymentsSdk } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport { LOADING_INDICATOR_STYLES } from '../bigcommerce-payments-constants';\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsAlternativeMethodsPaymentStrategy from './bigcommerce-payments-alternative-methods-payment-strategy';\n\nconst createBigCommercePaymentsAlternativeMethodsPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsAlternativeMethodsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsAlternativeMethodsPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        createBigCommercePaymentsSdk(),\n        new LoadingIndicator({\n            containerStyles: LOADING_INDICATOR_STYLES,\n        }),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsAlternativeMethodsPaymentStrategy, [\n    { gateway: 'bigcommerce_payments_apms' },\n]);\n","import { isRedirectError } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    InvalidArgumentError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsRedirectAlternativeMethodsPaymentInitializeOptions, {\n    WithBigCommercePaymentsRedirectAlternativeMethodsPaymentInitializeOptions,\n} from './bigcomemrce-payments-redirect-alternative-methods-payment-initialize-options';\n\nexport default class BigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy\n    implements PaymentStrategy\n{\n    private bigCommercePaymentsAlternativeMethods?: BigCommercePaymentsRedirectAlternativeMethodsPaymentInitializeOptions;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    initialize(\n        options: PaymentInitializeOptions &\n            WithBigCommercePaymentsRedirectAlternativeMethodsPaymentInitializeOptions,\n    ): Promise<void> {\n        const { gatewayId, methodId, bigcommerce_payments_apms } = options;\n\n        this.bigCommercePaymentsAlternativeMethods = bigcommerce_payments_apms;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!gatewayId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.gatewayId\" argument is not provided.',\n            );\n        }\n\n        return Promise.resolve();\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        const { methodId, gatewayId } = payment;\n\n        try {\n            const orderId = await this.bigCommercePaymentsIntegrationService.createOrder(\n                'bigcommerce_payments_apms',\n                {\n                    gatewayId: 'bigcommerce_payments_apms',\n                    methodId,\n                },\n            );\n\n            const paymentData = {\n                formattedPayload: {\n                    vault_payment_instrument: null,\n                    set_as_default_stored_instrument: null,\n                    device_info: null,\n                    method_id: methodId,\n                    paypal_account: {\n                        order_id: orderId,\n                    },\n                },\n            };\n\n            await this.paymentIntegrationService.submitOrder(order, options);\n            await this.paymentIntegrationService.submitPayment({\n                methodId,\n                gatewayId,\n                paymentData,\n            });\n        } catch (error: unknown) {\n            if (isRedirectError(error)) {\n                const redirectUrl = error.body.additional_action_required.data.redirect_url;\n\n                return new Promise((_, reject) => {\n                    window.location.replace(redirectUrl);\n\n                    reject();\n                });\n            }\n\n            this.handleError(error);\n\n            return Promise.reject(error);\n        }\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private handleError(error: unknown) {\n        const { onError } = this.bigCommercePaymentsAlternativeMethods || {};\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n}\n","import { isRequestError } from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport { RedirectError } from '../bigcommerce-payments-types';\n\nexport default function isRedirectError(error: unknown): error is RedirectError {\n    return isRequestError(error) && error.body?.additional_action_required?.data.redirect_url;\n}\n","import RequestError from './request-error';\n\n// Have to use `as` https://stackoverflow.com/questions/73987044/typeguarding-an-unknown-nested-object should be fixed in 4.8+\nconst isRequestError = (error: unknown): error is RequestError => {\n    return typeof error === 'object' && error !== null && 'body' in error;\n};\n\nexport default isRequestError;\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy from './bigcomemrce-payments-redirect-alternative-methods-payment-strategy';\n\nconst createBigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(\n    createBigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy,\n    [\n        { gateway: 'bigcommerce_payments_apms', id: 'klarna' },\n        { gateway: 'bigcommerce_payments_apms', id: 'afterpay' },\n    ],\n);\n","import {\n    InvalidArgumentError,\n    NotImplementedError,\n    OrderFinalizationNotRequiredError,\n    OrderRequestBody,\n    PaymentArgumentInvalidError,\n    PaymentInitializeOptions,\n    PaymentIntegrationService,\n    PaymentMethodInvalidError,\n    PaymentRequestOptions,\n    PaymentStrategy,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtons,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    ClickCallbackActions,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsVenmoPaymentInitializeOptions, {\n    WithBigCommercePaymentsVenmoPaymentInitializeOptions,\n} from './bigcommerce-payments-venmo-payment-initialize-options';\n\nexport default class BigCommercePaymentsVenmoPaymentStrategy implements PaymentStrategy {\n    private loadingIndicatorContainer?: string;\n    private orderId?: string;\n    private paypalButton?: BigCommercePaymentsButtons;\n\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private loadingIndicator: LoadingIndicator,\n    ) {}\n\n    async initialize(\n        options?: PaymentInitializeOptions & WithBigCommercePaymentsVenmoPaymentInitializeOptions,\n    ): Promise<void> {\n        const { methodId, bigcommerce_payments_venmo } = options || {};\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!bigcommerce_payments_venmo) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.`,\n            );\n        }\n\n        await this.paymentIntegrationService.loadPaymentMethod(methodId);\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        // Info:\n        // The PayPal button and fields should not be rendered when shopper was redirected to Checkout page\n        // after using smart payment button on PDP or Cart page. In this case backend returns order id if\n        // it is available in checkout session. Therefore, it is not necessary to render PayPal button.\n        if (paymentMethod.initializationData?.orderId) {\n            this.orderId = paymentMethod.initializationData?.orderId;\n\n            return;\n        }\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(methodId);\n\n        this.loadingIndicatorContainer = bigcommerce_payments_venmo.container.split('#')[1];\n\n        this.renderButton(methodId, bigcommerce_payments_venmo);\n    }\n\n    async execute(payload: OrderRequestBody, options?: PaymentRequestOptions): Promise<void> {\n        const { payment, ...order } = payload;\n\n        if (!payment) {\n            throw new PaymentArgumentInvalidError(['payment']);\n        }\n\n        if (!this.orderId) {\n            throw new PaymentMethodInvalidError();\n        }\n\n        await this.paymentIntegrationService.submitOrder(order, options);\n        await this.bigCommercePaymentsIntegrationService.submitPayment(\n            payment.methodId,\n            this.orderId,\n        );\n    }\n\n    finalize(): Promise<void> {\n        return Promise.reject(new OrderFinalizationNotRequiredError());\n    }\n\n    deinitialize(): Promise<void> {\n        this.orderId = undefined;\n\n        this.paypalButton?.close();\n\n        return Promise.resolve();\n    }\n\n    /**\n     *\n     * Button methods/callbacks\n     *\n     * */\n    private renderButton(\n        methodId: string,\n        bigcommerce_payments_venmo: BigCommercePaymentsVenmoPaymentInitializeOptions,\n    ): void {\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { paymentButtonStyles } = paymentMethod.initializationData || {};\n        const { checkoutPaymentButtonStyles } = paymentButtonStyles || {};\n\n        const { container, onError, onRenderButton, onValidate, submitForm } =\n            bigcommerce_payments_venmo;\n\n        const buttonOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.VENMO,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(\n                checkoutPaymentButtonStyles,\n            ),\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder(\n                    'bigcommerce_payments_venmocheckout',\n                ),\n            onClick: (_, actions) => this.handleClick(actions, onValidate),\n            onApprove: (data) => this.handleApprove(data, submitForm),\n            onCancel: () => this.toggleLoadingIndicator(false),\n            onError: (error) => this.handleError(error, onError),\n        };\n\n        this.paypalButton = paypalSdk.Buttons(buttonOptions);\n\n        if (!this.paypalButton.isEligible()) {\n            throw new NotImplementedError(\n                `Venmo is not available for your region. Please another payment method instead.`,\n            );\n        }\n\n        if (onRenderButton && typeof onRenderButton === 'function') {\n            onRenderButton();\n        }\n\n        this.paypalButton.render(container);\n    }\n\n    private async handleClick(\n        actions: ClickCallbackActions,\n        onValidate: BigCommercePaymentsVenmoPaymentInitializeOptions['onValidate'],\n    ): Promise<void> {\n        const { resolve, reject } = actions;\n\n        const onValidationPassed = () => {\n            this.toggleLoadingIndicator(true);\n\n            return resolve();\n        };\n\n        await onValidate(onValidationPassed, reject);\n    }\n\n    private handleApprove(\n        { orderID }: ApproveCallbackPayload,\n        submitForm: BigCommercePaymentsVenmoPaymentInitializeOptions['submitForm'],\n    ): void {\n        this.orderId = orderID;\n\n        submitForm();\n        this.toggleLoadingIndicator(false);\n    }\n\n    private handleError(\n        error: Error,\n        onError: BigCommercePaymentsVenmoPaymentInitializeOptions['onError'],\n    ): void {\n        this.toggleLoadingIndicator(false);\n\n        if (onError && typeof onError === 'function') {\n            onError(error);\n        }\n    }\n\n    /**\n     *\n     * Loading Indicator methods\n     *\n     * */\n    private toggleLoadingIndicator(isLoading: boolean): void {\n        if (isLoading && this.loadingIndicatorContainer) {\n            this.loadingIndicator.show(this.loadingIndicatorContainer);\n        } else {\n            this.loadingIndicator.hide();\n        }\n    }\n}\n","import {\n    PaymentStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\nimport { LoadingIndicator } from '@bigcommerce/checkout-sdk/ui';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsVenmoPaymentStrategy from './bigcommerce-payments-venmo-payment-strategy';\n\nconst createBigCommercePaymentsVenmoPaymentStrategy: PaymentStrategyFactory<\n    BigCommercePaymentsVenmoPaymentStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsVenmoPaymentStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        new LoadingIndicator({ styles: { backgroundColor: 'black' } }),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsVenmoPaymentStrategy, [\n    { id: 'bigcommerce_payments_venmo' },\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    BigCommercePaymentsInitializationData,\n    PayPalBuyNowInitializeOptions,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsButtonInitializeOptions, {\n    WithBigCommercePaymentsButtonInitializeOptions,\n} from './bigcommerce-payments-button-initialize-options';\n\nexport default class BigCommercePaymentsButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions & WithBigCommercePaymentsButtonInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments, containerId, methodId } = options;\n\n        const isBuyNowFlow = Boolean(bigcommerce_payments?.buyNowInitializeOptions);\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!bigcommerce_payments) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !bigcommerce_payments.currencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof bigcommerce_payments.buyNowInitializeOptions?.getBuyNowCartRequestBody !==\n                'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? bigcommerce_payments.currencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(\n            methodId,\n            currencyCode,\n            false,\n        );\n\n        this.renderButton(containerId, methodId, bigcommerce_payments, isBuyNowFlow);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        bigcommerce_payments: BigCommercePaymentsButtonInitializeOptions,\n        isBuyNowFlow?: boolean,\n    ): void {\n        const { buyNowInitializeOptions, style, onComplete, onEligibilityFailure } =\n            bigcommerce_payments;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { isHostedCheckoutEnabled, isAppSwitchEnabled } =\n            paymentMethod.initializationData || {};\n\n        const defaultCallbacks = {\n            ...(!isBuyNowFlow &&\n                this.isPaypalCommerceAppSwitchEnabled(methodId) && {\n                    appSwitchWhenAvailable: true,\n                }),\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder('bigcommerce_payments'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const hostedCheckoutCallbacks = {\n            ...(!isAppSwitchEnabled && {\n                onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                    this.onShippingAddressChange(data),\n                onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                    this.onShippingOptionsChange(data),\n            }),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: paypalSdk.FUNDING.PAYPAL,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n            ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n        };\n\n        const paypalButton = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButton.isEligible()) {\n            if (paypalButton.hasReturned?.() && this.isPaypalCommerceAppSwitchEnabled(methodId)) {\n                paypalButton.resume?.();\n            } else {\n                paypalButton.render(`#${containerId}`);\n            }\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.bigCommercePaymentsIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart =\n                await this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(\n                    buyNowInitializeOptions,\n                );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<boolean> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.bigCommercePaymentsIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.bigCommercePaymentsIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n\n            return true; // FIXME: Do we really need to return true here?\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.bigCommercePaymentsIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address accept shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption =\n                this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    /**\n     *\n     * PayPal AppSwitch enabling handling\n     *\n     */\n    private isPaypalCommerceAppSwitchEnabled(methodId: string): boolean {\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n        return paymentMethod.initializationData?.isAppSwitchEnabled ?? false;\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsButtonStrategy from './bigcommerce-payments-button-strategy';\n\nconst createBigCommercePaymentsButtonStrategy: CheckoutButtonStrategyFactory<\n    BigCommercePaymentsButtonStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsButtonStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsButtonStrategy, [\n    { id: 'bigcommerce_payments' },\n]);\n","import {\n    BigCommercePaymentsInitializationData,\n    getPaypalMessagesStylesFromBNPLConfig,\n    MessagingOptions,\n    PayPalBNPLConfigurationItem,\n    PayPalMessagesSdk,\n    PayPalSdkHelper,\n} from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    MissingDataError,\n    MissingDataErrorType,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackActions,\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    PayPalBuyNowInitializeOptions,\n    ShippingAddressChangeCallbackPayload,\n    ShippingOptionChangeCallbackPayload,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsPayLaterButtonInitializeOptions, {\n    WithBigCommercePaymentsPayLaterButtonInitializeOptions,\n} from './bigcommerce-payments-paylater-button-initialize-options';\n\nexport default class BigCommercePaymentsPayLaterButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n        private payPalSdkHelper: PayPalSdkHelper,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions &\n            WithBigCommercePaymentsPayLaterButtonInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments_paylater, containerId, methodId } = options;\n        const {\n            buyNowInitializeOptions,\n            currencyCode: providedCurrencyCode,\n            messagingContainerId,\n        } = bigcommerce_payments_paylater || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!bigcommerce_payments_paylater) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_paylater\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_paylater.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_paylater.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        const state = this.paymentIntegrationService.getState();\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : state.getCartOrThrow().currency.code;\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(\n            methodId,\n            currencyCode,\n            false,\n        );\n\n        this.renderButton(containerId, methodId, bigcommerce_payments_paylater);\n\n        const messagingContainer =\n            messagingContainerId && document.getElementById(messagingContainerId);\n\n        if (currencyCode && messagingContainer) {\n            const paymentMethod =\n                state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n\n            const { paypalBNPLConfiguration = [] } = paymentMethod.initializationData || {};\n            const bannerConfiguration =\n                paypalBNPLConfiguration && paypalBNPLConfiguration.find(({ id }) => id === 'cart');\n\n            if (!bannerConfiguration?.status) {\n                return;\n            }\n\n            // TODO: remove this when data attributes will be removed from related cart banner container in content service\n            messagingContainer.removeAttribute('data-pp-style-logo-type');\n            messagingContainer.removeAttribute('data-pp-style-logo-position');\n            messagingContainer.removeAttribute('data-pp-style-text-color');\n            messagingContainer.removeAttribute('data-pp-style-text-size');\n\n            const payPalSdkHelper = await this.payPalSdkHelper.getPayPalMessages(\n                paymentMethod,\n                currencyCode,\n            );\n\n            this.renderMessages(payPalSdkHelper, messagingContainerId, bannerConfiguration);\n        }\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        bigcommerce_payments_paylater: BigCommercePaymentsPayLaterButtonInitializeOptions,\n    ): void {\n        const { buyNowInitializeOptions, style, onComplete, onEligibilityFailure } =\n            bigcommerce_payments_paylater;\n\n        const bigCommercePaymentsSdk =\n            this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const state = this.paymentIntegrationService.getState();\n        const paymentMethod =\n            state.getPaymentMethodOrThrow<BigCommercePaymentsInitializationData>(methodId);\n        const { isHostedCheckoutEnabled } = paymentMethod.initializationData || {};\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder(\n                    'bigcommerce_payments_paylater',\n                ),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const hostedCheckoutCallbacks = {\n            onShippingAddressChange: (data: ShippingAddressChangeCallbackPayload) =>\n                this.onShippingAddressChange(data),\n            onShippingOptionsChange: (data: ShippingOptionChangeCallbackPayload) =>\n                this.onShippingOptionsChange(data),\n            onApprove: (data: ApproveCallbackPayload, actions: ApproveCallbackActions) =>\n                this.onHostedCheckoutApprove(data, actions, methodId, onComplete),\n        };\n\n        const fundingSources = [\n            bigCommercePaymentsSdk.FUNDING.PAYLATER,\n            bigCommercePaymentsSdk.FUNDING.CREDIT,\n        ];\n        let hasRenderedSmartButton = false;\n\n        fundingSources.forEach((fundingSource) => {\n            if (!hasRenderedSmartButton) {\n                const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n                    fundingSource,\n                    style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(style),\n                    ...defaultCallbacks,\n                    ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n                    ...(isHostedCheckoutEnabled && hostedCheckoutCallbacks),\n                };\n\n                const paypalButton = bigCommercePaymentsSdk.Buttons(buttonRenderOptions);\n\n                if (paypalButton.isEligible()) {\n                    paypalButton.render(`#${containerId}`);\n                    hasRenderedSmartButton = true;\n                } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n                    onEligibilityFailure();\n                }\n            }\n        });\n\n        if (!hasRenderedSmartButton) {\n            this.bigCommercePaymentsIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart =\n                await this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(\n                    buyNowInitializeOptions,\n                );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n\n    private async onHostedCheckoutApprove(\n        data: ApproveCallbackPayload,\n        actions: ApproveCallbackActions,\n        methodId: string,\n        onComplete?: () => void,\n    ): Promise<boolean> {\n        if (!data.orderID) {\n            throw new MissingDataError(MissingDataErrorType.MissingOrderId);\n        }\n\n        const state = this.paymentIntegrationService.getState();\n        const cart = state.getCartOrThrow();\n        const orderDetails = await actions.order.get();\n\n        try {\n            const billingAddress =\n                this.bigCommercePaymentsIntegrationService.getBillingAddressFromOrderDetails(\n                    orderDetails,\n                );\n\n            await this.paymentIntegrationService.updateBillingAddress(billingAddress);\n\n            if (cart.lineItems.physicalItems.length > 0) {\n                const shippingAddress =\n                    this.bigCommercePaymentsIntegrationService.getShippingAddressFromOrderDetails(\n                        orderDetails,\n                    );\n\n                await this.paymentIntegrationService.updateShippingAddress(shippingAddress);\n                await this.bigCommercePaymentsIntegrationService.updateOrder();\n            }\n\n            await this.paymentIntegrationService.submitOrder({}, { params: { methodId } });\n            await this.bigCommercePaymentsIntegrationService.submitPayment(methodId, data.orderID);\n\n            if (onComplete && typeof onComplete === 'function') {\n                onComplete();\n            }\n\n            return true; // FIXME: Do we really need to return true here?\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingAddressChange(\n        data: ShippingAddressChangeCallbackPayload,\n    ): Promise<void> {\n        const address = this.bigCommercePaymentsIntegrationService.getAddress({\n            city: data.shippingAddress.city,\n            countryCode: data.shippingAddress.countryCode,\n            postalCode: data.shippingAddress.postalCode,\n            stateOrProvinceCode: data.shippingAddress.state,\n        });\n\n        try {\n            // Info: we use the same address to fill billing and shipping addresses to have valid quota on BE for order updating process\n            // on this stage we don't have access to valid customer's address accept shipping data\n            await this.paymentIntegrationService.updateBillingAddress(address);\n            await this.paymentIntegrationService.updateShippingAddress(address);\n\n            const shippingOption =\n                this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow();\n\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private async onShippingOptionsChange(\n        data: ShippingOptionChangeCallbackPayload,\n    ): Promise<void> {\n        const shippingOption = this.bigCommercePaymentsIntegrationService.getShippingOptionOrThrow(\n            data.selectedShippingOption.id,\n        );\n\n        try {\n            await this.paymentIntegrationService.selectShippingOption(shippingOption.id);\n            await this.bigCommercePaymentsIntegrationService.updateOrder();\n        } catch (error) {\n            if (typeof error === 'string') {\n                throw new Error(error);\n            }\n\n            throw error;\n        }\n    }\n\n    private renderMessages(\n        paypalMessagesSdk: PayPalMessagesSdk,\n        messagingContainerId: string,\n        bannerConfiguration: PayPalBNPLConfigurationItem,\n    ): void {\n        const checkout = this.paymentIntegrationService.getState().getCheckoutOrThrow();\n\n        const paypalMessagesOptions: MessagingOptions = {\n            amount: checkout.outstandingBalance,\n            placement: 'cart',\n            style: getPaypalMessagesStylesFromBNPLConfig(bannerConfiguration),\n        };\n\n        const paypalMessages = paypalMessagesSdk.Messages(paypalMessagesOptions);\n\n        paypalMessages.render(`#${messagingContainerId}`);\n    }\n}\n","import { createBigCommercePaymentsSdk } from '@bigcommerce/checkout-sdk/bigcommerce-payments-utils';\nimport {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsPayLaterButtonStrategy from './bigcommerce-payments-paylater-button-strategy';\n\nconst createBigCommercePaymentsPayLaterButtonStrategy: CheckoutButtonStrategyFactory<\n    BigCommercePaymentsPayLaterButtonStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsPayLaterButtonStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n        createBigCommercePaymentsSdk(),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsPayLaterButtonStrategy, [\n    { id: 'bigcommerce_payments_paylater' },\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    PayPalBuyNowInitializeOptions,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsAlternativeMethodsButtonInitializeOptions, {\n    WithBigCommercePaymentsAlternativeMethodsButtonInitializeOptions,\n} from './bigcommerce-payments-alternative-methods-button-initialize-options';\n\nexport default class BigCommercePaymentsAlternativeMethodsButtonStrategy\n    implements CheckoutButtonStrategy\n{\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions &\n            WithBigCommercePaymentsAlternativeMethodsButtonInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments_apms, containerId, methodId } = options;\n        const {\n            apm,\n            buyNowInitializeOptions,\n            currencyCode: providedCurrencyCode,\n        } = bigcommerce_payments_apms || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!bigcommerce_payments_apms) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_apms\" argument is not provided.`,\n            );\n        }\n\n        if (!apm) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_apms.apm\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_apms.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_apms.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(\n            methodId,\n            currencyCode,\n            false,\n        );\n\n        this.renderButton(containerId, methodId, bigcommerce_payments_apms);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        bigcommerce_payments_apms: BigCommercePaymentsAlternativeMethodsButtonInitializeOptions,\n    ): void {\n        const { apm, buyNowInitializeOptions, style, onEligibilityFailure } =\n            bigcommerce_payments_apms;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const isAvailableFundingSource = Object.values(paypalSdk.FUNDING).includes(apm);\n\n        if (!isAvailableFundingSource) {\n            throw new InvalidArgumentError(\n                `Unable to initialize PayPal button because \"options.bigcommerce_payments_apms.apm\" argument is not valid funding source.`,\n            );\n        }\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder('bigcommerce_payments_apms'),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource: apm,\n            style: this.bigCommercePaymentsIntegrationService.getValidButtonStyle(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${containerId}`);\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.bigCommercePaymentsIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart =\n                await this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(\n                    buyNowInitializeOptions,\n                );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsAlternativeMethodsButtonStrategy from './bigcommerce-payments-alternative-methods-button-strategy';\n\nconst createBigCommercePaymentsAlternativeMethodsButtonStrategy: CheckoutButtonStrategyFactory<\n    BigCommercePaymentsAlternativeMethodsButtonStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsAlternativeMethodsButtonStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsAlternativeMethodsButtonStrategy, [\n    { id: 'bigcommerce_payments_apms' },\n]);\n","import {\n    CheckoutButtonInitializeOptions,\n    CheckoutButtonStrategy,\n    InvalidArgumentError,\n    PaymentIntegrationService,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport BigCommercePaymentsIntegrationService from '../bigcommerce-payments-integration-service';\nimport {\n    ApproveCallbackPayload,\n    BigCommercePaymentsButtonsOptions,\n    PayPalButtonStyleOptions,\n    PayPalBuyNowInitializeOptions,\n    StyleButtonColor,\n} from '../bigcommerce-payments-types';\n\nimport BigCommercePaymentsVenmoButtonInitializeOptions, {\n    WithBigCommercePaymentsVenmoButtonInitializeOptions,\n} from './bigcommerce-payments-venmo-button-initialize-options';\n\nexport default class BigCommercePaymentsVenmoButtonStrategy implements CheckoutButtonStrategy {\n    constructor(\n        private paymentIntegrationService: PaymentIntegrationService,\n        private bigCommercePaymentsIntegrationService: BigCommercePaymentsIntegrationService,\n    ) {}\n\n    async initialize(\n        options: CheckoutButtonInitializeOptions &\n            WithBigCommercePaymentsVenmoButtonInitializeOptions,\n    ): Promise<void> {\n        const { bigcommerce_payments_venmo, containerId, methodId } = options;\n        const { buyNowInitializeOptions, currencyCode: providedCurrencyCode } =\n            bigcommerce_payments_venmo || {};\n\n        const isBuyNowFlow = !!buyNowInitializeOptions;\n\n        if (!methodId) {\n            throw new InvalidArgumentError(\n                'Unable to initialize payment because \"options.methodId\" argument is not provided.',\n            );\n        }\n\n        if (!containerId) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.containerId\" argument is not provided.`,\n            );\n        }\n\n        if (!bigcommerce_payments_venmo) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_venmo\" argument is not provided.`,\n            );\n        }\n\n        if (isBuyNowFlow && !providedCurrencyCode) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_venmo.currencyCode\" argument is not provided.`,\n            );\n        }\n\n        if (\n            isBuyNowFlow &&\n            typeof buyNowInitializeOptions?.getBuyNowCartRequestBody !== 'function'\n        ) {\n            throw new InvalidArgumentError(\n                `Unable to initialize payment because \"options.bigcommerce_payments_venmo.buyNowInitializeOptions.getBuyNowCartRequestBody\" argument is not provided or it is not a function.`,\n            );\n        }\n\n        if (!isBuyNowFlow) {\n            // Info: default checkout should not be loaded for BuyNow flow,\n            // since there is no checkout session available for that.\n            await this.paymentIntegrationService.loadDefaultCheckout();\n        }\n\n        // Info: we are using provided currency code for buy now cart,\n        // because checkout session is not available before buy now cart creation,\n        // hence application will throw an error on getCartOrThrow method call\n        const currencyCode = isBuyNowFlow\n            ? providedCurrencyCode\n            : this.paymentIntegrationService.getState().getCartOrThrow().currency.code;\n\n        await this.bigCommercePaymentsIntegrationService.loadPayPalSdk(\n            methodId,\n            currencyCode,\n            false,\n        );\n\n        this.renderButton(containerId, methodId, bigcommerce_payments_venmo);\n    }\n\n    deinitialize(): Promise<void> {\n        return Promise.resolve();\n    }\n\n    private renderButton(\n        containerId: string,\n        methodId: string,\n        bigcommerce_payments_venmo: BigCommercePaymentsVenmoButtonInitializeOptions,\n    ): void {\n        const { buyNowInitializeOptions, style, onEligibilityFailure } = bigcommerce_payments_venmo;\n\n        const paypalSdk = this.bigCommercePaymentsIntegrationService.getPayPalSdkOrThrow();\n        const fundingSource = paypalSdk.FUNDING.VENMO;\n\n        const defaultCallbacks = {\n            createOrder: () =>\n                this.bigCommercePaymentsIntegrationService.createOrder(\n                    'bigcommerce_payments_venmo',\n                ),\n            onApprove: ({ orderID }: ApproveCallbackPayload) =>\n                this.bigCommercePaymentsIntegrationService.tokenizePayment(methodId, orderID),\n        };\n\n        const buyNowFlowCallbacks = {\n            onClick: () => this.handleClick(buyNowInitializeOptions),\n            onCancel: () => this.paymentIntegrationService.loadDefaultCheckout(),\n        };\n\n        const buttonRenderOptions: BigCommercePaymentsButtonsOptions = {\n            fundingSource,\n            style: this.getValidVenmoButtonStyles(style),\n            ...defaultCallbacks,\n            ...(buyNowInitializeOptions && buyNowFlowCallbacks),\n        };\n\n        const paypalButtonRender = paypalSdk.Buttons(buttonRenderOptions);\n\n        if (paypalButtonRender.isEligible()) {\n            paypalButtonRender.render(`#${containerId}`);\n        } else if (onEligibilityFailure && typeof onEligibilityFailure === 'function') {\n            onEligibilityFailure();\n        } else {\n            this.bigCommercePaymentsIntegrationService.removeElement(containerId);\n        }\n    }\n\n    private getValidVenmoButtonStyles(style: PayPalButtonStyleOptions | undefined) {\n        const validButtonStyle =\n            this.bigCommercePaymentsIntegrationService.getValidButtonStyle(style);\n\n        if (validButtonStyle.color === StyleButtonColor.gold) {\n            return {\n                ...validButtonStyle,\n                color: undefined,\n            };\n        }\n\n        return validButtonStyle;\n    }\n\n    private async handleClick(\n        buyNowInitializeOptions?: PayPalBuyNowInitializeOptions,\n    ): Promise<void> {\n        if (buyNowInitializeOptions) {\n            const buyNowCart =\n                await this.bigCommercePaymentsIntegrationService.createBuyNowCartOrThrow(\n                    buyNowInitializeOptions,\n                );\n\n            await this.paymentIntegrationService.loadCheckout(buyNowCart.id);\n        }\n    }\n}\n","import {\n    CheckoutButtonStrategyFactory,\n    toResolvableModule,\n} from '@bigcommerce/checkout-sdk/payment-integration-api';\n\nimport createBigCommercePaymentsIntegrationService from '../create-bigcommerce-payments-integration-service';\n\nimport BigCommercePaymentsVenmoButtonStrategy from './bigcommerce-payments-venmo-button-strategy';\n\nconst createBigCommercePaymentsVenmoButtonStrategy: CheckoutButtonStrategyFactory<\n    BigCommercePaymentsVenmoButtonStrategy\n> = (paymentIntegrationService) =>\n    new BigCommercePaymentsVenmoButtonStrategy(\n        paymentIntegrationService,\n        createBigCommercePaymentsIntegrationService(paymentIntegrationService),\n    );\n\nexport default toResolvableModule(createBigCommercePaymentsVenmoButtonStrategy, [\n    { id: 'bigcommerce_payments_venmo' },\n]);\n"],"names":["MissingDataErrorType","__webpack_require__","toResolvableModule","module","resolveIds","Object","assign","d","exports","definition","key","o","defineProperty","enumerable","get","obj","prop","prototype","hasOwnProperty","call","StandardError","Error","constructor","message","super","name","type","setPrototypeOf","this","__proto__","captureStackTrace","stack","PaymentMethodClientUnavailableError","MissingDataError","subtype","MissingBillingAddress","MissingCart","MissingConsignments","MissingCheckout","MissingCustomer","MissingCheckoutConfig","MissingOrderConfig","MissingOrder","MissingOrderId","MissingPayment","MissingPaymentToken","MissingPaymentMethod","MissingShippingAddress","getErrorMessage","BuyNowCartCreationError","DEFAULT_RESPONSE","body","headers","status","RequestError","response","errors","CartSource","LiabilityShiftEnum","BigCommercePaymentsIntent","StyleButtonLabel","StyleButtonColor","StyleButtonShape","NonInstantAlternativePaymentMethods","PayPalOrderStatus","BigCommercePaymentsIntegrationService","formPoster","paymentIntegrationService","bigCommercePaymentsRequestSender","bigCommercePaymentsScriptLoader","loadPayPalSdk","methodId","providedCurrencyCode","initializesOnCheckoutPage","forceLoad","state","getState","currencyCode","getCartOrThrow","currency","code","paymentMethod","getPaymentMethodOrThrow","paypalSdk","getPayPalSDK","getPayPalSdkOrThrow","createBuyNowCartOrThrow","buyNowInitializeOptions","cartRequestBody","getBuyNowCartRequestBody","createBuyNowCart","error","createOrder","providerId","requestBody","cartId","id","orderId","createOrderCardFields","setupToken","updateOrder","cart","consignment","getConsignmentsOrThrow","availableShippingOptions","selectedShippingOption","_error","getOrderStatus","options","tokenizePayment","postForm","payment_type","action","provider","order_id","source","BuyNow","cart_id","submitPayment","gatewayId","paymentData","formattedPayload","vault_payment_instrument","set_as_default_stored_instrument","device_info","method_id","paypal_account","getShippingOptionOrThrow","selectedShippingOptionId","recommendedShippingOption","find","option","isRecommended","shippingOptionToSelect","getAddress","address","firstName","lastName","email","phone","company","address1","address2","city","countryCode","postalCode","stateOrProvince","stateOrProvinceCode","customFields","getBillingAddressFromOrderDetails","payer","given_name","surname","email_address","address_line_1","address_line_2","admin_area_2","country_code","postal_code","admin_area_1","phone_number","national_number","getShippingAddressFromOrderDetails","orderDetails","purchase_units","full_name","shipping","split","join","getValidButtonStyle","style","color","height","label","shape","validStyles","undefined","getValidHeight","omitBy","isNil","removeElement","elementId","element","document","getElementById","display","INTERNAL_USE_ONLY","ContentType","SDK_VERSION_HEADERS","BigCommercePaymentsRequestSender","requestSender","url","Json","post","put","BigCommercePaymentsScriptLoader","scriptLoader","window","paypalSdkScriptConfig","getPayPalSdkScriptConfigOrThrow","loadPayPalSDK","paypal","transformConfig","attributes","scriptSrc","URLSearchParams","toString","loadScript","async","clientToken","initializationData","clientId","intent","merchantId","buyerCountry","attributionId","isVenmoEnabled","isHostedCheckoutEnabled","isPayPalCreditAvailable","isDeveloperModeApplicable","availableAlternativePaymentMethods","enabledAlternativePaymentMethods","isGooglePayEnabled","commit","shouldEnableCard","enableCardFunding","disableCardFunding","enableCreditFunding","disableCreditFunding","enableVenmoFunding","disableVenmoFunding","disableAPMsFunding","filter","apm","includes","googlePayComponent","cardFieldsComponent","disableFunding","filterFundingOptions","enableFunding","length","components","fundingOptions","fundingTypesToBeFiltered","fundingOption","config","transformedConfig","keys","forEach","value","Array","isArray","getHost","createFormPoster","createRequestSender","host","getScriptLoader","InvalidArgumentError","BigCommercePaymentsCustomerStrategy","bigCommercePaymentsIntegrationService","onError","noop","initialize","bigcommerce_payments","container","onClick","getPaymentMethod","loadPaymentMethod","Buttons","renderButton","console","deinitialize","Promise","resolve","signIn","credentials","signInCustomer","signOut","signOutCustomer","executePaymentMethodCheckout","continueWithCheckoutCallback","onComplete","paymentButtonStyles","checkoutTopButtonStyles","defaultCallbacks","onApprove","orderID","hostedCheckoutCallbacks","onShippingAddressChange","data","onShippingOptionsChange","actions","onHostedCheckoutApprove","buttonRenderOptions","fundingSource","FUNDING","PAYPAL","paypalButton","isEligible","render","order","billingAddress","updateBillingAddress","lineItems","physicalItems","shippingAddress","updateShippingAddress","submitOrder","params","handleError","shippingOption","selectShippingOption","UntrustedShippingCardVerificationType","TDSecureVerificationMethod","TDSecureAuthenticationState","PayPalFastlaneAuthenticationState","PayPalSdkHelper","getPayPalFastlaneSdk","sessionId","paypalFastlaneSdk","getPayPalFastlaneSdkConfiguration","getPayPalGooglePaySdk","paypalGooglePay","getPayPalGooglePaySdkScriptConfigOrThrow","getPayPalApmsSdk","paypalApms","getPayPalApmSdkConfiguration","getPayPalMessages","paypalMessages","paypalSdkMessagesConfig","getPayPalSdkMessagesConfiguration","scriptOptions","scriptAttributes","replace","enableAPMsFunding","createBigCommercePaymentsSdk","createScriptLoader","CookieStorage","cookieKey","encodeURIComponent","cookie","firstIndex","indexOf","lastIndex","decodeURIComponent","substring","set","secure","cookieText","expires","path","domain","toUTCString","now","Date","minutes","setTime","getTime","remove","BigCommercePaymentsFastlaneUtils","initializePayPalFastlane","isTestModeEnabled","styles","localStorage","setItem","paypalFastlane","defaultStyles","root","backgroundColorPrimary","Fastlane","getPayPalFastlaneOrThrow","lookupCustomerOrThrow","identity","lookupCustomerByEmail","triggerAuthenticationFlowOrThrow","customerContextId","triggerAuthenticationFlow","updateStorageSessionId","setDate","getDate","cookiesOption","removeStorageSessionId","getStorageSessionId","mapPayPalFastlaneProfileToBcCustomerData","authenticationResult","authenticationState","profileData","paypalBillingAddress","card","paymentSource","paypalShippingAddress","paypalProfileName","paypalInstrument","mapPayPalToBcAddress","phoneNumber","instruments","mapPayPalToBcInstrument","addresses","filterAddresses","UNRECOGNIZED","instrument","brand","expiry","lastDigits","expiryYear","expiryMonth","bigpayToken","defaultInstrument","iin","last4","method","trustedShippingAddress","untrustedShippingCardVerificationMode","PAN","mapBcToPayPalAddress","addressLine1","addressLine2","adminArea1","adminArea2","profileName","fullName","phoneData","nationalNumber","country","reduce","customerAddresses","currentAddress","some","customerAddress","isEqualAddresses","firstAddress","secondAddress","isEqual","normalizeAddress","omit","createBigCommercePaymentsFastlaneUtils","isInvalidStyleOption","styleOption","getFastlaneStyles","styleSettings","uiStyles","fastlaneStyles","input","toggle","textBody","text","textCaption","caption","branding","cleanUpFastlaneStyles","fastlaneRootSettingsBackgroundColor","errorColor","fastlaneRootSettingsErrorColor","fontFamily","fastlaneRootSettingsFontFamily","fontSizeBase","fastlaneRootSettingsFontSize","padding","fastlaneRootSettingsPadding","primaryColor","fastlaneRootSettingsPrimaryColor","borderRadius","fastlaneInputSettingsBorderRadius","borderColor","fastlaneInputSettingsBorderColor","focusBorderColor","fastlaneInputSettingsFocusBorderBase","backgroundColor","fastlaneInputSettingsBackgroundColor","borderWidth","fastlaneInputSettingsBorderWidth","textColorBase","fastlaneInputSettingsTextColorBase","colorPrimary","fastlaneToggleSettingsColorPrimary","colorSecondary","fastlaneToggleSettingsColorSecondary","fastlaneTextBodySettingsColor","fontSize","fastlaneTextBodySettingsFontSize","fastlaneTextCaptionSettingsColor","fastlaneTextCaptionSettingsFontSize","fastlaneBrandingSettings","mergeFastlaneStyles","BigCommercePaymentsFastlaneCustomerStrategy","bigCommercePaymentsSdk","bigCommercePaymentsFastlaneUtils","bigcommerce_payments_fastlane","_","checkoutPaymentMethodExecuted","getCustomerOrThrow","isGuest","runPayPalAuthenticationFlowOrThrow","customer","getCustomer","getBillingAddress","customerEmail","isAuthenticationFlowCanceled","CANCELED","updateCustomerDataState","updatePaymentProviderCustomer","updatedState","isFastlaneShippingOptionAutoSelectEnabled","consignments","getConsignments","firstShippingOption","shippingOptionId","isFastlaneStylingEnabled","BigCommercePaymentsPayLaterCustomerStrategy","bigcommerce_payments_paylater","bigCommercePaymentsPayLater","fundingSources","PAYLATER","CREDIT","hasRenderedSmartButton","BigCommercePaymentsVenmoCustomerStrategy","bigcommerce_payments_venmo","VENMO","paypalButtonRender","DEFAULT_STYLES","size","ROTATION_ANIMATION","LoadingIndicator","containerStyles","defineAnimation","buildContainer","indicator","buildIndicator","appendChild","show","parentId","parent","visibility","opacity","hide","handleTransitionEnd","removeEventListener","addEventListener","createElement","bottom","left","width","position","right","top","transition","setStyleAttribute","border","margin","transform","transformStyle","animation","attrs","k","setProperty","head","sheet","CSSStyleSheet","insertRule","LOADING_INDICATOR_STYLES","messagesStyles","layout","logo","ratio","PaymentArgumentInvalidError","invalidFields","PaymentMethodInvalidError","OrderFinalizationNotRequiredError","isHostedInstrumentLike","shouldSaveInstrument","shouldSetAsDefaultInstrument","isVaultedInstrument","Boolean","instrumentId","isBaseInstrument","BigCommercePaymentsPaymentStrategy","paypalSdkHelper","loadingIndicator","bannerContainerId","paypalBNPLConfiguration","bannerConfiguration","Messages","renderMessages","loadingIndicatorContainer","onInit","shouldRenderPayPalButtonOnInitialization","execute","payload","payment","isPayPalVaultedInstrumentPaymentData","paymentPayload","prepareVaultedInstrumentPaymentPayload","preparePaymentPayload","isProviderError","_resolve","reject","close","finalize","paypalOrderId","shouldConfirmInstrument","isTrustedVaultingFlow","bigpay_token","token","checkoutPaymentButtonStyles","onRenderButton","onValidate","submitForm","buttonOptions","handleClick","handleApprove","onCancel","toggleLoadingIndicator","fieldsValues","getFieldsValues","getInstruments","findInstrument","isLoading","paypalMessagesOptions","amount","getCheckoutOrThrow","outstandingBalance","placement","isBigCommercePaymentsProviderError","e","provider_error","isPayPalFastlaneCustomer","isExperimentEnabled","features","experimentName","fallbackValue","BigCommercePaymentsFastlanePaymentStrategy","onChange","threeDSVerificationMethod","shouldRunAuthenticationFlow","initializePayPalPaymentComponent","renderPayPalPaymentComponent","handlePayPalStoredInstrumentChange","orderRequest","isVaultedFlow","isBigcommerceFastlaneRequestError","invalidRequestError","translationKey","paymentProviderCustomer","getPaymentProviderCustomer","paypalFastlaneCustomer","paypalFastlaneSessionId","getBillingAddressOrThrow","trim","cardComponentOptions","fields","cardholderName","prefill","enabled","paypalComponentMethods","FastlaneCardComponent","getPayPalComponentMethodsOrThrow","nonce","isBigcommercePaymentsFastlaneThreeDSAvailable","is3dsEnabled","get3DSNonce","paypal_fastlane_token","getPaymentToken","is3DSEnabled","fastlaneToken","getOrderOrThrow","checkoutUrl","getStoreConfigOrThrow","links","checkoutLink","threeDomainSecureComponent","ThreeDomainSecureClient","threeDomainSecureParameters","orderAmount","toFixed","threeDSRequested","Always","transactionContext","experience_context","locale","return_url","cancel_url","isThreeDomainSecureEligible","liabilityShift","threeDSNonce","No","Unknown","Errored","Cancelled","Succeeded","Yes","Possible","paypalAxoSdk","selectionChanged","selectedCard","profile","showCardSelector","selectedInstrument","checkoutSettings","NotImplementedError","BigCommercePaymentsPayLaterPaymentStrategy","bigCommercePaymentsButtons","bigCommerceSdk","TimeoutError","BigCommercePaymentsRatePayPaymentStrategy","pollingInterval","maxPollingIntervalTime","pollingTimer","stopPolling","bigcommerce_payments_ratepay","legalTextContainer","loadingContainerId","createFraudNetScript","loadFraudnetConfig","renderLegalText","metadataId","guid","ratepayBirthDate","ratepayPhoneNumber","ratepayPhoneCountryCode","rate_pay","birth_date","normalizeDate","initializePollingMechanism","fraudNetScript","querySelectorAll","fraudNetConfig","deinitializePollingMechanism","legalTextContainerElement","date","formattedDate","formatDate","formattedMonth","getMonth","getFullYear","legalTextContainerElementId","legalTextContainerId","buttonContainerId","buttonContainer","buttonContainerParent","parentNode","marginBottom","setAttribute","prepend","ratePayButton","Legal","PAY_UPON_INVOICE","resetPollingMechanism","testMode","scriptElement","generateGUID","f","s","sandbox","innerHTML","JSON","stringify","i","Math","floor","characters","random","script","src","reinitializeStrategy","resolvePromise","rejectPromise","timeout","setTimeout","clearTimeout","orderStatus","useMetadata","isOrderApproved","PollingStop","isPollingError","PollingError","gateway","HostedFieldType","isCreditCardFormFields","CardNumber","CardName","CardExpiry","isCreditCardVaultedFormFields","CardNumberVerification","CardCodeVerification","CardExpiryVerification","PaymentMethodFailedError","NotInitializedErrorType","NotInitializedError","CustomerNotInitialized","PaymentNotInitialized","ShippingNotInitialized","SpamProtectionNotInitialized","PaymentInvalidFormError","details","BigCommercePaymentsCreditCardsPaymentStrategy","bigcommerce_payments_creditcards","bigCommercePaymentsInitializationOptions","form","onCreditCardFieldsRenderingError","onLoadComplete","hostedFormOptions","isCreditCardForm","isCreditCardVaultedForm","hasUndefinedValues","initializeFields","shouldInitializePayPalFastlane","initializePayPalFastlaneOrThrow","executionPaymentData","validateHostedFormOrThrow","submitHostedForm","getInstrumentParams","returnedOrderId","submitPaymentPayload","returnedVaultedToken","cvvField","expiryField","numberField","nameField","verification_nonce","card_with_order","formOptions","executeCallback","getExecuteCallback","cardFieldsConfig","getInputStyles","vaultSetupToken","inputEvents","event","onChangeHandler","onFocus","onFocusHandler","onBlur","onBlurHandler","onInputSubmitRequest","cardFields","CardFields","stylizeInputContainers","renderFields","renderVaultedFields","createVaultSetupTokenCallback","createOrderCallback","createVaultSetupToken","fieldsOptions","getCardFieldsOrThrow","cardCode","containerId","CVVField","placeholder","cardExpiry","ExpiryField","cardName","NameField","cardNumber","NumberField","cardCodeVerification","cardExpiryVerification","cardNumberVerification","getFieldTypeByEmittedField","emittedBy","fieldType","mapFieldType","submitConfig","submit","cardFieldsState","then","validationData","getValidityData","isValid","mapValidationErrors","updatedFields","cardNameField","fieldsKeys","every","fieldsErrors","getInvalidErrorByFieldType","CardCode","validationErrors","commonStyles","default","fontWeight","outline","values","boxShadow","background","marginLeft","onEnter","bigCommercePaymentsPaymentProviderCustomer","isAcceleratedCheckoutEnabled","isBigCommercePaymentsAnalyticsV2Enabled","connectClientToken","payPalFastlaneSdk","BigCommercePaymentsAlternativeMethodsPaymentStrategy","bigCommercePaymentsSdkHelper","isPollingEnabled","bigcommerce_payments_apms","bigCommercePaymentsAlternativeMethods","shouldRenderFields","isNonInstantPaymentMethod","bigCommercePaymentsButton","Approved","deInitializePollingMechanism","paypalAmpsSdk","getPaypalAmpsSdkOrThrow","buttonStyle","onInitButton","onCreateOrder","handleFailure","useStoreCredit","apmFieldsContainer","apmFieldsStyles","fieldContainerElement","querySelector","PaymentFields","toUpperCase","BigCommercePaymentsRedirectAlternativeMethodsPaymentStrategy","additional_action_required","redirect_url","isRedirectError","redirectUrl","location","BigCommercePaymentsVenmoPaymentStrategy","BigCommercePaymentsButtonStrategy","isBuyNowFlow","loadDefaultCheckout","onEligibilityFailure","isAppSwitchEnabled","isPaypalCommerceAppSwitchEnabled","appSwitchWhenAvailable","buyNowFlowCallbacks","hasReturned","resume","buyNowCart","loadCheckout","BigCommercePaymentsPayLaterButtonStrategy","payPalSdkHelper","messagingContainerId","messagingContainer","removeAttribute","paypalMessagesSdk","BigCommercePaymentsAlternativeMethodsButtonStrategy","BigCommercePaymentsVenmoButtonStrategy","getValidVenmoButtonStyles","validButtonStyle","gold"],"sourceRoot":""}